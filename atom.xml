<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Leo&#39;s Blog</title>
  
  <subtitle>Don&#39;t Worry, Be happy</subtitle>
  <link href="https://tauleos.github.io/atom.xml" rel="self"/>
  
  <link href="https://tauleos.github.io/"/>
  <updated>2024-11-07T08:17:00.699Z</updated>
  <id>https://tauleos.github.io/</id>
  
  <author>
    <name>Tauleos</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Chromeæ’ä»¶è¿›é˜¶</title>
    <link href="https://tauleos.github.io/dcc6a7fe224e.html"/>
    <id>https://tauleos.github.io/dcc6a7fe224e.html</id>
    <published>2024-11-07T07:34:38.000Z</published>
    <updated>2024-11-07T08:17:00.699Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸Šæ–‡æˆ‘ä»¬äº†è§£äº†å¦‚ä½•å®ç°ä¸€ä¸ªåŸºç¡€ç‰ˆçš„æ’ä»¶å¼€å‘ã€‚å½“ç„¶ï¼Œåœ¨ç°ä»£å¼€å‘æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬è‚¯å®šä¸èƒ½æ¥å—å¦‚æ­¤ç®€é™‹çš„å¼€å‘æ¨¡å¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è¿›è¡Œä¸‹ä¸€æ­¥çš„ä¼˜åŒ–å‘¢ï¼Œç°åœ¨æˆ‘ä»¬ç»§ç»­å°±å¦‚ä½•ä½¿ç”¨ç»„ä»¶åº“å’Œçƒ­æ›´æ–°èåˆæ–¹é¢è¿›è¡Œæ¢ç´¢</p><span id="more"></span><h1 id="ä¸€ã€ä¼˜åŒ–"><a href="#ä¸€ã€ä¼˜åŒ–" class="headerlink" title="ä¸€ã€ä¼˜åŒ–"></a>ä¸€ã€ä¼˜åŒ–</h1><p>å¦‚ä»Šå‰ç«¯å·¥å…·ç™¾èŠ±é½æ”¾ã€‚æˆ‘ä»¬æ”¾ç€æ›´å¥½çš„å·¥å…·ä¸ç”¨å²‚ä¸æ˜¯æµªè´¹ã€‚èƒ½ä¸èƒ½æŠŠæˆ‘ä»¬çš„å‰ç«¯å·¥å…·é›†æˆåˆ°chromeæ’ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæ¥å®ç°æ›´å¿«æ·çš„å¼€å‘ä½“éªŒå’Œæ›´åˆé€‚çš„uiå±•ç¤ºå‘¢ï¼Ÿé‚£æˆ‘ä»¬å°±è¯•ç€æŠŠvite+vueæ¥å…¥è¿›æ¥å§ã€‚</p><h2 id="ç›®å½•è°ƒæ•´"><a href="#ç›®å½•è°ƒæ•´" class="headerlink" title="ç›®å½•è°ƒæ•´"></a>ç›®å½•è°ƒæ•´</h2><ol><li>é¦–å…ˆæˆ‘ä»¬å…ˆå¿«é€Ÿç”Ÿæˆviteä¸vueï¼ŒTSçš„é¡¹ç›®ï¼Œ</li><li>åŒæ—¶è°ƒæ•´ç›®å½•ç»“æ„ï¼Œå°†æˆ‘ä»¬éœ€è¦çš„contentã€popupç­‰åŠŸèƒ½åˆ†å¼€åœ¨ä¸åŒçš„ç»“æ„ä¸­ã€‚</li><li>å®‰è£…ç»„ä»¶åº“ã€piniaç­‰å·¥å…·ï¼›å®‰è£…chrome-types æ¥å¯¹æˆ‘ä»¬çš„apiè¿›è¡Œæç¤º</li></ol><p>ç›®å½•ç»“æ„å¦‚ä¸‹æ‰€ç¤º<br><img src="/images/extension/101730966937_.pic.jpg" alt="image.png"></p><h2 id="viteé…ç½®"><a href="#viteé…ç½®" class="headerlink" title="viteé…ç½®"></a>viteé…ç½®</h2><ol><li>é€šè¿‡<code>rollup-plugin-copy</code> å°†é™æ€èµ„æºï¼ˆ<code>manifest.json</code>ã€å›¾æ ‡ï¼‰ç­‰æ–‡ä»¶å¤åˆ¶åˆ°æ‰“åŒ…åçš„ç›®å½•ä¸­</li><li>é€šè¿‡è®¾ç½®viteçš„<code>build</code>é€‰é¡¹,å°†<code>content</code>ã€<code>popup</code>ç­‰è®¾ç½®ä¸ºæ‰“åŒ…çš„å…¥å£ï¼Œå¹¶è¾“å‡ºåˆ°manifestè®¾ç½®çš„ç›®å½•ä¸­ã€‚<br>viteé…ç½®å¦‚ä¸‹æ‰€ç¤ºï¼š<br><img src="/images/extension/111730966938_.pic.jpg" alt="image.png"></li></ol><p>æ‰“åŒ…ä¹‹åï¼Œæˆ‘ä»¬æŠŠæ‰“åŒ…åçš„æ–‡ä»¶å¤¹æ‰”åˆ°æµè§ˆå™¨ä¸­ï¼Œå°±å¯ä»¥è¾¾åˆ°æˆ‘ä»¬ä¸Šè¿°ç¬¬äºŒæ­¥çš„ç›®æ ‡ã€‚</p><blockquote><p>ä½†æ˜¯ï¼Œå¦‚ä½•èƒ½è¿›ä¸€æ­¥æ–¹ä¾¿æˆ‘ä»¬çš„å¼€å‘è¿‡ç¨‹å‘¢ï¼Ÿåœ¨æˆ‘ä»¬æ—¥å¸¸å¼€å‘è¿‡ç¨‹ä¸­çš„çƒ­åŠ è½½å¯ä¸å¯ä»¥ä¹Ÿç”¨ä¸Šå‘¢?</p></blockquote><h2 id="HMR"><a href="#HMR" class="headerlink" title="HMR"></a>HMR</h2><p>æˆ‘ä»¬çŸ¥é“ã€‚webpackæˆ–è€…viteçš„devç¯å¢ƒä¸‹ï¼Œå·¥å…·ä¸ºæˆ‘ä»¬è‡ªåŠ¨é›†æˆäº†HMRåŠŸèƒ½ï¼Œå¯ä»¥ä½¿æˆ‘ä»¬æ”¹åŠ¨çš„ä»£ç è‡ªåŠ¨æ›´æ–°åˆ°é¡µé¢ä¸Šã€‚ä½†æ˜¯chromeæ’ä»¶ä¸æ™®é€šçš„æµè§ˆå™¨é¡µé¢ä¸å¤ªä¸€æ ·ã€‚æ’ä»¶æ›´æ–°çš„è¯æ˜¯éœ€è¦åœ¨ç®¡ç†ç•Œé¢æ‰‹åŠ¨åˆ·æ–°æ’ä»¶ï¼ŒåŒæ—¶éœ€è¦é‡æ–°æ‰“å¼€popupï¼Œæ•´ä¸ªæ’ä»¶çš„ä»£ç æ‰ä¼šæ›´æ–°ã€‚æ‰€ä»¥æœ‰æ²¡æœ‰åŠæ³•å¯ä»¥åœ¨æ’ä»¶å†…ç›‘å¬æ–‡ä»¶å¤¹çš„å˜åŒ–å‘¢ï¼Ÿ</p><h3 id="1ã€Chrome-runtime-getPackageDirectoryEntry"><a href="#1ã€Chrome-runtime-getPackageDirectoryEntry" class="headerlink" title="1ã€Chrome.runtime.getPackageDirectoryEntry"></a>1ã€Chrome.runtime.getPackageDirectoryEntry</h3><p>æ ¹æ®å®˜æ–¹æ–‡æ¡£ä»‹ç»ã€‚<code>getPackageDirectoryEntry</code> å¯ä»¥è·å–æ–‡ä»¶å¤¹å†…å®¹å¹¶ç›‘å¬å…¶å˜åŒ–ã€‚å¯æ˜¯åœ¨V3ç‰ˆæœ¬ä¸­è¢«é™åˆ¶äº†ï¼Œåªèƒ½åœ¨<code>popup</code>é¡µé¢ä¸­ä½¿ç”¨ï¼Œå¦‚æœ<code>popup</code>æ²¡æœ‰è¢«ç‚¹å‡»å¼¹å‡ºæ¥çš„è¯ï¼Œæ— æ³•åšåˆ°å…¶ä»–æ¨¡å—çš„çƒ­æ›´æ–°çš„ã€‚</p><h3 id="2ã€live-server-vite-watch-è½®è¯¢"><a href="#2ã€live-server-vite-watch-è½®è¯¢" class="headerlink" title="2ã€live-server + vite watch + è½®è¯¢"></a>2ã€live-server + vite watch + è½®è¯¢</h3><ol><li>é€šè¿‡<code>vite --watch build</code> æ¥è‡ªåŠ¨ç¼–è¯‘æˆ‘ä»¬çš„æ”¹åŠ¨åˆ°distæ–‡ä»¶ã€‚</li><li>é€šè¿‡ <code>live-server</code> åœ¨æœ¬åœ°å¯åŠ¨ä¸€ä¸ªé™æ€èµ„æºæœåŠ¡å™¨ï¼Œä¿è¯æ‰€æœ‰çš„distæ–‡ä»¶éƒ½å¯ä»¥çƒ­æ›´æ–°ã€‚</li><li>åœ¨ <code>background</code> è„šæœ¬ä¸­å¯¹æ‰€æœ‰çš„é™æ€èµ„æºè¿›è¡Œè½®è¯¢ï¼Œä¿å­˜ä¸Šä¸€æ¬¡çš„å†…å®¹ä¸è¿™ä¸€æ¬¡è¿›è¡Œå¯¹æ¯”ï¼Œå‘ç°å†…å®¹æœ‰å˜åŒ–çš„è¯è°ƒç”¨apiè¿›è¡Œæ›´æ–°<br>æè¿°ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fileList = [</span><br><span class="line">      <span class="string">&#x27;http://127.0.0.1:5501/dist/manifest.json&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;http://127.0.0.1:5501/dist/popup/popup.js&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;http://127.0.0.1:5501/dist/background/service-worker.js&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;http://127.0.0.1:5501/dist/content/content.js&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;http://127.0.0.1:5501/dist/contentPage/contentPage.js&#x27;</span></span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">fileObj</span>:  = &#123;&#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * reload é‡æ–°åŠ è½½</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">reload</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      chrome.<span class="property">tabs</span>.<span class="title function_">query</span>(</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">active</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">currentWindow</span>: <span class="literal">true</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="function">(<span class="params">tabs: chrome.tabs.Tab[]</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (tabs[<span class="number">0</span>]) &#123;</span><br><span class="line">            chrome.<span class="property">tabs</span>.<span class="title function_">reload</span>(tabs[<span class="number">0</span>].<span class="property">id</span>);</span><br><span class="line">          &#125;</span><br><span class="line">          chrome.<span class="property">runtime</span>.<span class="title function_">reload</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * éå†ç›‘å¬çš„æ–‡ä»¶ï¼Œé€šè¿‡è¯·æ±‚è·å–æ–‡ä»¶å†…å®¹ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦åˆ·æ–°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">checkReloadPage</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      fileList.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">fetch</span>(item).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> res.<span class="title function_">text</span>())</span><br><span class="line">        .<span class="title function_">then</span>(<span class="function"><span class="params">files</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (fileObj[item] &amp;&amp; fileObj[item] !== files) &#123;</span><br><span class="line">            <span class="title function_">reload</span>()</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            fileObj[item] = files</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"> <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">   <span class="title function_">checkReloadPage</span>()</span><br><span class="line"> &#125;, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure><h3 id="3ã€websocket"><a href="#3ã€websocket" class="headerlink" title="3ã€websocket"></a>3ã€websocket</h3><p>å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥å‚è€ƒwebpack å’Œviteçš„ hmræ¨¡å¼ï¼Œæ¥è‡ªå·±å®ç°ä¸€å¥—åŸºäºwebsocketçš„hmråŠŸèƒ½ï¼Œæ¥æ›¿ä»£ä¸Šè¿°ä¸¤ä¸ªç®€å•ç²—æš´çš„æ–¹æ¡ˆã€‚</p><ol><li>é¦–å…ˆæˆ‘ä»¬éœ€è¦å€Ÿç”¨viteçš„æ’ä»¶èƒ½åŠ›ï¼Œåœ¨viteå¯åŠ¨å’Œæ‰“åŒ…çš„æ—¶å€™ï¼Œæ³¨å…¥æˆ‘ä»¬çš„wsä»£ç ï¼Œå¹¶åœ¨æ–‡ä»¶æ›´æ–°åé€šè¿‡wsé€šé“å‘å‡ºéœ€è¦æ›´æ–°çš„åŒºåŸŸã€‚</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;vite-plugin-crx-hmr&#x27;</span>,</span><br><span class="line">  <span class="attr">enforce</span>: <span class="string">&#x27;pre&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="title function_">configResolved</span>(<span class="params">config</span>) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (isDev) &#123;</span><br><span class="line">          <span class="keyword">if</span> (isBackground) &#123;</span><br><span class="line">              <span class="comment">// å¯åŠ¨ ws æœåŠ¡ç«¯</span></span><br><span class="line">              <span class="title function_">startWebSocketServer</span>()</span><br><span class="line">          &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">              <span class="comment">// é“¾æ¥ ws æœåŠ¡ç«¯</span></span><br><span class="line">              <span class="built_in">setTimeout</span>(connectWebSocketServer, <span class="number">2000</span>)</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// æ‰“åŒ…å®Œæˆåé€šçŸ¥æœåŠ¡ç«¯(background)æˆ–å®¢æˆ·ç«¯(page)ä»£ç æ›´æ–°</span></span><br><span class="line">  <span class="title function_">closeBundle</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;closeBundle&#x27;</span>);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (isDev) &#123;</span><br><span class="line">          <span class="keyword">if</span> (isBackground) &#123;</span><br><span class="line">              <span class="title function_">handleServerChanged</span>()</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="title function_">handleClientChanged</span>(&#123; isPage &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="2"><li>åœ¨backgroundä¸­å¯¹wsæœåŠ¡è¿›è¡Œé“¾æ¥ï¼Œå»ºç«‹ä¿¡å·é€šé“ã€‚å¹¶æ ¹æ®æ”¶åˆ°çš„ä¿¡å·é‡è¿›è¡Œä¸åŒçš„reloadæ“ä½œ</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">hmrWebSocketClient = <span class="keyword">new</span> <span class="title class_">WebSocket</span>(</span><br><span class="line">  <span class="string">`ws://127.0.0.1:<span class="subst">$&#123;crxHmrPort&#125;</span>?mode=background`</span></span><br><span class="line">)</span><br><span class="line">hmrWebSocketClient.<span class="property">onopen</span> = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;background initCrxHmr::&#x27;</span>, <span class="string">&#x27;onopen&#x27;</span>, event)</span><br><span class="line">&#125;</span><br><span class="line">hmrWebSocketClient.<span class="property">onclose</span> = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;background initCrxHmr::&#x27;</span>, <span class="string">&#x27;onclose&#x27;</span>, event)</span><br><span class="line">  hmrWebSocketClient = <span class="literal">null</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">hmrWebSocketClient.<span class="property">onmessage</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; data &#125; = e</span><br><span class="line">  <span class="keyword">if</span> (data === <span class="string">&#x27;BACKGROUND_CHANGED&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(</span><br><span class="line">      <span class="string">&#x27;background initCrxHmr::&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;æ”¶åˆ°æ›´æ–° background.js æ¶ˆæ¯ï¼Œå…³é—­ ws å¹¶é‡æ–°åŠ è½½&#x27;</span></span><br><span class="line">    )</span><br><span class="line">    hmrWebSocketClient?.<span class="title function_">close</span>()</span><br><span class="line">    chrome.<span class="property">runtime</span>.<span class="title function_">reload</span>()</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (data === <span class="string">&#x27;IIFE_CHANGED&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(</span><br><span class="line">      <span class="string">&#x27;background initCrxHmr::&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;æ”¶åˆ°æ›´æ–° iife æ¶ˆæ¯&#x27;</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="title function_">reloadIife</span>(hmrWebSocketClient)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (data === <span class="string">&#x27;PAGE_CHANGED&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;background initCrxHmr::&#x27;</span>, <span class="string">&#x27;æ”¶åˆ°æ›´æ–° page æ¶ˆæ¯&#x27;</span>)</span><br><span class="line">    <span class="title function_">reloadPage</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>æ•´ä½“æµç¨‹å¦‚ä¸‹æ‰€ç¤º</li></ol><p><img src="/images/extension/121730966938_.pic.jpg" alt="åˆ†é”€.png"></p><h3 id="4ã€-crxjs-vite-plugin"><a href="#4ã€-crxjs-vite-plugin" class="headerlink" title="4ã€@crxjs/vite-plugin"></a>4ã€<a href="https://crxjs.dev/vite-plugin">@crxjs/vite-plugin</a></h3><h3 id="5ã€rollup-plugin"><a href="#5ã€rollup-plugin" class="headerlink" title="5ã€rollup-plugin"></a>5ã€<a href="https://www.extend-chrome.dev/rollup-plugin">rollup-plugin</a></h3><h1 id="å››ã€æˆå“å±•ç¤º"><a href="#å››ã€æˆå“å±•ç¤º" class="headerlink" title="å››ã€æˆå“å±•ç¤º"></a>å››ã€æˆå“å±•ç¤º</h1><h2 id="æ— ä¾èµ–çº¯æ‰‹æ’¸ç‰ˆæœ¬"><a href="#æ— ä¾èµ–çº¯æ‰‹æ’¸ç‰ˆæœ¬" class="headerlink" title="æ— ä¾èµ–çº¯æ‰‹æ’¸ç‰ˆæœ¬"></a>æ— ä¾èµ–çº¯æ‰‹æ’¸ç‰ˆæœ¬</h2><p><img src="/images/extension/131730966939_.pic.jpg" alt="image.png"></p><h2 id="å·¥å…·é›†æˆç‰ˆæœ¬ï¼ˆä»…ä½¿ç”¨äº†éƒ¨åˆ†ç»„ä»¶åº“ç»„ä»¶-piniaï¼Œä¸»è¦æ˜¯åœ¨å¼€å‘ä¸­å¯ä»¥åŠæ—¶hmrï¼‰"><a href="#å·¥å…·é›†æˆç‰ˆæœ¬ï¼ˆä»…ä½¿ç”¨äº†éƒ¨åˆ†ç»„ä»¶åº“ç»„ä»¶-piniaï¼Œä¸»è¦æ˜¯åœ¨å¼€å‘ä¸­å¯ä»¥åŠæ—¶hmrï¼‰" class="headerlink" title="å·¥å…·é›†æˆç‰ˆæœ¬ï¼ˆä»…ä½¿ç”¨äº†éƒ¨åˆ†ç»„ä»¶åº“ç»„ä»¶+piniaï¼Œä¸»è¦æ˜¯åœ¨å¼€å‘ä¸­å¯ä»¥åŠæ—¶hmrï¼‰"></a>å·¥å…·é›†æˆç‰ˆæœ¬ï¼ˆä»…ä½¿ç”¨äº†éƒ¨åˆ†ç»„ä»¶åº“ç»„ä»¶+piniaï¼Œä¸»è¦æ˜¯åœ¨å¼€å‘ä¸­å¯ä»¥åŠæ—¶hmrï¼‰</h2><p><img src="/images/extension/image.GIF" alt="åŠ¨ç”».gif"></p><p>ä»wikiä¸­è§£æå‡ºæ¥åï¼Œå¯ä»¥ç›´æ¥å¤åˆ¶åˆ°ä»£ç ä¸­è¿›è¡Œä¸šåŠ¡å¼€å‘ã€‚ä¸€æƒ³åˆ°ä¸ç”¨æŒ¨ä¸ªå¤åˆ¶å°±ç¾æ»‹æ»‹~ğŸ˜œğŸ¥‚</p><h1 id="äº”ã€å°¾å£°"><a href="#äº”ã€å°¾å£°" class="headerlink" title="äº”ã€å°¾å£°"></a>äº”ã€å°¾å£°</h1><p>æœ¬æ–‡ä»å®è·µçš„è§’åº¦å­¦ä¹ äº†chromeæ’ä»¶çš„åŸºç¡€çŸ¥è¯†ä¸ä½¿ç”¨ï¼ŒåŒæ—¶æ·±å…¥ä»‹ç»äº†å’Œå‰ç«¯å·¥å…·çš„é›†æˆæ–¹æ¡ˆï¼Œæ¬¢è¿æ„Ÿå…´è¶£çš„åŒäº‹ä¸€èµ·å­¦ä¹ æ¢è®¨ã€‚</p><hr><p> <strong>done~~</strong>  ğŸƒâ€â™‚ï¸</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ä¸Šæ–‡æˆ‘ä»¬äº†è§£äº†å¦‚ä½•å®ç°ä¸€ä¸ªåŸºç¡€ç‰ˆçš„æ’ä»¶å¼€å‘ã€‚å½“ç„¶ï¼Œåœ¨ç°ä»£å¼€å‘æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬è‚¯å®šä¸èƒ½æ¥å—å¦‚æ­¤ç®€é™‹çš„å¼€å‘æ¨¡å¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è¿›è¡Œä¸‹ä¸€æ­¥çš„ä¼˜åŒ–å‘¢ï¼Œç°åœ¨æˆ‘ä»¬ç»§ç»­å°±å¦‚ä½•ä½¿ç”¨ç»„ä»¶åº“å’Œçƒ­æ›´æ–°èåˆæ–¹é¢è¿›è¡Œæ¢ç´¢&lt;/p&gt;</summary>
    
    
    
    
    <category term="æ¶æ„" scheme="https://tauleos.github.io/tags/%E6%9E%B6%E6%9E%84/"/>
    
    <category term="Chrome" scheme="https://tauleos.github.io/tags/Chrome/"/>
    
  </entry>
  
  <entry>
    <title>Chromeæ’ä»¶å¼€å‘</title>
    <link href="https://tauleos.github.io/52dc035aff5e.html"/>
    <id>https://tauleos.github.io/52dc035aff5e.html</id>
    <published>2024-10-25T06:45:09.000Z</published>
    <updated>2024-11-07T07:36:11.984Z</updated>
    
    <content type="html"><![CDATA[<p>chromeæµè§ˆå™¨çš„æ’ä»¶ç›¸ä¿¡å¤§å®¶åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­éƒ½ä¼šç”¨åˆ°ï¼Œåº”ç”¨å¸‚åœºä¸Šçš„å„ç§æ’ä»¶ä¸ä»…ä¸ªæ€§åŒ–äº†æˆ‘ä»¬çš„æµè§ˆå™¨UIè®¾ç½®ï¼ˆæ¯”å¦‚å„ç§tabé¡µä¸»é¢˜è®¾ç½®æ’ä»¶ï¼‰ï¼ŒåŒæ—¶ä¹Ÿæä¾›äº†æ›´ä¸ºå¼ºå¤§çš„è¾…åŠ©å·¥å…·ã€‚</p><span id="more"></span><blockquote><p>å¯¹æˆ‘ä»¬å‰ç«¯æ¥è¯´ã€‚ç”¨å¥½å„ç§æ’ä»¶ä¹Ÿèƒ½æå¤§çš„æå‡æ—¥å¸¸å·¥ä½œä¸­çš„å¼€å‘æ•ˆç‡ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ã€‚æˆ‘ä»¬å¦‚ä½•èƒ½å¤Ÿæ›´å¿«æ›´å¥½çš„ä½¿ç”¨chromeæ’ä»¶å‘¢ï¼Ÿ</p></blockquote><p>ä¸”å¬ç¬”è€…å¨“å¨“é“æ¥~</p><hr><div class="tip">åœ¨æ—¥å¸¸å·¥ä½œè¿‡ç¨‹ä¸­ã€‚ç¬”è€…æ¥åˆ°äº†ä¸€ä¸ªæ™®é€šçš„é¡µé¢å¼€å‘çš„éœ€æ±‚ï¼›ä»…éœ€è¦å±•ç¤ºä¸€ä¸ªè¡¨æ ¼æ•°æ®å³å¯ï¼Œå½“åç«¯çš„æ¥å£æ–‡æ¡£å‘ç»™æˆ‘æ—¶ï¼Œæˆ‘å¯¹ç€ä¸€ä¸ªè¡¨æ ¼å¤§çº¦ä¸ƒå…«åä¸ªçš„å­—æ®µé™·å…¥äº†æ²‰æ€ğŸ˜±ï¼ˆæˆ‘ä¸ä»…è¦è°ƒæ•´æ˜ å°„ï¼Œè¿˜è¦æŠŠä¸‹åˆ’çº¿æ”¹æˆé©¼å³°ï¼‰ï¼Œæœ¬ç€æ‡’ç™Œç—‡æ™šæœŸæ‚£è€…çš„åŸåˆ™ï¼Œæˆ‘æ‹¿èµ·äº†chromeæ’ä»¶çš„å­¦ä¹ æ‰‹å†Œã€‚ã€‚ã€‚</div><h1 id="ä¸€ã€å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨"><a href="#ä¸€ã€å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨" class="headerlink" title="ä¸€ã€å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨"></a>ä¸€ã€å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨</h1><h2 id="chromeæ’ä»¶åŸºæœ¬ä»‹ç»"><a href="#chromeæ’ä»¶åŸºæœ¬ä»‹ç»" class="headerlink" title="chromeæ’ä»¶åŸºæœ¬ä»‹ç»"></a>chromeæ’ä»¶åŸºæœ¬ä»‹ç»</h2><ul><li>Manifest ï¼ˆæ¸…å•æ–‡ä»¶ï¼‰</li><li>Service_workerï¼ˆåå°è„šæœ¬ï¼‰</li><li>UI Elements ï¼ˆé¡µé¢å…ƒç´ ï¼‰</li><li>Content Script ï¼ˆå†…å®¹è„šæœ¬ï¼‰</li></ul><p>æ•´ä½“çš„ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š<br><img src="/images/extension/1611729839420_.pic.jpg" alt="ç»“æ„å›¾"></p><h2 id="Manifest"><a href="#Manifest" class="headerlink" title="Manifest"></a>Manifest</h2><p>ç›¸å½“äºæ’ä»¶çš„ meta ä¿¡æ¯ï¼ŒåŒ…å«æ’ä»¶çš„åç§°ã€ç‰ˆæœ¬å·ã€å›¾æ ‡ã€è„šæœ¬æ–‡ä»¶åç§°ç­‰ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯æ¯ä¸ªæ’ä»¶éƒ½å¿…é¡»æä¾›çš„ã€‚</p><p>ä¸»è¦çš„é…ç½®é¡¹ä»‹ç»å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;name&quot;</span>: <span class="string">&quot;extract table&quot;</span>, <span class="comment">// åç§°</span></span><br><span class="line">  <span class="string">&quot;description&quot;</span>: <span class="string">&quot;An introductory tutorial&quot;</span>, <span class="comment">// æè¿°</span></span><br><span class="line">  <span class="string">&quot;version&quot;</span>: <span class="string">&quot;1.0&quot;</span>, <span class="comment">// æ’ä»¶çš„ç‰ˆæœ¬</span></span><br><span class="line">  <span class="string">&quot;manifest_version&quot;</span>: <span class="number">3</span>, <span class="comment">// æ¸…å•çš„ç‰ˆæœ¬ï¼Œç›®å‰éƒ½æ˜¯ä½¿ç”¨ V3</span></span><br><span class="line">  <span class="comment">// action å­—æ®µä¸»è¦æè¿°ç‚¹å‡»å³ä¸Šè§’å›¾æ ‡å¼¹å‡ºçš„é¡µé¢</span></span><br><span class="line">  <span class="string">&quot;action&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;default_popup&quot;</span>: <span class="string">&quot;index.html&quot;</span> <span class="comment">// å¯¹åº”çš„å…¥å£ html æ–‡ä»¶ï¼ˆPopup åœ¨åé¢ä»‹ç»ï¼‰</span></span><br><span class="line">    <span class="string">&quot;default_title&quot;</span>: <span class="string">&quot;Garfish Module&quot;</span>,</span><br><span class="line">    <span class="string">&quot;default_icon&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;16&quot;</span>: <span class="string">&quot;favicon.ico&quot;</span>,</span><br><span class="line">      <span class="string">&quot;48&quot;</span>: <span class="string">&quot;favicon.ico&quot;</span>,</span><br><span class="line">      <span class="string">&quot;128&quot;</span>: <span class="string">&quot;favicon.ico&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">    <span class="comment">// éœ€è¦ä½¿ç”¨ä¸€äº›ç‰¹æ®Š API æ—¶éœ€è¦åœ¨ permissions å£°æ˜æƒé™ï¼Œä¼šæç¤ºç»™ç”¨æˆ·</span></span><br><span class="line">  <span class="string">&quot;permissions&quot;</span>: [<span class="string">&quot;storage&quot;</span>, <span class="string">&quot;scripting&quot;</span>],</span><br><span class="line">  <span class="comment">// å“ªäº›åŸŸåå…è®¸ä½¿ç”¨æ’ä»¶</span></span><br><span class="line">  <span class="string">&quot;host_permissions&quot;</span>: [<span class="string">&quot;&lt;all_urls&gt;&quot;</span>],</span><br><span class="line">  <span class="comment">// å£°æ˜ background service worker çš„è·¯å¾„ï¼Œåœ¨åé¢ä»‹ç»</span></span><br><span class="line">  <span class="string">&quot;background&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;service_worker&quot;</span>: <span class="string">&quot;background.js&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// å£°æ˜ content script çš„å…¥å£æ–‡ä»¶è·¯å¾„ã€å…è®¸ä½¿ç”¨çš„åŸŸåä»¥åŠæ‰§è¡Œæ—¶æœº</span></span><br><span class="line">  <span class="string">&quot;content_scripts&quot;</span>: [&#123;</span><br><span class="line">    <span class="string">&quot;js&quot;</span>: [<span class="string">&quot;content.js&quot;</span>]</span><br><span class="line">    <span class="string">&quot;matches&quot;</span>: [<span class="string">&quot;&lt;all_urls&gt;&quot;</span>],</span><br><span class="line">    <span class="comment">//  &quot;document_start&quot; &quot;document_idle&quot; &quot;document_end&quot; ä¸‰ä¸ªå€¼</span></span><br><span class="line">    <span class="string">&quot;run_at&quot;</span>: <span class="string">&quot;document_idle&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Service-workerï¼ˆåå°è„šæœ¬ï¼‰"><a href="#Service-workerï¼ˆåå°è„šæœ¬ï¼‰" class="headerlink" title="Service_workerï¼ˆåå°è„šæœ¬ï¼‰"></a>Service_workerï¼ˆåå°è„šæœ¬ï¼‰</h2><p>manifest v2ä¸­ç§°ä¹‹ä¸º<code>background script</code>,v3ç»Ÿä¸€æˆ service_worker.</p><p>å¯ä»¥è°ƒç”¨å…¨éƒ¨çš„ chrome æ’ä»¶ APIï¼Œå®ç°è·¨åŸŸè¯·æ±‚ã€ç½‘é¡µæˆªå±ã€å¼¹å‡º chrome é€šçŸ¥æ¶ˆæ¯ç­‰åŠŸèƒ½ã€‚æ’ä»¶æ¿€æ´»åä¼šåœ¨æµè§ˆå™¨åå°é»˜é»˜è¿è¡Œã€‚</p><h2 id="UI-Elements-ï¼ˆé¡µé¢å…ƒç´ ï¼‰"><a href="#UI-Elements-ï¼ˆé¡µé¢å…ƒç´ ï¼‰" class="headerlink" title="UI Elements ï¼ˆé¡µé¢å…ƒç´ ï¼‰"></a>UI Elements ï¼ˆé¡µé¢å…ƒç´ ï¼‰</h2><p> ä¸»è¦åŒ…æ‹¬ç‚¹å‡»æ’ä»¶çš„å¼¹å‡ºæ¡†ï¼ˆpopupï¼‰ã€æ’ä»¶çš„é…ç½®é¡µï¼ˆoptonsï¼‰,æ’å…¥åˆ°æ§åˆ¶å°çš„tabé¡µç­‰ç­‰ã€‚</p><h2 id="Content-Script-ï¼ˆå†…å®¹è„šæœ¬ï¼‰"><a href="#Content-Script-ï¼ˆå†…å®¹è„šæœ¬ï¼‰" class="headerlink" title="Content Script ï¼ˆå†…å®¹è„šæœ¬ï¼‰"></a>Content Script ï¼ˆå†…å®¹è„šæœ¬ï¼‰</h2><p>æ˜¯æ’ä»¶æ³¨å…¥åˆ°é¡µé¢çš„è„šæœ¬ï¼Œä½†æ˜¯ä¸ä¼šä½“ç°åœ¨é¡µé¢ DOM ç»“æ„é‡Œã€‚åœ¨ä¸€ä¸ªå•ç‹¬çš„æ²™ç›’å†…è¿è¡Œï¼Œå¯ä»¥æ“ä½œé¡µé¢çš„DOMã€è°ƒç”¨æœ‰é™çš„æ’ä»¶APIç­‰ã€‚</p><h2 id="é¡µé¢é€šä¿¡"><a href="#é¡µé¢é€šä¿¡" class="headerlink" title="é¡µé¢é€šä¿¡"></a>é¡µé¢é€šä¿¡</h2><blockquote><p>ç”±äºcontent_scriptsæ˜¯åœ¨ç½‘é¡µä¸­è¿è¡Œçš„ï¼Œè€Œéåœ¨æ‰©å±•çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œå› æ­¤å®ƒä»¬é€šå¸¸éœ€è¦æŸç§æ–¹å¼ä¸æ‰©å±•çš„å…¶ä½™éƒ¨åˆ†è¿›è¡Œé€šä¿¡ã€‚extensions å’Œcontent_scriptsä¹‹é—´çš„é€šä¿¡é€šè¿‡ä½¿ç”¨æ¶ˆæ¯ä¼ é€’è¿›è¡Œã€‚ ä»»ä½•ä¸€æ–¹éƒ½å¯ä»¥ä¾¦å¬ä»å¦ä¸€ç«¯å‘é€çš„æ¶ˆæ¯ï¼Œå¹¶åœ¨åŒä¸€é€šé“ä¸Šåšå‡ºå“åº”ã€‚</p></blockquote><h3 id="ä»content-scriptså‘é€æ¶ˆæ¯çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š"><a href="#ä»content-scriptså‘é€æ¶ˆæ¯çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š" class="headerlink" title="ä»content_scriptså‘é€æ¶ˆæ¯çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š"></a>ä»content_scriptså‘é€æ¶ˆæ¯çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">(<span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> response = <span class="keyword">await</span> chrome.<span class="property">runtime</span>.<span class="title function_">sendMessage</span>(&#123;<span class="attr">greeting</span>: <span class="string">&quot;hello&quot;</span>&#125;);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(response);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h3 id="ä»ã€options-page-bakcground-popupã€‘ç­‰ä½ç½®å‘é€åˆ°-content-scriptsçš„-ä»£ç ç¤ºä¾‹"><a href="#ä»ã€options-page-bakcground-popupã€‘ç­‰ä½ç½®å‘é€åˆ°-content-scriptsçš„-ä»£ç ç¤ºä¾‹" class="headerlink" title="ä»ã€options_page,bakcground,popupã€‘ç­‰ä½ç½®å‘é€åˆ° content_scriptsçš„ ä»£ç ç¤ºä¾‹:"></a>ä»ã€options_page,bakcground,popupã€‘ç­‰ä½ç½®å‘é€åˆ° content_scriptsçš„ ä»£ç ç¤ºä¾‹:</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">(<span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> [tab] = <span class="keyword">await</span> chrome.<span class="property">tabs</span>.<span class="title function_">query</span>(&#123;<span class="attr">active</span>: <span class="literal">true</span>, <span class="attr">lastFocusedWindow</span>: <span class="literal">true</span>&#125;);</span><br><span class="line">  <span class="keyword">const</span> response = <span class="keyword">await</span> chrome.<span class="property">tabs</span>.<span class="title function_">sendMessage</span>(tab.<span class="property">id</span>, &#123;<span class="attr">greeting</span>: <span class="string">&quot;hello&quot;</span>&#125;);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(response);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h3 id="é€šè¿‡runtime-onMessageäº‹ä»¶ä¾¦å¬å™¨æ¥å¤„ç†æ¶ˆæ¯"><a href="#é€šè¿‡runtime-onMessageäº‹ä»¶ä¾¦å¬å™¨æ¥å¤„ç†æ¶ˆæ¯" class="headerlink" title="é€šè¿‡runtime.onMessageäº‹ä»¶ä¾¦å¬å™¨æ¥å¤„ç†æ¶ˆæ¯"></a>é€šè¿‡runtime.onMessageäº‹ä»¶ä¾¦å¬å™¨æ¥å¤„ç†æ¶ˆæ¯</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">chrome.<span class="property">runtime</span>.<span class="property">onMessage</span>.<span class="title function_">addListener</span>(</span><br><span class="line">  <span class="keyword">function</span>(<span class="params">request, sender, sendResponse</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(sender.<span class="property">tab</span> ? <span class="string">&quot;from a content script:&quot;</span> + sender.<span class="property">tab</span>.<span class="property">url</span> :<span class="string">&quot;from the extension&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (request.<span class="property">greeting</span> === <span class="string">&quot;hello&quot;</span>)</span><br><span class="line">      <span class="title function_">sendResponse</span>(&#123;<span class="attr">farewell</span>: <span class="string">&quot;goodbye&quot;</span>&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>é™¤æ­¤ä¹‹å¤–ï¼Œæ’ä»¶è¿˜æä¾›äº†é•¿è¿æ¥æ¥å®ç°é€šä¿¡ã€‚</p><h2 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h2><p>ä¿®æ”¹äº†devtoolsé¡µé¢çš„ä»£ç æ—¶ï¼Œéœ€è¦å…ˆåœ¨ æ‰©å±•ç¨‹åºé¡µé¢ä¸‹é‡æ–°åŠ è½½æ’ä»¶ï¼Œç„¶åå…³é—­å†æ‰“å¼€å¼€å‘è€…å·¥å…·å³å¯ï¼Œæ— éœ€åˆ·æ–°é¡µé¢ã€‚</p><h1 id="äºŒã€ç‰›åˆ€å°è¯•"><a href="#äºŒã€ç‰›åˆ€å°è¯•" class="headerlink" title="äºŒã€ç‰›åˆ€å°è¯•"></a>äºŒã€ç‰›åˆ€å°è¯•</h1><h2 id="é¦–å…ˆåˆ›å»ºå¥½æˆ‘ä»¬çš„é¡¹ç›®æ–‡ä»¶ï¼Œè®¾ç½®å¥½æˆ‘ä»¬éœ€è¦çš„é…ç½®"><a href="#é¦–å…ˆåˆ›å»ºå¥½æˆ‘ä»¬çš„é¡¹ç›®æ–‡ä»¶ï¼Œè®¾ç½®å¥½æˆ‘ä»¬éœ€è¦çš„é…ç½®" class="headerlink" title="é¦–å…ˆåˆ›å»ºå¥½æˆ‘ä»¬çš„é¡¹ç›®æ–‡ä»¶ï¼Œè®¾ç½®å¥½æˆ‘ä»¬éœ€è¦çš„é…ç½®"></a>é¦–å…ˆåˆ›å»ºå¥½æˆ‘ä»¬çš„é¡¹ç›®æ–‡ä»¶ï¼Œè®¾ç½®å¥½æˆ‘ä»¬éœ€è¦çš„é…ç½®</h2><p><img src="/images/extension/1621729839421_.pic.jpg" alt="image.png"></p><h2 id="åœ¨popupä¸­å®ç°ç•Œé¢çš„ç»˜åˆ¶å’ŒæŒ‰é’®äº‹ä»¶çš„ç»‘å®š"><a href="#åœ¨popupä¸­å®ç°ç•Œé¢çš„ç»˜åˆ¶å’ŒæŒ‰é’®äº‹ä»¶çš„ç»‘å®š" class="headerlink" title="åœ¨popupä¸­å®ç°ç•Œé¢çš„ç»˜åˆ¶å’ŒæŒ‰é’®äº‹ä»¶çš„ç»‘å®š"></a>åœ¨popupä¸­å®ç°ç•Œé¢çš„ç»˜åˆ¶å’ŒæŒ‰é’®äº‹ä»¶çš„ç»‘å®š</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> targetDom = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;targetDom&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> columnKey = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;key&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> btn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;clickBtn&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> result = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#result&#x27;</span>);</span><br><span class="line"><span class="comment">//å‘é€domç»™contentå»è§£æ</span></span><br><span class="line">btn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>,<span class="title function_">async</span> ()=&gt;&#123;</span><br><span class="line">  <span class="keyword">var</span> classname = targetDom.<span class="property">value</span>;</span><br><span class="line">  <span class="keyword">if</span>(classname)&#123;</span><br><span class="line">    selector = classname.<span class="title function_">split</span>(<span class="string">&#x27; &#x27;</span>).<span class="title function_">map</span>(<span class="function"><span class="params">i</span>=&gt;</span><span class="string">`.<span class="subst">$&#123;i&#125;</span>`</span>).<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    chrome.<span class="property">tabs</span>.<span class="title function_">query</span>(&#123;<span class="attr">active</span>:<span class="literal">true</span>,<span class="attr">currentWindow</span>:<span class="literal">true</span>&#125;,<span class="function">(<span class="params">tabs</span>)=&gt;</span>&#123;</span><br><span class="line">      chrome.<span class="property">tabs</span>.<span class="title function_">sendMessage</span>(tabs[<span class="number">0</span>].<span class="property">id</span>,&#123;selector,columnKey&#125;,<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;response&#x27;</span>,res);</span><br><span class="line">        result.<span class="property">innerText</span> = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(res,<span class="literal">null</span>,<span class="number">4</span>);</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="åœ¨content-scriptsä¸­æ¥æ”¶å‚æ•°å¹¶å®Œæˆdomç»“æ„è§£æï¼Œæœ€ç»ˆæŠŠæ•°æ®è¿”å›ç»™popupé€æ˜¾ã€‚"><a href="#åœ¨content-scriptsä¸­æ¥æ”¶å‚æ•°å¹¶å®Œæˆdomç»“æ„è§£æï¼Œæœ€ç»ˆæŠŠæ•°æ®è¿”å›ç»™popupé€æ˜¾ã€‚" class="headerlink" title="åœ¨content_scriptsä¸­æ¥æ”¶å‚æ•°å¹¶å®Œæˆdomç»“æ„è§£æï¼Œæœ€ç»ˆæŠŠæ•°æ®è¿”å›ç»™popupé€æ˜¾ã€‚"></a>åœ¨content_scriptsä¸­æ¥æ”¶å‚æ•°å¹¶å®Œæˆdomç»“æ„è§£æï¼Œæœ€ç»ˆæŠŠæ•°æ®è¿”å›ç»™popupé€æ˜¾ã€‚</h2><p>è¿™æ ·æˆ‘ä»¬å°±å®Œæˆäº†ä¸€ä¸ªåŸºç¡€ç‰ˆçš„æ’ä»¶å¼€å‘ã€‚å½“ç„¶ï¼Œåœ¨ç°ä»£å¼€å‘æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬è‚¯å®šä¸èƒ½æ¥å—å¦‚æ­¤ç®€é™‹çš„å¼€å‘æ¨¡å¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è¿›è¡Œä¸‹ä¸€æ­¥çš„ä¼˜åŒ–å‘¢ï¼Œæˆ‘ä»¬ä¸‹ç¯‡ç»§ç»­~</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;chromeæµè§ˆå™¨çš„æ’ä»¶ç›¸ä¿¡å¤§å®¶åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­éƒ½ä¼šç”¨åˆ°ï¼Œåº”ç”¨å¸‚åœºä¸Šçš„å„ç§æ’ä»¶ä¸ä»…ä¸ªæ€§åŒ–äº†æˆ‘ä»¬çš„æµè§ˆå™¨UIè®¾ç½®ï¼ˆæ¯”å¦‚å„ç§tabé¡µä¸»é¢˜è®¾ç½®æ’ä»¶ï¼‰ï¼ŒåŒæ—¶ä¹Ÿæä¾›äº†æ›´ä¸ºå¼ºå¤§çš„è¾…åŠ©å·¥å…·ã€‚&lt;/p&gt;</summary>
    
    
    
    
    <category term="æ¶æ„" scheme="https://tauleos.github.io/tags/%E6%9E%B6%E6%9E%84/"/>
    
    <category term="Chrome" scheme="https://tauleos.github.io/tags/Chrome/"/>
    
  </entry>
  
  <entry>
    <title>TSä¸­includesç­‰APIä¸è¯†åˆ«å‘</title>
    <link href="https://tauleos.github.io/db04494e7d11.html"/>
    <id>https://tauleos.github.io/db04494e7d11.html</id>
    <published>2022-03-10T07:08:33.000Z</published>
    <updated>2024-11-06T08:27:08.635Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘åŸºç¡€åº“çº¿ä¸Šé‡åˆ°ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„é—®é¢˜ï¼Œç”¨æˆ·åœ¨<code>android 5.0</code>æµè§ˆå™¨ä¸Šè®¿é—®å¼•å…¥åŸºç¡€åº“çš„é¡µé¢æ—¶ç›´æ¥æŠ¥é”™ï¼Œé”™è¯¯ä¿¡æ¯æ˜¯ç»å…¸çš„<code>&quot;Can not read property xxx of undefined&quot;</code>é”™è¯¯ã€‚ç»è¿‡åˆ†æè°ƒç ”å‘ç°æ˜¯å› ä¸ºé¡¹ç›®ä¸­ä½¿ç”¨äº†<code>Array.prototype.includes</code>å¯¼è‡´ã€‚å®šä½åˆ°é—®é¢˜åä¼˜å…ˆåŠ äº†<code>polyfill</code>è§£å†³çº¿ä¸Šé—®é¢˜.<br>äº‹åè°ƒç ”ä¸ºä»€ä¹ˆä¼šå‘ç”Ÿè¿™æ ·çš„é—®é¢˜ï¼Œæœ€ç»ˆç»“è®ºå¦‚ä¸‹ï¼š</p><blockquote><p>typescriptæœ¬èº«çš„ç¼–è¯‘å·¥å…·åªä¼šå¯¹æ‰€è°“çš„è¯­æ³•ï¼ˆä¹Ÿå°±æ˜¯<code>syntax</code>ï¼‰è¿›è¡Œè½¬æ¢ï¼Œä»¥åŒ¹é…<code>tsconfig.json</code> ä¸­çš„<code>target</code>é€‰é¡¹ï¼Œè€Œå¯¹äº<code>es6/7/8</code>ä¸­æ–°å‡ºç°çš„<code>API</code>,æ¯”å¦‚<code>Array.prototype.includes</code>,<code>Object.values</code>ç­‰æ–¹æ³•ï¼Œ<code>typescript</code> å¹¶ä¸ä¼šè¿›è¡Œè½¬æ¢ã€‚</p></blockquote><p>tsä»£ç </p><p><img src="/images/ts-api/before.png"></p><p>ç¼–è¯‘åä»£ç <br><img src="/images/ts-api/after.png"></p><h2 id="æœ€ç»ˆç»“è®º"><a href="#æœ€ç»ˆç»“è®º" class="headerlink" title="æœ€ç»ˆç»“è®º"></a>æœ€ç»ˆç»“è®º</h2><blockquote><p><code>typescript</code>æœ¬èº«æ˜¯é™æ€æ£€æŸ¥å·¥å…·ï¼Œå®ƒä¸ä¼šåœ¨è¿è¡Œæ—¶æ ¹æ®ä»£ç æ‰€è¿è¡Œçš„ç¯å¢ƒå†è‡ªåŠ¨<code>polyfill</code>;å®ƒåªæ˜¯å‡å®šä½ æœ¬èº«é¡¹ç›®æ‰€è¿è¡Œçš„ç¯å¢ƒæ˜¯<code>tsconfig</code>çš„<code>lib</code>å±æ€§æŒ‡å®šçš„ç¯å¢ƒã€‚</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ€è¿‘åŸºç¡€åº“çº¿ä¸Šé‡åˆ°ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„é—®é¢˜ï¼Œç”¨æˆ·åœ¨&lt;code&gt;android 5.0&lt;/code&gt;æµè§ˆå™¨ä¸Šè®¿é—®å¼•å…¥åŸºç¡€åº“çš„é¡µé¢æ—¶ç›´æ¥æŠ¥é”™ï¼Œé”™è¯¯ä¿¡æ¯æ˜¯ç»å…¸çš„&lt;code&gt;&amp;quot;Can not read property xxx of undefined&amp;quot;&lt;/code&gt;é”™</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ä»é›¶æ‰“é€ è£…é¥°å™¨é£æ ¼çš„NodeJsè·¯ç”±å™¨</title>
    <link href="https://tauleos.github.io/f559cd027a92.html"/>
    <id>https://tauleos.github.io/f559cd027a92.html</id>
    <published>2022-03-10T06:43:44.000Z</published>
    <updated>2024-11-06T08:27:08.636Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æœ¬æ–‡ç« é»˜è®¤å¬ä¼—ä½¿ç”¨Koaæ¡†æ¶ã€‚</p></blockquote><p>åœ¨æˆ‘ä»¬ä½¿ç”¨nodejså¼€å‘é¡¹ç›®çš„æ—¶å€™ï¼Œå¦‚æœé¡¹ç›®ä¸­æœ‰å¾ˆå¤šè·¯ç”±ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å†™å¾ˆå¤šçš„ç±»ä¼¼<code>router.get(&#39;xxx&#39;, () =&gt; &#123;&#125;)</code>è¿™æ ·çš„ä»£ç ã€‚</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">Koa</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Router</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa-router&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> app = <span class="keyword">new</span> <span class="title class_">Koa</span>();</span><br><span class="line"><span class="keyword">var</span> router = <span class="keyword">new</span> <span class="title class_">Router</span>();</span><br><span class="line">router</span><br><span class="line">  .<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">ctx, next</span>) =&gt;</span> &#123;</span><br><span class="line">    ctx.<span class="property">body</span> = <span class="string">&#x27;Hello World!&#x27;</span>;</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">post</span>(<span class="string">&#x27;/users&#x27;</span>, <span class="function">(<span class="params">ctx, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">put</span>(<span class="string">&#x27;/users/:id&#x27;</span>, <span class="function">(<span class="params">ctx, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure><p>ç†Ÿæ‚‰<code>Java</code>çš„æœ‹å‹åº”è¯¥éƒ½çŸ¥é“ï¼Œ å¯ä»¥é€šè¿‡ä»¥ä¸‹å½¢å¼å®šä¹‰è·¯ç”±</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HomeController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/list&quot;, method = RequestMethod.GET)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/update&quot;, method = RequestMethod.POST)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·ä¸ä»…ç®€åŒ–ã€è§„èŒƒåŒ–äº†è·¯ç”±çš„å†™æ³•ï¼Œå‡å°‘äº†ä»£ç çš„å†—ä½™å’Œé”™è¯¯ï¼Œè¿˜ä½¿ä»£ç å«ä¹‰ä¸€ç›®äº†ç„¶ï¼Œæ— éœ€æ³¨é‡Šä¹Ÿèƒ½é€šä¿—æ˜“æ‡‚ã€‚é‚£ä¹ˆ<code>Java</code>ä¸­çš„æ³¨è§£åŠŸèƒ½å¯¹åº”åˆ°<code>NodeJs</code>ï¼Œåˆ†åˆ«æ˜¯ä¸€ä¸‹ä¸¤ç§å·¥å…·ï¼š<strong>è£…é¥°å™¨ä¸å…ƒç¼–ç¨‹</strong>ã€‚æˆ‘ä»¬æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥é€šè¿‡è£…é¥°å™¨æ¥è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„å‘¢?é¦–å…ˆè®©æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ä»–ä»¬ã€‚</p><h2 id="Decorator-è£…é¥°å™¨"><a href="#Decorator-è£…é¥°å™¨" class="headerlink" title="Decorator(è£…é¥°å™¨)"></a>Decorator(è£…é¥°å™¨)</h2><p>è£…é¥°å™¨æä¾›äº†ä¸€ç§ä¸ºç±»å£°æ˜å’Œæˆå‘˜æ·»åŠ æ³¨é‡Šå’Œå…ƒç¼–ç¨‹è¯­æ³•çš„æ–¹æ³•ã€‚è£…é¥°å™¨æ˜¯<code>JavaScript</code>çš„<a href="https://github.com/tc39/proposal-decorators">stage-2 proposal</a>ï¼Œå¯ä½œä¸º <code>TypeScript</code> çš„å®éªŒæ€§åŠŸèƒ½ä½¿ç”¨ã€‚</p><blockquote><p>æ³¨æ„è£…é¥°å™¨æ˜¯ä¸€é¡¹å®éªŒæ€§åŠŸèƒ½ï¼Œå¯èƒ½ä¼šåœ¨æœªæ¥ç‰ˆæœ¬ä¸­æ›´æ”¹ã€‚</p></blockquote><p>è¦å¯ç”¨å¯¹è£…é¥°å™¨çš„å®éªŒæ€§æ”¯æŒï¼Œå¿…é¡»è¦åœ¨<code>tsconfig.json</code>ä¸­é…ç½®æ‰“å¼€<code>experimentalDecorators</code>è¿™ä¸ªç¼–è¯‘å±æ€§<br><img src="/images/decorator/ts-definition.png"></p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">TypedPropertyDescriptor</span>&lt;T&gt; &#123;</span><br><span class="line">    enumerable?: <span class="built_in">boolean</span>;</span><br><span class="line">    configurable?: <span class="built_in">boolean</span>;</span><br><span class="line">    writable?: <span class="built_in">boolean</span>;</span><br><span class="line">    value?: T;</span><br><span class="line">    get?: <span class="function">() =&gt;</span> T;</span><br><span class="line">    set?: <span class="function">(<span class="params"><span class="attr">value</span>: T</span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">type</span> <span class="title class_">ClassDecorator</span> = &lt;<span class="title class_">TFunction</span> <span class="keyword">extends</span> <span class="title class_">Function</span>&gt;<span class="function">(<span class="params"><span class="attr">target</span>: <span class="title class_">TFunction</span></span>) =&gt;</span> <span class="title class_">TFunction</span> | <span class="built_in">void</span>;</span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">type</span> <span class="title class_">PropertyDecorator</span> = <span class="function">(<span class="params"><span class="attr">target</span>: <span class="title class_">Object</span>, <span class="attr">propertyKey</span>: <span class="built_in">string</span> | <span class="built_in">symbol</span></span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">type</span> <span class="title class_">MethodDecorator</span> = &lt;T&gt;<span class="function">(<span class="params"><span class="attr">target</span>: <span class="title class_">Object</span>, <span class="attr">propertyKey</span>: <span class="built_in">string</span> | <span class="built_in">symbol</span>, <span class="attr">descriptor</span>: <span class="title class_">TypedPropertyDescriptor</span>&lt;T&gt;</span>) =&gt;</span> <span class="title class_">TypedPropertyDescriptor</span>&lt;T&gt; | <span class="built_in">void</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">type</span> <span class="title class_">ParameterDecorator</span> = <span class="function">(<span class="params"><span class="attr">target</span>: <span class="title class_">Object</span>, <span class="attr">propertyKey</span>: <span class="built_in">string</span> | <span class="built_in">symbol</span>, <span class="attr">parameterIndex</span>: <span class="built_in">number</span></span>) =&gt;</span> <span class="built_in">void</span>;</span><br></pre></td></tr></table></figure><h3 id="æ‰§è¡Œé¡ºåº"><a href="#æ‰§è¡Œé¡ºåº" class="headerlink" title="æ‰§è¡Œé¡ºåº"></a>æ‰§è¡Œé¡ºåº</h3><ol><li>ä¸åŒç±»å‹çš„è£…é¥°å™¨çš„æ‰§è¡Œé¡ºåºæ˜¯æ˜ç¡®å®šä¹‰çš„ï¼š</li><li>å®ä¾‹æˆå‘˜:    å‚æ•°è£…é¥°å™¨ -&gt; æ–¹æ³• / è®¿é—®å™¨ / å±æ€§ è£…é¥°å™¨</li><li>é™æ€æˆå‘˜:    å‚æ•°è£…é¥°å™¨ -&gt; æ–¹æ³• / è®¿é—®å™¨ / å±æ€§ è£…é¥°å™¨</li><li>æ„é€ å™¨:        å‚æ•°è£…é¥°å™¨</li><li>ç±»è£…é¥°å™¨</li><li>åŒä¸€æ–¹æ³•ä¸­ä¸åŒå‚æ•°çš„è£…é¥°å™¨çš„æ‰§è¡Œé¡ºåºæ˜¯ç›¸åçš„ï¼Œ <strong>æœ€åä¸€ä¸ªå‚æ•°çš„è£…é¥°å™¨ä¼šæœ€å…ˆè¢«æ‰§è¡Œ</strong></li><li>å¤šä¸ªè£…é¥°å™¨ç»„åˆåº”ç”¨ï¼Œä»–ä»¬çš„æ‰§è¡Œé¡ºåºæ˜¯<strong>ç”±ä¸Šåˆ°ä¸‹ç¼–è¯‘ï¼Œç”±ä¸‹åˆ°ä¸Šæ‰§è¡Œï¼ˆFILOï¼‰,å¯ä»¥å½“åšæ ˆæ¥ç†è§£</strong></li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params">key: string</span>): any &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;evaluate: &quot;</span>, key);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;call: &quot;</span>, key);</span><br><span class="line">  &#125;;&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title function_">f</span>(<span class="string">&quot;Class Decorator&quot;</span>)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span> &#123;</span><br><span class="line">  @<span class="title function_">f</span>(<span class="string">&quot;Static Property&quot;</span>)</span><br><span class="line">  <span class="keyword">static</span> prop?: number;</span><br><span class="line"></span><br><span class="line">  @<span class="title function_">f</span>(<span class="string">&quot;Static Method&quot;</span>)</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">method</span>(<span class="params">@f(<span class="string">&quot;Static Method Parameter&quot;</span>) foo</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">@f(<span class="string">&quot;Constructor Parameter&quot;</span>) foo</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  @<span class="title function_">f</span>(<span class="string">&quot;Instance Method&quot;</span>)</span><br><span class="line">  <span class="title function_">method</span>(<span class="params">@f(<span class="string">&quot;Instance Method Parameter&quot;</span>) foo</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  @<span class="title function_">f</span>(<span class="string">&quot;Instance Property&quot;</span>)</span><br><span class="line">  prop?: number;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="reflect-metadata-å…ƒæ•°æ®"><a href="#reflect-metadata-å…ƒæ•°æ®" class="headerlink" title="reflect-metadata(å…ƒæ•°æ®)"></a><a href="https://github.com/rbuckton/reflect-metadata">reflect-metadata</a>(å…ƒæ•°æ®)</h2><blockquote><p>ä¸¥æ ¼åœ°è¯´ï¼Œå…ƒæ•°æ®å’Œè£…é¥°å™¨æ˜¯<code>EcmaScript</code>ä¸­ä¸¤ä¸ªç‹¬ç«‹çš„éƒ¨åˆ†ã€‚ ç„¶è€Œï¼Œå¦‚æœä½ æƒ³å®ç°åƒæ˜¯<a href="https://zh.wikipedia.org/wiki/%E5%8F%8D%E5%B0%84_(%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6)">åå°„</a>è¿™æ ·çš„èƒ½åŠ›ï¼Œä½ æ€»æ˜¯åŒæ—¶éœ€è¦å®ƒä»¬ã€‚<br>æœ‰äº†<code>reflect-metadata</code>çš„å¸®åŠ©ï¼Œ æˆ‘ä»¬å¯ä»¥è·å–ç¼–è¯‘æœŸçš„ç±»å‹ã€‚</p></blockquote><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p><code>Reflect Metadata</code> æ˜¯ ES7 çš„ä¸€ä¸ªææ¡ˆï¼ˆstage-2ï¼‰ï¼Œå®ƒä¸»è¦ç”¨æ¥åœ¨å£°æ˜çš„æ—¶å€™æ·»åŠ å’Œè¯»å–å…ƒæ•°æ®ã€‚<code>TypeScript</code> åœ¨ 1.5+ çš„ç‰ˆæœ¬å·²ç»æ”¯æŒå®ƒï¼Œä½ åªéœ€è¦ï¼š</p><ul><li><code>npm i reflect-metadata --save</code></li><li>åœ¨ <code>tsconfig.json</code> é‡Œé…ç½® <code>emitDecoratorMetadata</code> é€‰é¡¹ã€‚</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">@<span class="title class_">Reflect</span>.<span class="title function_">metadata</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;A&#x27;</span>)<span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line">  @<span class="title class_">Reflect</span>.<span class="title function_">metadata</span>(<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;world&#x27;</span>)</span><br><span class="line">  public <span class="title function_">hello</span>(): string &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;hello world&#x27;</span></span><br><span class="line">  &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Reflect</span>.<span class="title function_">getMetadata</span>(<span class="string">&#x27;name&#x27;</span>, A) <span class="comment">// &#x27;A&#x27;</span></span><br><span class="line"><span class="title class_">Reflect</span>.<span class="title function_">getMetadata</span>(<span class="string">&#x27;hello&#x27;</span>, <span class="keyword">new</span> <span class="title function_">A</span>()) <span class="comment">// &#x27;world&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="API"><a href="#API" class="headerlink" title="API"></a>API</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// define metadata on an object or property</span></span><br><span class="line"><span class="title class_">Reflect</span>.<span class="title function_">defineMetadata</span>(metadataKey, metadataValue, target);</span><br><span class="line"><span class="title class_">Reflect</span>.<span class="title function_">defineMetadata</span>(metadataKey, metadataValue, target, propertyKey);</span><br><span class="line"><span class="comment">// check for presence of a metadata key on the prototype chain of an object or property</span></span><br><span class="line"><span class="keyword">let</span> result = <span class="title class_">Reflect</span>.<span class="title function_">hasMetadata</span>(metadataKey, target);</span><br><span class="line"><span class="keyword">let</span> result = <span class="title class_">Reflect</span>.<span class="title function_">hasMetadata</span>(metadataKey, target, propertyKey);</span><br><span class="line"><span class="comment">// check for presence of an own metadata key of an object or property</span></span><br><span class="line"><span class="keyword">let</span> result = <span class="title class_">Reflect</span>.<span class="title function_">hasOwnMetadata</span>(metadataKey, target);</span><br><span class="line"><span class="keyword">let</span> result = <span class="title class_">Reflect</span>.<span class="title function_">hasOwnMetadata</span>(metadataKey, target, propertyKey);</span><br><span class="line"><span class="comment">// get metadata value of a metadata key on the prototype chain of an object or property</span></span><br><span class="line"><span class="keyword">let</span> result = <span class="title class_">Reflect</span>.<span class="title function_">getMetadata</span>(metadataKey, target);</span><br><span class="line"><span class="keyword">let</span> result = <span class="title class_">Reflect</span>.<span class="title function_">getMetadata</span>(metadataKey, target, propertyKey);</span><br><span class="line"><span class="comment">// get metadata value of an own metadata key of an object or property</span></span><br><span class="line"><span class="keyword">let</span> result = <span class="title class_">Reflect</span>.<span class="title function_">getOwnMetadata</span>(metadataKey, target);</span><br><span class="line"><span class="keyword">let</span> result = <span class="title class_">Reflect</span>.<span class="title function_">getOwnMetadata</span>(metadataKey, target, propertyKey);</span><br><span class="line"><span class="comment">// get all metadata keys on the prototype chain of an object or property</span></span><br><span class="line"><span class="keyword">let</span> result = <span class="title class_">Reflect</span>.<span class="title function_">getMetadataKeys</span>(target);</span><br><span class="line"><span class="keyword">let</span> result = <span class="title class_">Reflect</span>.<span class="title function_">getMetadataKeys</span>(target, propertyKey);</span><br><span class="line"><span class="comment">// get all own metadata keys of an object or property</span></span><br><span class="line"><span class="keyword">let</span> result = <span class="title class_">Reflect</span>.<span class="title function_">getOwnMetadataKeys</span>(target);</span><br><span class="line"><span class="keyword">let</span> result = <span class="title class_">Reflect</span>.<span class="title function_">getOwnMetadataKeys</span>(target, propertyKey);</span><br><span class="line"><span class="comment">// delete metadata from an object or property</span></span><br><span class="line"><span class="keyword">let</span> result = <span class="title class_">Reflect</span>.<span class="title function_">deleteMetadata</span>(metadataKey, target);</span><br><span class="line"><span class="keyword">let</span> result = <span class="title class_">Reflect</span>.<span class="title function_">deleteMetadata</span>(metadataKey, target, propertyKey);</span><br><span class="line"><span class="comment">// apply metadata via a decorator to a constructor</span></span><br><span class="line">@<span class="title class_">Reflect</span>.<span class="title function_">metadata</span>(metadataKey, metadataValue)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span> &#123;</span><br><span class="line">  <span class="comment">// apply metadata via a decorator to a method (property)</span></span><br><span class="line">  @<span class="title class_">Reflect</span>.<span class="title function_">metadata</span>(metadataKey, metadataValue)</span><br><span class="line">  <span class="title function_">method</span>(<span class="params"></span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¦‚ä½•ç”¨è£…é¥°å™¨æ‰“é€ è·¯ç”±ï¼Ÿ"><a href="#å¦‚ä½•ç”¨è£…é¥°å™¨æ‰“é€ è·¯ç”±ï¼Ÿ" class="headerlink" title="å¦‚ä½•ç”¨è£…é¥°å™¨æ‰“é€ è·¯ç”±ï¼Ÿ"></a>å¦‚ä½•ç”¨è£…é¥°å™¨æ‰“é€ è·¯ç”±ï¼Ÿ</h2><p><img src="/images/decorator/effects.png"></p><ol><li>æä¾›éœ€è¦æ³¨å†Œçš„è£…é¥°å™¨,é€šè¿‡<code>metadata</code>å­˜å‚¨å¯¹åº”çš„æ•°æ®ä¿¡æ¯ã€‚ </li><li>ç±»è£…é¥°å™¨ï¼š<code>@Controller()</code><br><img src="/images/decorator/controller.png"></li><li>æ–¹æ³•è£…é¥°å™¨ï¼š<code>@Get()ã€@Post()ã€@Put()ã€@Delete()</code><br><img src="/images/decorator/method.png"></li><li>å‚æ•°è£…é¥°å™¨ï¼š<code>@Request()ã€@Response()ã€@Ctx()ã€@Body()ã€@Param()ã€@Session()</code>ç­‰ç­‰ã€‚<br><img src="/images/decorator/param.png"></li><li>åˆ›å»ºä¸€ä¸ªä¾èµ–æ³¨å…¥çš„å®¹å™¨ï¼Œæ”¶é›†æ‰€æœ‰ä¸è·¯ç”±ç›¸å…³çš„é…ç½®ï¼Œå¹¶è¿›è¡Œè·¯ç”±æ³¨å†Œã€‚</li><li>éå†æ–‡ä»¶å¤¹ä¸­æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„Controlleræ–‡ä»¶ï¼Œå¹¶è·å–ç›¸åº”çš„Controllerç±»<br><img src="/images/decorator/scan.png"></li><li>æ‰«ææ¯ä¸ªControllerç±»çš„å®ä¾‹æ–¹æ³•ï¼Œæ£€æµ‹æ˜¯å¦éœ€è¦è·¯ç”±æ³¨å†Œï¼Œå¹¶æ ¹æ®metadataä¸­çš„æ•°æ®è¿›è¡Œè·¯ç”±çš„ç»„è£…ä¸æ³¨å†Œ<br><img src="/images/decorator/register.png"></li><li>ç»‘å®šControllerå®ä¾‹æ–¹æ³•åˆ°KoaRouterä¸­ï¼Œå¹¶æ³¨å…¥ç›¸å…³å‚æ•°ã€‚<br><img src="/images/decorator/callback.png"></li></ol><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>åœ¨é¡¹ç›®å¯åŠ¨é˜¶æ®µï¼Œä¼šåˆ›å»ºä¸€ä¸ªä¾èµ–æ³¨å…¥å®¹å™¨ï¼ˆ<code>Container</code>ï¼‰ï¼Œæ‰«ææ‰€æœ‰ç”¨æˆ·ä»£ç ï¼ˆ<code>Controller</code>ï¼‰ä¸­çš„æ–‡ä»¶ï¼Œå°†æ‹¥æœ‰<code>@Controller</code>è£…é¥°å™¨çš„ <code>Class</code>ï¼Œä¿å­˜åˆ°å®¹å™¨ä¸­ã€‚</li><li>è¿™é‡Œçš„ä¾èµ–æ³¨å…¥å®¹å™¨å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªæ•°ç»„ã€‚ç”¨æ¥å­˜æ”¾ç±»æœ¬èº«ã€‚</li><li>åœ¨æ‰«ææ—¶ï¼Œä¼šåŠ¨æ€å®ä¾‹åŒ–è¿™äº› Classï¼Œå¹¶ä¸”ç»‘å®šå±æ€§æ–¹æ³•ï¼ˆå‚æ•°ï¼‰ä¸è·¯ç”±çš„åŠ¨æ€å…³ç³»ï¼Œå¹¶ä¸”æ³¨å†Œåˆ°routerä¸­</li></ul><p>ä»¥ä¸Šå°±æ˜¯è·¯ç”±å™¨æ³¨å…¥çš„æ ¸å¿ƒè¿‡ç¨‹ã€‚</p><h2 id="åœºæ™¯æ‰©å±•"><a href="#åœºæ™¯æ‰©å±•" class="headerlink" title="åœºæ™¯æ‰©å±•"></a>åœºæ™¯æ‰©å±•</h2><ul><li>Before/Afteré’©å­ã€‚</li><li>ç›‘å¬å±æ€§æ”¹å˜æˆ–è€…æ–¹æ³•è°ƒç”¨ã€‚</li><li>å¯¹æ–¹æ³•çš„å‚æ•°åšè½¬æ¢ã€‚</li><li>æ·»åŠ é¢å¤–çš„æ–¹æ³•å’Œå±æ€§ã€‚</li><li>è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥ã€‚</li><li>ä¾èµ–æ³¨å…¥ï¼ˆdependency injectionï¼‰</li></ul><p>å‚è€ƒèµ„æ–™</p><ul><li><a href="https://www.typescriptlang.org/docs/handbook/decorators.html#introduction">https://www.typescriptlang.org/docs/handbook/decorators.html#introduction</a></li><li><a href="https://saul-mirone.github.io/a-complete-guide-to-typescript-decorator">https://saul-mirone.github.io/a-complete-guide-to-typescript-decorator</a></li><li><a href="https://rbuckton.github.io/reflect-metadata/">https://rbuckton.github.io/reflect-metadata/</a></li><li><a href="https://github.com/seanpmaxwell/overnight">https://github.com/seanpmaxwell/overnight</a></li><li><a href="https://nestjs.com/">https://nestjs.com/</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;æœ¬æ–‡ç« é»˜è®¤å¬ä¼—ä½¿ç”¨Koaæ¡†æ¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬ä½¿ç”¨nodejså¼€å‘é¡¹ç›®çš„æ—¶å€™ï¼Œå¦‚æœé¡¹ç›®ä¸­æœ‰å¾ˆå¤šè·¯ç”±ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å†™å¾ˆå¤šçš„ç±»ä¼¼&lt;code&gt;router.get(&amp;#39;xxx&amp;#39;, () =&amp;gt; &amp;#12</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•è§£å†³å¾®å‰ç«¯ä¸­çš„è·¯ç”±è·³è½¬å‘</title>
    <link href="https://tauleos.github.io/effa4f74d0af.html"/>
    <id>https://tauleos.github.io/effa4f74d0af.html</id>
    <published>2022-03-10T03:37:28.000Z</published>
    <updated>2024-11-06T08:27:08.637Z</updated>
    
    <content type="html"><![CDATA[<h2 id="äº‹ä»¶èƒŒæ™¯"><a href="#äº‹ä»¶èƒŒæ™¯" class="headerlink" title="äº‹ä»¶èƒŒæ™¯"></a>äº‹ä»¶èƒŒæ™¯</h2><blockquote><p>å•†å®¶å·¥ä½œå°ç›®å‰å·²ç»ä½¿ç”¨<a href="https://qiankun.umijs.org/">qiankun</a> æ”¹é€ æˆå¾®å‰ç«¯ä½“ç³»ï¼Œå¾®å‰ç«¯çš„å¥½å¤„ä¸ç”¨æˆ‘èµ˜è¿°ï¼Œå¤§å®¶æ‡‚çš„éƒ½æ‡‚ï¼Œå› æ­¤åœ¨æœ‰å“äºŒæ¸…é¡¹ç›®å¼€å‘æ—¶ä¹Ÿä»¥å¾®å‰ç«¯çš„æ–¹å¼è¿›è¡Œæ¥å…¥ã€‚åœ¨é€æµ‹è¿‡ç¨‹ä¸­ï¼Œæµ‹è¯•åŒå­¦åé¦ˆåœ¨ç‚¹å‡»æµè§ˆå™¨å›é€€çš„æ—¶å€™ä¼šé¡µé¢ç©ºç™½ï¼Œæˆ‘ä¸€è„¸è’™åœˆçš„è¯•äº†å¥½å‡ æ¬¡å´æ²¡å¤ç°ï¼Œæœ€ç»ˆåœ¨æœåŠ¡ç«¯åŒå­¦è·Ÿæµ‹è¯•åŒå­¦çš„å¤§åŠ›é…åˆä¸‹ï¼Œæ‰¾åˆ°äº†ç¨³å®šå¤ç°çš„åœºæ™¯ã€‚</p></blockquote><h2 id="é—®é¢˜å®šä½"><a href="#é—®é¢˜å®šä½" class="headerlink" title="é—®é¢˜å®šä½"></a>é—®é¢˜å®šä½</h2><blockquote><p>When you have eliminated the impossibles,whatever remains,however improbable,must be the truth.     â€“ ç¦å°”æ‘©æ–¯</p></blockquote><div class='tip'>ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ<p style="text-indent:20em;">åŸå› æœªçŸ¥ï¼Œéœ€è¦ç»§ç»­æ‹†è§£</p>ä»¥å‰æ¥å…¥è¿‡çš„å­åº”ç”¨æœ‰é‡åˆ°è¿‡è¿™ç§é—®é¢˜å‘¢ï¼Ÿ<p style="text-indent:20em;">å°±æˆ‘æ‰€çŸ¥æ²¡æœ‰</p>å¥½çš„ï¼Œä¸ºä»€ä¹ˆä»¥å‰çš„å­åº”ç”¨æ²¡æœ‰é‡åˆ°è¿‡å‘¢ï¼Ÿ<p style="text-indent:20em;">å› ä¸ºä»¥å‰çš„å­åº”ç”¨è·Ÿä¸»åº”ç”¨éƒ½æ˜¯vue2çš„router</p>é‚£å°±æ˜¯è¯´å¯èƒ½æ˜¯æ–°æ—§Routerå¯¼è‡´çš„å’¯ï¼Ÿ  <p style="text-indent:20em;">æœ‰å¯èƒ½å“¦~é—®é—®å…¶ä»–å­åº”ç”¨å‘¢</p>.....é—®è¿‡äº†ï¼Œäººå®¶æ˜¯å¥½çš„<p style="text-indent:20em;">      ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ.....å†æŠ¥å†æ¢ï¼</p></div><hr><p>ä»¥ä¸Šæ˜¯é‡åˆ°é—®é¢˜æ—¶æ··ä¹±çš„å¤§è„‘çš„ç–‘ç‚¹é—ªç°è¿‡ç¨‹ã€‚ä»ä¸­æˆ‘ä»¬ä¸éš¾æ‰¾å‡ºå¯¼è‡´é—®é¢˜çš„å¤§è‡´èŒƒå›´ï¼š<strong>ä¸»åº”ç”¨çš„Routerç‰ˆæœ¬ä¸å­åº”ç”¨çš„Routerç‰ˆæœ¬ä¸ä¸€è‡´</strong>ï¼Œå½“ç„¶ï¼Œä¸­é—´è¿˜å­˜åœ¨å‡ ä¸ªç–‘ç‚¹ï¼Œéœ€è¦ç»§ç»­æ‹¨å¼€è¿·é›¾ã€‚</p><ol><li>å®ç°åŸç†æœ‰ä»€ä¹ˆå·®å¼‚ä¼šå¯¼è‡´è¿™ä¸ªé—®é¢˜ã€‚</li><li>å…¶ä»–<code>Vue3</code>é¡¹ç›®ä¸ºå•¥æ²¡é‡åˆ°è¿™ä¸ªé—®é¢˜ã€‚</li></ol><p>å¸¦ç€ä»¥ä¸Šé—®é¢˜ï¼Œæˆ‘ä»¬å¼€å§‹è¿›å…¥æ¼«é•¿çš„æ–­ç‚¹debug ä¸ç¿»æºç è¿‡ç¨‹ã€‚</p><h2 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h2><blockquote><p>çœŸå®Ÿã¯ã„ã¤ã‚‚ã²ã¨ã¤</p></blockquote><h3 id="1-å®ç°åŸç†çš„å·®å¼‚"><a href="#1-å®ç°åŸç†çš„å·®å¼‚" class="headerlink" title="1. å®ç°åŸç†çš„å·®å¼‚"></a>1. å®ç°åŸç†çš„å·®å¼‚</h3><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ¥åˆ†æä¸€æ³¢æ–°æ—§ç‰ˆæœ¬çš„ <code>Router</code> åˆ°åº•æ›´æ”¹äº†ä»€ä¹ˆã€‚<br>æˆ‘ä»¬åœ¨æ–°ç‰ˆæœ¬<code>Router</code>æ–‡æ¡£ä¸­æ‰¾åˆ°è¿™ä¹ˆä¸€æ®µè¯´æ˜ã€‚<br><img src="/images/qiankun-router/history-state.png" alt="history.state"></p><p>ç¨åæˆ‘ä»¬ä¼šåœ¨æºç ä¸­æ‰¾åˆ°å¯¹åº”çš„æ“ä½œ<code>state</code>çš„å…·ä½“ä½ç½®<br>è€Œæ—§ç‰ˆæœ¬çš„<code>Router</code>ä½¿ç”¨çš„<code>pushState</code>ï¼Œåˆ™åªåœ¨<code>state</code>ä¸­å­˜å‚¨äº†keyè¿™å”¯ä¸€ä¸€ä¸ªå±æ€§ã€‚(<code>vue-router/src/util/push-state.js</code>)<br><img src="/images/qiankun-router/pushState.png" alt="history.state"></p><div class="tip">ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>history.state</code> åœ¨æ–°æ—§ç‰ˆæœ¬çš„<code>Router</code>ä¸­çš„æ•°æ®ç»“æ„æ˜¯ä¸ä¸€è‡´çš„ã€‚</div><p>æˆ‘çŒœè¿™åº”è¯¥æ˜¯å¯¼è‡´æ”¹é—®é¢˜çš„<strong>æ ¸å¿ƒå› ç´ </strong>äº†ã€‚æˆ‘ä»¬æ¥ç€å¾€ä¸‹éªŒè¯</p><h3 id="2-undefined-çš„ç”±æ¥"><a href="#2-undefined-çš„ç”±æ¥" class="headerlink" title="2. undefined çš„ç”±æ¥"></a>2. undefined çš„ç”±æ¥</h3><ol><li><p>ä¸»åº”ç”¨åœ¨ç‚¹å‡»å·¦ä¾§èœå•çš„æ—¶å€™ï¼Œä¼šè§¦å‘<code>pushState</code>,ä»è€Œæ¿€æ´»å­åº”ç”¨ï¼Œè¿›å…¥å­åº”ç”¨å¯¹åº”çš„èœå•ä¸­ã€‚<br><img src="/images/qiankun-router/main-pushState.png" alt="history.state"></p></li><li><p>å­åº”ç”¨åœ¨ç¬¬ä¸€æ¬¡è¿›å…¥çš„æ—¶å€™ï¼Œä¼šæ‰§è¡Œ<code>changeLocation</code>çš„<code>replace</code>æ“ä½œï¼Œæ­¤æ—¶é¡µé¢è¿›å…¥å­åº”ç”¨å†…ã€‚</p></li><li><p>å­åº”ç”¨å†…éƒ¨é¡µé¢è·³è½¬æ—¶ï¼Œæ‰€æœ‰çš„è·¯ç”±å‡ç”±å­åº”ç”¨<code>Router</code>è¿›è¡Œæ¥ç®¡ã€‚æ­¤æ—¶ä¸€åˆ‡æ­£å¸¸ã€‚</p></li><li><p>å†æ¬¡ç‚¹å‡»ä¸»åº”ç”¨å·¦ä¾§èœå•æ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹ä»£ç <strong>å°† history.state ç½®ä¸ºç©ºå¯¹è±¡ã€‚</strong>åŒæ—¶ï¼Œé¡µé¢è·³è½¬åˆ°å¯¹åº”è·¯ç”±é¡µé¢ã€‚</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">history.<span class="title function_">pushState</span>(&#123;&#125;, <span class="string">&#x27;&#x27;</span>, jumpUrl)</span><br></pre></td></tr></table></figure></li><li><p>ç»§ç»­åœ¨å­åº”ç”¨å†…éƒ¨è·³è½¬è·¯ç”±æ—¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå½“æ‰§è¡Œåˆ° <code>push(vue-router/history/html5.ts)</code> çš„æ—¶å€™ï¼Œç”±äºæ­¤æ—¶ <code>history.state</code> å·²ç»å˜æˆäº†ç©ºå¯¹è±¡ï¼Œæ‰€ä»¥å›¾ä¸­çš„ <code>currentState.current</code> å°±å˜æˆäº†<code>undefined</code>ã€‚</p><blockquote><p>åœ¨265è¡Œä¼šå…ˆè°ƒç”¨ä¸€æ¬¡<code>changeLocation</code>ç”¨æ¥è®°å½•å½“å‰è·¯ç”±ä¿¡æ¯(ä¸­é—´çŠ¶æ€)</p></blockquote></li></ol><p><img src="/images/qiankun-router/push.png" alt="history.state"></p><ol start="6"><li>è€Œè¿›å…¥åˆ° <code>changeLocation</code> æ–¹æ³•å†…éƒ¨ï¼Œæ­¤æ—¶çš„ <code>to</code> å·²ç»å˜æˆäº†<code>undefined</code>ï¼Œä¹Ÿå› æ­¤æ‹¼è£…çš„ <code>url</code> ä¸­ä¼šå‡ºç°<code>undefined</code>ã€‚<br><img src="/images/qiankun-router/changelocation.png" alt="history.state"></li><li>ç”±äºç¬¬å…­æ­¥ä¸­æ‰§è¡Œçš„æ˜¯ä¸­é—´æ€çš„è®°å½•å½“å‰è·¯ç”±è¡Œä¸ºï¼Œåç»­è¿˜ä¼šç»§ç»­è·³è½¬çœŸå®çš„ç›®çš„åœ°è·¯ç”±ï¼Œæ‰€ä»¥ä¸­é—´æ€çš„<code>undefined</code>è¢«ä¿å­˜åœ¨äº†æµè§ˆå™¨çš„è·¯ç”±æ ˆä¸­ã€‚å½“è§¦å‘å›é€€çš„æ—¶å€™ï¼Œå°±è·³åˆ°äº†<code>url</code>ä¸­å¸¦æœ‰<code>undefined</code>resoleçš„ç©ºç™½é¡µé¢ã€‚</li><li>ç°åœ¨ï¼Œæ¡ˆæƒ…çœŸç›¸å¤§ç™½äº†ã€‚</li></ol><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p><img src="/images/qiankun-router/resolve.png" alt="history.state"></p><p>ä¸€åŠ³æ°¸é€¸çš„æ–¹æ¡ˆåˆ™æ˜¯ï¼šä¸»åº”ç”¨ä¸å­åº”ç”¨å‡ä½¿ç”¨åŒä¸€ä¸ªç‰ˆæœ¬çš„ <code>VueRouter</code>,å½“ç„¶ï¼Œä¹Ÿè¦ä»å®é™…å‡ºå‘ï¼Œç»¼åˆè€ƒè™‘å„é¡¹æ”¹åŠ¨çš„<code>ROI</code>ï¼Œä»è€Œé‡‡ç”¨æ›´åˆç†çš„æ–¹æ¡ˆã€‚</p><h2 id="One-More-Thing"><a href="#One-More-Thing" class="headerlink" title="One More Thing!"></a>One More Thing!</h2><div class="tip">ä¸ºä»€ä¹ˆå…¶ä»–ä½¿ç”¨æ–°Routerçš„å­åº”ç”¨æ²¡æœ‰é‡åˆ°åŒæ ·çš„é—®é¢˜ï¼Ÿ</div>æˆ‘ç›²çŒœæ˜¯å› ä¸º å…¶ä»–å­åº”ç”¨è¦ä¹ˆåªæœ‰ä¸€ä¸ªä¸»åº”ç”¨çš„èœå•ï¼Œè¦ä¹ˆå­åº”ç”¨ä¹‹é—´çš„èœå•æ¯”è¾ƒç‹¬ç«‹ï¼Œæ‰€ä»¥æ²¡æœ‰é‡åˆ°ã€‚å®é™…ä¸Šï¼Œè¿™åº”è¯¥æ˜¯ä¸ªå¿…ç°çš„åœºæ™¯ã€‚]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;äº‹ä»¶èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#äº‹ä»¶èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;äº‹ä»¶èƒŒæ™¯&quot;&gt;&lt;/a&gt;äº‹ä»¶èƒŒæ™¯&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;å•†å®¶å·¥ä½œå°ç›®å‰å·²ç»ä½¿ç”¨&lt;a href=&quot;https://qiankun.umijs.org/&quot;&gt;q</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>é˜¿é‡Œä¸€é¢æ•´ç†</title>
    <link href="https://tauleos.github.io/58bedbf90157.html"/>
    <id>https://tauleos.github.io/58bedbf90157.html</id>
    <published>2021-01-28T03:15:23.000Z</published>
    <updated>2024-11-06T08:27:08.638Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç¬”è¯•"><a href="#ç¬”è¯•" class="headerlink" title="ç¬”è¯•"></a>ç¬”è¯•</h2><p>å‚è€ƒä¹‹å‰çš„æ–‡ç« -<a href="./4c84e4a4db9d.html">é˜¿é‡Œç¬”è¯•é¢˜æ”¶é›†</a></p><h2 id="é¢è¯•"><a href="#é¢è¯•" class="headerlink" title="é¢è¯•"></a>é¢è¯•</h2><h3 id="è‡ªæˆ‘ä»‹ç»"><a href="#è‡ªæˆ‘ä»‹ç»" class="headerlink" title="è‡ªæˆ‘ä»‹ç»"></a>è‡ªæˆ‘ä»‹ç»</h3><h3 id="è¯´ä¸€ä¸‹è‡ªå·±ç†Ÿæ‚‰çš„æŠ€æœ¯æ ˆ"><a href="#è¯´ä¸€ä¸‹è‡ªå·±ç†Ÿæ‚‰çš„æŠ€æœ¯æ ˆ" class="headerlink" title="è¯´ä¸€ä¸‹è‡ªå·±ç†Ÿæ‚‰çš„æŠ€æœ¯æ ˆ"></a>è¯´ä¸€ä¸‹è‡ªå·±ç†Ÿæ‚‰çš„æŠ€æœ¯æ ˆ</h3><p>å› ä¸ºæˆ‘ä¸»è¦åˆ—ä¸¾äº†node,ts,vueè¿™ä¸‰ä¸ªï¼Œæ‰€ä»¥ä¸‹è¾¹çš„é—®é¢˜å¤§å¤šå›´ç»•ç€è¿™å‡ ä¸ªæ¥å±•å¼€</p><h3 id="1ã€vueé‡Œæ‰¹é‡æ›´æ–°çš„æœºåˆ¶"><a href="#1ã€vueé‡Œæ‰¹é‡æ›´æ–°çš„æœºåˆ¶" class="headerlink" title="1ã€vueé‡Œæ‰¹é‡æ›´æ–°çš„æœºåˆ¶"></a>1ã€vueé‡Œæ‰¹é‡æ›´æ–°çš„æœºåˆ¶</h3><h3 id="2ã€ä»‹ç»ä¸‹æµè§ˆå™¨çš„EventLoopï¼ŒNodeç«¯çš„EventLoop"><a href="#2ã€ä»‹ç»ä¸‹æµè§ˆå™¨çš„EventLoopï¼ŒNodeç«¯çš„EventLoop" class="headerlink" title="2ã€ä»‹ç»ä¸‹æµè§ˆå™¨çš„EventLoopï¼ŒNodeç«¯çš„EventLoop"></a>2ã€ä»‹ç»ä¸‹æµè§ˆå™¨çš„EventLoopï¼ŒNodeç«¯çš„EventLoop</h3><h3 id="3ã€vuexæœ‰ä½¿ç”¨è¿‡å—ï¼Œä½¿ç”¨åœºæ™¯æ˜¯æ€æ ·çš„"><a href="#3ã€vuexæœ‰ä½¿ç”¨è¿‡å—ï¼Œä½¿ç”¨åœºæ™¯æ˜¯æ€æ ·çš„" class="headerlink" title="3ã€vuexæœ‰ä½¿ç”¨è¿‡å—ï¼Œä½¿ç”¨åœºæ™¯æ˜¯æ€æ ·çš„"></a>3ã€vuexæœ‰ä½¿ç”¨è¿‡å—ï¼Œä½¿ç”¨åœºæ™¯æ˜¯æ€æ ·çš„</h3><h3 id="4ã€vueä¸­çš„ç»„ä»¶é€šä¿¡æ–¹å¼"><a href="#4ã€vueä¸­çš„ç»„ä»¶é€šä¿¡æ–¹å¼" class="headerlink" title="4ã€vueä¸­çš„ç»„ä»¶é€šä¿¡æ–¹å¼"></a>4ã€vueä¸­çš„ç»„ä»¶é€šä¿¡æ–¹å¼</h3><h3 id="5ã€Nodeä¸­å¸¸ç”¨çš„æ¨¡å—æœ‰å“ªäº›ï¼Œæœ‰ç”¨è¿‡clusterå—ï¼Ÿä»‹ç»ä¸‹cluter"><a href="#5ã€Nodeä¸­å¸¸ç”¨çš„æ¨¡å—æœ‰å“ªäº›ï¼Œæœ‰ç”¨è¿‡clusterå—ï¼Ÿä»‹ç»ä¸‹cluter" class="headerlink" title="5ã€Nodeä¸­å¸¸ç”¨çš„æ¨¡å—æœ‰å“ªäº›ï¼Œæœ‰ç”¨è¿‡clusterå—ï¼Ÿä»‹ç»ä¸‹cluter"></a>5ã€Nodeä¸­å¸¸ç”¨çš„æ¨¡å—æœ‰å“ªäº›ï¼Œæœ‰ç”¨è¿‡clusterå—ï¼Ÿä»‹ç»ä¸‹cluter</h3><h3 id="6ã€clusterä¸­æ˜¯å¦‚ä½•åšåˆ°ç›‘å¬ä¸€ä¸ªç«¯å£ä¸æŠ¥é”™çš„"><a href="#6ã€clusterä¸­æ˜¯å¦‚ä½•åšåˆ°ç›‘å¬ä¸€ä¸ªç«¯å£ä¸æŠ¥é”™çš„" class="headerlink" title="6ã€clusterä¸­æ˜¯å¦‚ä½•åšåˆ°ç›‘å¬ä¸€ä¸ªç«¯å£ä¸æŠ¥é”™çš„"></a>6ã€clusterä¸­æ˜¯å¦‚ä½•åšåˆ°ç›‘å¬ä¸€ä¸ªç«¯å£ä¸æŠ¥é”™çš„</h3><h3 id="7ã€è¿›ç¨‹é—´é€šä¿¡ä½ è¿˜çŸ¥é“å“ªäº›æ–¹å¼"><a href="#7ã€è¿›ç¨‹é—´é€šä¿¡ä½ è¿˜çŸ¥é“å“ªäº›æ–¹å¼" class="headerlink" title="7ã€è¿›ç¨‹é—´é€šä¿¡ä½ è¿˜çŸ¥é“å“ªäº›æ–¹å¼"></a>7ã€è¿›ç¨‹é—´é€šä¿¡ä½ è¿˜çŸ¥é“å“ªäº›æ–¹å¼</h3><h3 id="8ã€è®¡ç®—æœºç½‘ç»œçš„çŸ¥è¯†äº†è§£çš„å¤šå—ï¼ŸOSIä¸ƒå±‚æ¨¡å‹é‡Œï¼Œhttpï¼Œtcpï¼Œipåˆ†åˆ«å¯¹åº”çš„æ˜¯å“ªä¸€å±‚"><a href="#8ã€è®¡ç®—æœºç½‘ç»œçš„çŸ¥è¯†äº†è§£çš„å¤šå—ï¼ŸOSIä¸ƒå±‚æ¨¡å‹é‡Œï¼Œhttpï¼Œtcpï¼Œipåˆ†åˆ«å¯¹åº”çš„æ˜¯å“ªä¸€å±‚" class="headerlink" title="8ã€è®¡ç®—æœºç½‘ç»œçš„çŸ¥è¯†äº†è§£çš„å¤šå—ï¼ŸOSIä¸ƒå±‚æ¨¡å‹é‡Œï¼Œhttpï¼Œtcpï¼Œipåˆ†åˆ«å¯¹åº”çš„æ˜¯å“ªä¸€å±‚"></a>8ã€è®¡ç®—æœºç½‘ç»œçš„çŸ¥è¯†äº†è§£çš„å¤šå—ï¼ŸOSIä¸ƒå±‚æ¨¡å‹é‡Œï¼Œhttpï¼Œtcpï¼Œipåˆ†åˆ«å¯¹åº”çš„æ˜¯å“ªä¸€å±‚</h3><h3 id="9ã€å¯ä»¥è¯´ä¸€ä¸‹httpsçš„åŸç†å—ï¼Ÿhttpsä¸ºä»€ä¹ˆæ˜¯å®‰å…¨çš„"><a href="#9ã€å¯ä»¥è¯´ä¸€ä¸‹httpsçš„åŸç†å—ï¼Ÿhttpsä¸ºä»€ä¹ˆæ˜¯å®‰å…¨çš„" class="headerlink" title="9ã€å¯ä»¥è¯´ä¸€ä¸‹httpsçš„åŸç†å—ï¼Ÿhttpsä¸ºä»€ä¹ˆæ˜¯å®‰å…¨çš„"></a>9ã€å¯ä»¥è¯´ä¸€ä¸‹httpsçš„åŸç†å—ï¼Ÿhttpsä¸ºä»€ä¹ˆæ˜¯å®‰å…¨çš„</h3><h3 id="10ã€httpsçš„è¯ä¹¦è¿˜æœ‰å…¶ä»–çš„ä»€ä¹ˆä½œç”¨ï¼Ÿ"><a href="#10ã€httpsçš„è¯ä¹¦è¿˜æœ‰å…¶ä»–çš„ä»€ä¹ˆä½œç”¨ï¼Ÿ" class="headerlink" title="10ã€httpsçš„è¯ä¹¦è¿˜æœ‰å…¶ä»–çš„ä»€ä¹ˆä½œç”¨ï¼Ÿ"></a>10ã€httpsçš„è¯ä¹¦è¿˜æœ‰å…¶ä»–çš„ä»€ä¹ˆä½œç”¨ï¼Ÿ</h3><h3 id="11ã€æœ‰å‘å¸ƒè¿‡npmåŒ…å—ï¼ŸnpmåŒ…çš„å¼€å‘ä¸Šçº¿æµç¨‹æ˜¯æ€æ ·çš„"><a href="#11ã€æœ‰å‘å¸ƒè¿‡npmåŒ…å—ï¼ŸnpmåŒ…çš„å¼€å‘ä¸Šçº¿æµç¨‹æ˜¯æ€æ ·çš„" class="headerlink" title="11ã€æœ‰å‘å¸ƒè¿‡npmåŒ…å—ï¼ŸnpmåŒ…çš„å¼€å‘ä¸Šçº¿æµç¨‹æ˜¯æ€æ ·çš„"></a>11ã€æœ‰å‘å¸ƒè¿‡npmåŒ…å—ï¼ŸnpmåŒ…çš„å¼€å‘ä¸Šçº¿æµç¨‹æ˜¯æ€æ ·çš„</h3><h3 id="12ã€èƒ½æè¿°ä¸€ä¸‹ä½ ä¹‹å‰åšè¿‡çš„æŠ€æœ¯äº®ç‚¹æˆ–è€…ä¸šåŠ¡äº®ç‚¹å—ï¼Ÿ"><a href="#12ã€èƒ½æè¿°ä¸€ä¸‹ä½ ä¹‹å‰åšè¿‡çš„æŠ€æœ¯äº®ç‚¹æˆ–è€…ä¸šåŠ¡äº®ç‚¹å—ï¼Ÿ" class="headerlink" title="12ã€èƒ½æè¿°ä¸€ä¸‹ä½ ä¹‹å‰åšè¿‡çš„æŠ€æœ¯äº®ç‚¹æˆ–è€…ä¸šåŠ¡äº®ç‚¹å—ï¼Ÿ"></a>12ã€èƒ½æè¿°ä¸€ä¸‹ä½ ä¹‹å‰åšè¿‡çš„æŠ€æœ¯äº®ç‚¹æˆ–è€…ä¸šåŠ¡äº®ç‚¹å—ï¼Ÿ</h3>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ç¬”è¯•&quot;&gt;&lt;a href=&quot;#ç¬”è¯•&quot; class=&quot;headerlink&quot; title=&quot;ç¬”è¯•&quot;&gt;&lt;/a&gt;ç¬”è¯•&lt;/h2&gt;&lt;p&gt;å‚è€ƒä¹‹å‰çš„æ–‡ç« -&lt;a href=&quot;./4c84e4a4db9d.html&quot;&gt;é˜¿é‡Œç¬”è¯•é¢˜æ”¶é›†&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;é¢è¯•&quot;&gt;&lt;a h</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>é˜¿é‡Œç¬”è¯•é¢˜æ”¶é›†-1</title>
    <link href="https://tauleos.github.io/4c84e4a4db9d.html"/>
    <id>https://tauleos.github.io/4c84e4a4db9d.html</id>
    <published>2020-11-05T06:56:40.000Z</published>
    <updated>2024-11-06T08:27:08.638Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€å¦ç±»æ’åº"><a href="#ä¸€ã€å¦ç±»æ’åº" class="headerlink" title="ä¸€ã€å¦ç±»æ’åº"></a>ä¸€ã€å¦ç±»æ’åº</h2><p>é¢˜ç›®ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1. æ’åºåè¾“å‡º id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Array&lt;Object&gt;</span>&#125; <span class="variable">list</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">Array&lt;number&gt;</span>&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@example</span></span></span><br><span class="line"><span class="comment"> * [</span></span><br><span class="line"><span class="comment"> *  &#123; id: 2, before: 1 &#125;,</span></span><br><span class="line"><span class="comment"> *  &#123; id: 1, last: true &#125;,</span></span><br><span class="line"><span class="comment"> *  &#123; id: 3, after: 1 &#125;,</span></span><br><span class="line"><span class="comment"> *  &#123; id: 5, first: true &#125;,</span></span><br><span class="line"><span class="comment"> *  &#123; id: 6, last: true &#125;,</span></span><br><span class="line"><span class="comment"> *  &#123; id: 7, last: true &#125;,</span></span><br><span class="line"><span class="comment"> *  &#123; id: 8, last: true &#125;,</span></span><br><span class="line"><span class="comment"> * ];</span></span><br><span class="line"><span class="comment"> * è¾“å‡ºä¸º</span></span><br><span class="line"><span class="comment"> * [5, 2, 1, 3, 6, 7, 8];</span></span><br><span class="line"><span class="comment"> * [</span></span><br><span class="line"><span class="comment"> * &#123; id: 2, before: 3 &#125;,</span></span><br><span class="line"><span class="comment"> *&#123; id: 1, before: 2 &#125;,</span></span><br><span class="line"><span class="comment"> *&#123; id: 3, before: 5 &#125;,</span></span><br><span class="line"><span class="comment"> *  &#123; id: 5, before: 6 &#125;,</span></span><br><span class="line"><span class="comment"> *&#123; id: 6, last: true &#125;,</span></span><br><span class="line"><span class="comment"> * &#123; id: 7, last: true &#125;,</span></span><br><span class="line"><span class="comment"> * &#123; id: 8, last: true &#125;,</span></span><br><span class="line"><span class="comment"> * ];</span></span><br><span class="line"><span class="comment"> * è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment"> * [1,2,3,5,6,7,8]</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><p>è§£æ³•1ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">function</span> <span class="title function_">sort</span>(<span class="params">source, target = []</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (source.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> target</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> current = source.<span class="title function_">shift</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; id, before, after, first, last  &#125; = current</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (first) &#123;</span><br><span class="line">      target.<span class="title function_">unshift</span>(id)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (last) &#123;</span><br><span class="line">      target.<span class="title function_">push</span>(id)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å‰åå…³ç³»å¤„ç†ï¼Œæ‰¾åˆ°å¯¹åº”çš„indexï¼Œå¦‚æœå¯¹åº”çš„ç›®æ ‡æœªå…¥ç›åˆ™æ”¾åˆ°æœ€åè¿›è¡Œå¤„ç†</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&#x27;before&#x27;</span> <span class="keyword">in</span> current || <span class="string">&#x27;after&#x27;</span> <span class="keyword">in</span> current) &#123;</span><br><span class="line">      <span class="keyword">const</span> targetId = before || after</span><br><span class="line">      <span class="keyword">const</span> index = target.<span class="title function_">findIndex</span>(<span class="function"><span class="params">value</span> =&gt;</span> value === targetId)</span><br><span class="line">      <span class="keyword">if</span> (index === -<span class="number">1</span>) &#123;</span><br><span class="line">          </span><br><span class="line">          <span class="comment">/**</span></span><br><span class="line"><span class="comment">           * source å’Œ targetéƒ½ä¸å­˜åœ¨ç›®æ ‡idçš„æƒ…å†µä¸‹ï¼Œç›´æ¥æ’å…¥</span></span><br><span class="line"><span class="comment">           */</span></span><br><span class="line">          <span class="keyword">if</span> (source.<span class="title function_">find</span>(<span class="function"><span class="params">value</span> =&gt;</span> value === targetId)) &#123;</span><br><span class="line">              source.<span class="title function_">push</span>(current)</span><br><span class="line">              <span class="keyword">return</span> <span class="title function_">sort</span>(source, target)</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              target.<span class="title function_">push</span>(id)</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          target.<span class="title function_">splice</span>(<span class="string">&#x27;before&#x27;</span> <span class="keyword">in</span> current ? index : index + <span class="number">1</span>, <span class="number">0</span>, id)</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">sort</span>(source, target)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§£æ³•2ï¼š</p><figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">function parse(list) &#123;</span><br><span class="line">  <span class="built_in">let</span> result = [];</span><br><span class="line">  <span class="built_in">let</span> filtered = [];</span><br><span class="line">  <span class="keyword">for</span>(<span class="built_in">let</span> i of list)&#123;</span><br><span class="line">    <span class="keyword">if</span>(i.<span class="built_in">first</span>)&#123;</span><br><span class="line">      result.unshift(i.id);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(i.<span class="built_in">last</span>)&#123;</span><br><span class="line">      result.<span class="built_in">push</span>(i.id);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      filtered.<span class="built_in">push</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span>(filtered.<span class="built_in">length</span>)&#123;</span><br><span class="line">    <span class="built_in">let</span> cur = filtered.shift();</span><br><span class="line">    <span class="built_in">let</span> <span class="built_in">key</span> = cur.before ? cur.before : cur.after;</span><br><span class="line">    <span class="built_in">let</span> index = result.findIndex(i=&gt;i===<span class="built_in">key</span>);</span><br><span class="line">    <span class="keyword">if</span>(index !== -<span class="number">1</span>)&#123;</span><br><span class="line">      result.<span class="built_in">splice</span>(cur.before ? index: index+<span class="number">1</span>,<span class="number">0</span>,cur.id);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      filtered.<span class="built_in">push</span>(cur);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="äºŒã€äºŒç»´æ•°ç»„è½¬æ ‘çŠ¶ç»“æ„"><a href="#äºŒã€äºŒç»´æ•°ç»„è½¬æ ‘çŠ¶ç»“æ„" class="headerlink" title="äºŒã€äºŒç»´æ•°ç»„è½¬æ ‘çŠ¶ç»“æ„"></a>äºŒã€äºŒç»´æ•°ç»„è½¬æ ‘çŠ¶ç»“æ„</h2><p>é¢˜ç›®ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 2. å°†æ•°ç»„è½¬æ¢æˆæ ‘çŠ¶ç»“æ„</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Array</span>&#125; <span class="variable">arr</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">Object</span>&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@example</span></span></span><br><span class="line"><span class="comment"> * [</span></span><br><span class="line"><span class="comment"> *   &#123; id: 1, name: &#x27;i1&#x27; &#125;,</span></span><br><span class="line"><span class="comment"> *   &#123; id: 2, name: &#x27;i2&#x27;, parentId: 1 &#125;,</span></span><br><span class="line"><span class="comment"> *   &#123; id: 4, name: &#x27;i4&#x27;, parentId: 3 &#125;,</span></span><br><span class="line"><span class="comment"> *   &#123; id: 3, name: &#x27;i3&#x27;, parentId: 2 &#125;,</span></span><br><span class="line"><span class="comment"> *   &#123; id: 8, name: &#x27;i8&#x27;, parentId: 7 &#125;,</span></span><br><span class="line"><span class="comment"> * ]</span></span><br><span class="line"><span class="comment"> * è½¬æ¢å</span></span><br><span class="line"><span class="comment"> * &#123;</span></span><br><span class="line"><span class="comment"> *   id: 1,</span></span><br><span class="line"><span class="comment"> *   name: &#x27;i1&#x27;,</span></span><br><span class="line"><span class="comment"> *   children: [</span></span><br><span class="line"><span class="comment"> *     &#123; id: 2, name: &#x27;i2&#x27;, parentId: 1, children: [...] &#125;,</span></span><br><span class="line"><span class="comment"> *   ]</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><p>è§£ç­”ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">convert2Tree</span>(<span class="params">arr</span>) &#123;</span><br><span class="line"><span class="keyword">let</span> parentMap = &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> root;</span><br><span class="line">arr.<span class="title function_">sort</span>(<span class="function">(<span class="params">a,b</span>)=&gt;</span>a.<span class="property">id</span>-b.<span class="property">id</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> node <span class="keyword">of</span> arr)&#123;</span><br><span class="line">node.<span class="property">children</span> = [];</span><br><span class="line"><span class="keyword">if</span>(!node.<span class="property">parentId</span>)&#123;</span><br><span class="line"></span><br><span class="line">root = node;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">let</span> parent = parentMap[node.<span class="property">parentId</span>];</span><br><span class="line"><span class="keyword">if</span>(parent)&#123;</span><br><span class="line">parent.<span class="property">children</span>.<span class="title function_">push</span>(node);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">parentMap[node.<span class="property">id</span>] = node;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¸‰ã€ç”¨setTimeoutå®ç°setInterval"><a href="#ä¸‰ã€ç”¨setTimeoutå®ç°setInterval" class="headerlink" title="ä¸‰ã€ç”¨setTimeoutå®ç°setInterval"></a>ä¸‰ã€ç”¨setTimeoutå®ç°setInterval</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 3. å®ç° setInterval</span></span><br><span class="line"><span class="comment"> * åˆ©ç”¨ setTimeout å®ç° setInterval</span></span><br><span class="line"><span class="comment"> * åˆ©ç”¨ clearTimeout å®ç° clearInterval</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Function</span>&#125; <span class="variable">callback</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; <span class="variable">duration</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">number</span>&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@example</span></span></span><br><span class="line"><span class="comment"> * mySetInterval(()=&gt; &#123;</span></span><br><span class="line"><span class="comment"> *   console.log(&#x27;xxx&#x27;);</span></span><br><span class="line"><span class="comment"> * &#125;, 200);</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> timerMap = &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> id = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">mySetInterval</span>(<span class="params">callback, duration</span>) &#123;</span><br><span class="line"><span class="keyword">let</span> timerId = id;</span><br><span class="line">id++;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>)&#123;</span><br><span class="line"><span class="title function_">callback</span>();</span><br><span class="line">timerMap[timerId] = <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line"><span class="title function_">fn</span>();</span><br><span class="line">&#125;, duration)</span><br><span class="line">&#125;</span><br><span class="line">timerMap[timerId] = <span class="built_in">setTimeout</span>(fn, duration);</span><br><span class="line"><span class="keyword">return</span> timerMap[timerId];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; <span class="variable">timer</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">void</span>&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@example</span></span></span><br><span class="line"><span class="comment"> * const timer = mySetInterval(()=&gt; &#123;</span></span><br><span class="line"><span class="comment"> *   console.log(&#x27;xxx&#x27;);</span></span><br><span class="line"><span class="comment"> * &#125;, 200);</span></span><br><span class="line"><span class="comment"> * setTimeout(() =&gt; &#123;</span></span><br><span class="line"><span class="comment"> *   myClearInterval(timer);</span></span><br><span class="line"><span class="comment"> * &#125;, 1000);</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">myClearInterval</span>(<span class="params">timer</span>) &#123;</span><br><span class="line"><span class="built_in">clearTimeout</span>(timerMap[timer]);</span><br><span class="line"><span class="comment">// clearTimeout(timer);</span></span><br><span class="line"><span class="keyword">delete</span> timerMap[timer];</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://juejin.im/post/6844903839934447629">ç”¨setTimeoutå’ŒclearTimeoutç®€å•å®ç°setIntervalä¸clearInterval</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ä¸€ã€å¦ç±»æ’åº&quot;&gt;&lt;a href=&quot;#ä¸€ã€å¦ç±»æ’åº&quot; class=&quot;headerlink&quot; title=&quot;ä¸€ã€å¦ç±»æ’åº&quot;&gt;&lt;/a&gt;ä¸€ã€å¦ç±»æ’åº&lt;/h2&gt;&lt;p&gt;é¢˜ç›®ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td cl</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>jsæºç å®ç°-reduce-isArray</title>
    <link href="https://tauleos.github.io/6aef7f739395.html"/>
    <id>https://tauleos.github.io/6aef7f739395.html</id>
    <published>2020-10-27T03:46:38.000Z</published>
    <updated>2024-11-06T08:27:08.635Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Reduce"><a href="#Reduce" class="headerlink" title="Reduce"></a>Reduce</h2><blockquote><p><code>reduce()</code> æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºç´¯åŠ å™¨ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå€¼ï¼ˆä»å·¦åˆ°å³ï¼‰å¼€å§‹ç¼©å‡ï¼Œæœ€ç»ˆä¸ºä¸€ä¸ªå€¼ï¼Œæ˜¯<em>ES5</em>ä¸­æ–°å¢çš„åˆä¸€ä¸ªæ•°ç»„é€é¡¹å¤„ç†æ–¹æ³•</p></blockquote><h3 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><div class='tip'>arr.reduce(callback[, initialValue]) </div><h3 id="å‚æ•°å›¾è§£"><a href="#å‚æ•°å›¾è§£" class="headerlink" title="å‚æ•°å›¾è§£"></a>å‚æ•°å›¾è§£</h3><p><img src="images/reduce/reduce.jpg" alt="reduce"></p><h3 id="åŸç†å®ç°"><a href="#åŸç†å®ç°" class="headerlink" title="åŸç†å®ç°"></a>åŸç†å®ç°</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">myReduce</span> = <span class="keyword">function</span>(<span class="params">callbackFn,initialValue</span>)&#123;</span><br><span class="line">  <span class="keyword">let</span> self = <span class="variable language_">this</span>;</span><br><span class="line">  <span class="keyword">let</span> len = self.<span class="property">length</span>;</span><br><span class="line">  <span class="keyword">let</span> index = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">let</span> accumulator = <span class="literal">undefined</span>;</span><br><span class="line">  <span class="comment">// å‚æ•°ä¸æ˜¯å‡½æ•°æŠ¥é”™</span></span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">typeof</span> callbackFn !== <span class="string">&#x27;function&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(callbackFn +<span class="string">&#x27;is not a function&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// æ•°ç»„ä¸ºç©ºï¼Œå¹¶ä¸”æœ‰åˆå§‹å€¼ï¼ŒæŠ¥é”™</span></span><br><span class="line">  <span class="keyword">if</span>(<span class="variable language_">arguments</span>.<span class="property">length</span>&lt;<span class="number">2</span> &amp;&amp; len === <span class="number">0</span> )&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&#x27;Reduce of empty array with no initial value&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  initialValue = initialValue || <span class="literal">undefined</span>;</span><br><span class="line">  <span class="comment">// è®¾ç½®ç´¯åŠ å™¨ä¸ºåˆå§‹å€¼ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®ä¸ºæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">  <span class="keyword">if</span>(<span class="variable language_">arguments</span>.<span class="property">length</span> &gt; <span class="number">1</span>)&#123;</span><br><span class="line">    accumulator = initialValue;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    accumulator = self[<span class="number">0</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(index&lt;len)&#123;</span><br><span class="line">    <span class="keyword">if</span>(self.<span class="title function_">hasOwnProperty</span>(index))&#123;</span><br><span class="line">      <span class="keyword">let</span> val = self[index];</span><br><span class="line">      accumulator = callbackFn.<span class="title function_">apply</span>(<span class="literal">null</span>,[accumulator,val,index,self]);</span><br><span class="line">    &#125;</span><br><span class="line">    index++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> accumulator;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> rReduce = [<span class="string">&#x27;1&#x27;</span>, <span class="literal">null</span>, <span class="literal">undefined</span>, , <span class="number">3</span>, <span class="number">4</span>].<span class="title function_">reduce</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a + b, <span class="number">3</span>);</span><br><span class="line"><span class="keyword">const</span> mReduce = [<span class="string">&#x27;1&#x27;</span>, <span class="literal">null</span>, <span class="literal">undefined</span>, , <span class="number">3</span>, <span class="number">4</span>].<span class="title function_">myReduce</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a + b, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(rReduce, mReduce);</span><br><span class="line"><span class="comment">// 31nullundefined34 31nullundefined34</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="isArray"><a href="#isArray" class="headerlink" title="isArray"></a>isArray</h2><blockquote><p><code>Array.isArray()</code> ç”¨äºç¡®å®šä¼ é€’çš„å€¼æ˜¯å¦æ˜¯ä¸€ä¸ª <code>Array</code>ã€‚</p></blockquote><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Array</span>.<span class="property">myIsArray</span> = <span class="keyword">function</span>(<span class="params">target</span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(target) === <span class="string">&#x27;[object Array]&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Array</span>.<span class="title function_">myIsArray</span>([])) <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Array</span>.<span class="title function_">myIsArray</span>(&#123;&#125;)) <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>å®Œ~</p><p>å‚è€ƒ</p><ul><li><a href="https://mp.weixin.qq.com/s/Qqh1H-2MUyVGoWjgOstQrg">å¹²è´§ï¼é˜¿é‡ŒP6æ‰‹å†™æºç é¢è¯•é¢˜é›†é”¦</a></li><li><a href="https://aotu.io/notes/2016/04/14/js-reduce/index.html">JavaScriptä¸­reduce()æ–¹æ³•ä¸å®Œå…¨æŒ‡å—</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Reduce&quot;&gt;&lt;a href=&quot;#Reduce&quot; class=&quot;headerlink&quot; title=&quot;Reduce&quot;&gt;&lt;/a&gt;Reduce&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;reduce()&lt;/code&gt; æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºç´¯åŠ å™¨ï¼Œæ•°ç»„ä¸­çš„æ¯</summary>
      
    
    
    
    
    <category term="js" scheme="https://tauleos.github.io/tags/js/"/>
    
    <category term="æºç " scheme="https://tauleos.github.io/tags/%E6%BA%90%E7%A0%81/"/>
    
  </entry>
  
  <entry>
    <title>è‡ªåŠ¨åŒ–ç‰ˆæœ¬ç®¡ç†æ¢ç´¢</title>
    <link href="https://tauleos.github.io/b7436f608b7a.html"/>
    <id>https://tauleos.github.io/b7436f608b7a.html</id>
    <published>2020-10-15T06:38:46.000Z</published>
    <updated>2024-11-06T08:27:08.638Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨æˆ‘ä»¬æ—¥å¸¸Codingè¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šæœ‰å¼€å‘ç±»åº“çš„éœ€æ±‚</p><span id="more"></span><p>å¼€å‘å®Œæˆå‘å¸ƒä¹‹åï¼Œåç»­ç‰ˆæœ¬ç®¡ç†ï¼Œæ›´æ–°æ—¥å¿—ç­‰é—®é¢˜ä¹Ÿéšä¹‹è€Œæ¥ï¼Œå¦‚ä½•è§£å†³è¿™äº›é—®é¢˜å‘¢ï¼Ÿ</p><h1 id="ä¸€ã€æ‰‹æ‰“"><a href="#ä¸€ã€æ‰‹æ‰“" class="headerlink" title="ä¸€ã€æ‰‹æ‰“"></a>ä¸€ã€æ‰‹æ‰“</h1><ul><li>æ‰‹åŠ¨æ›´æ”¹ç‰ˆæœ¬å·</li><li>æ‰‹åŠ¨å˜æˆæ›´æ–°æ—¥å¿—</li><li>æ‰‹åŠ¨å‘å¸ƒåˆ°npmç§æœ</li><li>å™¢è€¶ï¼Œå®Œå·¥</li></ul><div class="tip">ä½ ç¡®å®šä½ æ˜¯è®¤çœŸçš„ä¹ˆâ“ï¸â“ï¸â“ï¸æ‰‹åŠ¨é»‘äººé—®å·è„¸éƒ½2020å¹´äº†è¿˜ä¸èƒ½è‡ªåŠ¨åŒ–å—ï¼Ÿ</div><h1 id="äºŒã€è‡ªåŠ¨åŒ–"><a href="#äºŒã€è‡ªåŠ¨åŒ–" class="headerlink" title="äºŒã€è‡ªåŠ¨åŒ–"></a>äºŒã€è‡ªåŠ¨åŒ–</h1><p>å›åˆ°æ­£é¢˜ï¼Œå¦‚æœæœ‰ä¸€ç§å·¥å…·ï¼Œæˆ‘ä»¬åªéœ€è¦ç®€å•è¾“å…¥å‘½ä»¤è¡Œï¼Œè½»è½»æ•²ä¸€ä¸‹å›è½¦ï¼Œå°±å¯ä»¥è½»æ¾å¸®æˆ‘ä»¬å®Œæˆæ‰‹åŠ¨çš„é‚£äº›å·¥ä½œï¼Œã€‚æˆ‘ä»¬åªéœ€è¦å™¢è€¶ï¼Œå²‚ä¸å¿«å“‰ã€‚</p><p>äºæ˜¯ï¼Œåœ¨ä¼Ÿå¤§çš„githubä¸Šæ•æ‰åˆ°äº†ä»¥ä¸‹ä¸‰ç§å·¥å…·</p><ul><li>standard-version</li><li>semantic-release</li><li>lerna</li></ul><hr><blockquote><p>è®©æˆ‘ä»¬æ¥è¯¦ç»†çš„åˆ†åˆ«äº†è§£ä¸€ä¸‹è¿™ä¸‰ä½é€‰æ‰‹</p></blockquote><h2 id="1ã€Lerna"><a href="#1ã€Lerna" class="headerlink" title="1ã€Lerna"></a>1ã€Lerna</h2><p>ä¸ç”¨è¯´ã€‚å…ˆæ·˜æ±°å§ğŸ˜‚ï¸ã€‚æ¯•ç«Ÿè¿™å®¶ä¼™æ ¸å¿ƒä»·å€¼æ˜¯å¤šé¡¹ç›®ç®¡ç†ï¼Œè·Ÿæˆ‘ä»¬çš„éœ€æ±‚æ¯«ä¸æ²¾è¾¹</p><h2 id="2ã€standard-version"><a href="#2ã€standard-version" class="headerlink" title="2ã€standard-version"></a>2ã€standard-version</h2><p>æ ¹æ®ä»‹ç»ï¼Œå®ƒçš„æ ¸å¿ƒä»·å€¼è§‚åœ¨äºè¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶ã€æ‰“tagä»¥åŠCHANGELOGç”Ÿæˆã€‚æ›´ä¸ºåŠ åˆ†çš„æ˜¯å®ƒè¿˜æ˜¯ä»£ç æäº¤è§„èŒƒç»„ç»‡çš„å®˜æ–¹å‡ºå“<br><img src="/images/version-management/standard-version.png" alt="sv"></p><blockquote><p>A utility for versioning using semver and CHANGELOG generation powered by Conventional Commits. </p></blockquote><p>å¬ä¸Šå»è›®ç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ï¼Œä½¿ç”¨æ–¹æ³•ä¹Ÿç®€å•</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">standard-version</span><br></pre></td></tr></table></figure><p>åŸºæœ¬ä¸Šå¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„æ—¥å¸¸éœ€æ±‚ã€‚ä½¿ç”¨èµ·æ¥ä¹Ÿæ»¡è¶³æˆ‘ä»¬çš„åˆå§‹ç›®æ ‡ï¼Œä¸€é”®Enterï¼Œæå®šæ‰€æœ‰ï¼Œæˆ‘ä»¬åªéœ€è¦å°†æ›´æ”¹æ¨é€åˆ°æœåŠ¡å™¨ï¼Œå¹¶ä¸”å‘å¸ƒå°±å¥½</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git push --follow-tags origin master &amp;&amp; npm publish</span><br></pre></td></tr></table></figure><h2 id="3ã€semantic-release"><a href="#3ã€semantic-release" class="headerlink" title="3ã€semantic-release"></a>3ã€semantic-release</h2><p>æ‰“å¼€æ–‡æ¡£ä»‹ç»ï¼ŒåŸæ¥è¿™è´§çš„æ ¸å¿ƒé©±åŠ¨åŠ›åœ¨äºworkflowã€‚</p><blockquote><p>semantic-release automates the whole package release workflow including: determining the next version number, generating the release notes and publishing the package.</p></blockquote><p>ç›¸æ¯”æ¥¼ä¸Šé‚£ä½ï¼Œè¯¥é€‰æ‰‹ç»™æˆ‘ä»¬æä¾›äº†ä¸€æ•´å¥—å®Œå¤‡çš„å·¥ä½œæµï¼Œé€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥:</p><ul><li>å…¨è‡ªåŠ¨release</li><li>å¼ºåˆ¶è¯­ä¹‰åŒ–è¯´æ˜</li><li>æ’ä»¶åŒ–é…ç½®</li><li>ä¸CI/CDé»˜è®¤é›†æˆ<br>å‰©ä¸‹çš„è¿˜æœ‰å¥½å¤šã€‚ã€‚ã€‚å¤§å®¶å¯ä»¥å»å®˜ç½‘çœ‹ã€‚ã€‚ã€‚</li></ul><p>ä½¿ç”¨æ–¹æ³•<br>Aã€ä½¿ç”¨çš„è¯ä¼šç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œç±»ä¼¼babelï¼Œéœ€è¦åœ¨é¡¹ç›®ä¸­å¢åŠ ä¸€ä¸ª <strong>.releaserc</strong> æ–‡ä»¶è¿›è¡Œæ’ä»¶é…ç½®</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;branches&quot;</span>: <span class="string">&quot;master&quot;</span>,</span><br><span class="line">  <span class="comment">// &quot;debug&quot;: true,</span></span><br><span class="line">  <span class="comment">// &quot;dryRun&quot;: true, // semantic-releaseé»˜è®¤åœ¨ciä¸­å·¥ä½œï¼Œå¦‚æœéœ€è¦è°ƒè¯•å¯ä»¥æ‰“å¼€è¿™ä¸ªå¼€å…³</span></span><br><span class="line">  <span class="string">&quot;plugins&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;@semantic-release/commit-analyzer&quot;</span>,</span><br><span class="line">    <span class="string">&quot;@semantic-release/release-notes-generator&quot;</span>,</span><br><span class="line">    <span class="string">&quot;@semantic-release/changelog&quot;</span>,</span><br><span class="line">    [</span><br><span class="line">      <span class="string">&quot;@semantic-release/npm&quot;</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">&quot;npmPublish&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">&quot;tarballDir&quot;</span>: <span class="string">&quot;dist&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">      <span class="string">&quot;@semantic-release/git&quot;</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">&quot;assets&quot;</span>: [<span class="string">&quot;package.json&quot;</span>, <span class="string">&quot;CHANGELOG.md&quot;</span>],</span><br><span class="line">        <span class="string">&quot;message&quot;</span>: <span class="string">&quot;chore(è›‹ç³•):$&#123;nextRelease.version&#125; [skip ci]\n\n$&#123;nextRelease.notes&#125;&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">      <span class="string">&quot;@semantic-release/gitlab&quot;</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">&quot;gitlabUrl&quot;</span>: <span class="string">&quot;https://git.com/&quot;</span>,</span><br><span class="line">        <span class="string">&quot;assets&quot;</span>: <span class="string">&quot;dist/*.tgz&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;preset&quot;</span>: <span class="string">&quot;angular&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Bã€åŒæ—¶éœ€è¦åœ¨ciä¸­å¢åŠ é…ç½®ï¼Œåœ¨é¡¹ç›®ä¸­é…ç½®CIæ‰€éœ€è¦çš„ç¯å¢ƒå˜é‡,åŒ…æ‹¬<code>GL_TOKEN</code>ã€<code>NPM_USERNAME</code>ã€<code>NPM_EMAIL</code>ã€<code>NPM_PASSWORD</code>ç­‰</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">stages:</span></span><br><span class="line">  <span class="comment"># - test</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">release</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">before_script:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">npm</span> <span class="string">install</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">publish:</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">node:10</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">release</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">&#x27;//registry.npm.org/:username=$&#123;NPM_USERNAME&#125;&#x27;</span><span class="string">&gt;&gt;.npmrc</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">&#x27;//registry.npm.org/:email=$&#123;NPM_EMAIL&#125;&#x27;</span><span class="string">&gt;&gt;.npmrc</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">&#x27;//registry.npm.org/:_password=$&#123;NPM_PASSWORD&#125;&#x27;</span><span class="string">&gt;&gt;.npmrc</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">npx</span> <span class="string">semantic-release</span></span><br></pre></td></tr></table></figure><p>Cã€æœ€é‡è¦çš„ä¸€ç‚¹ï¼Œéœ€è¦åœ¨gitlabä¸­å¼€å¯<code>PersonalAccessToken</code>ï¼ˆ<del>å‰ææ˜¯å¼€å¯2FAé…ç½®ï¼Œç…§ç€æ­¥éª¤èµ°ï¼ŒæŒºéº»çƒ¦çš„ä¹Ÿèƒ½èµ°é€š</del>åæ¥å‘ç°ä¸ç”¨å¼€å¯2FAä¹Ÿèƒ½èµ°é€šï¼Œé‚£å¯å¤ªæ£’äº†ï¼‰ï¼Œå¹¶è®¾ç½®åœ¨CI/CDçš„å˜é‡ä¸­<br><img src="/images/version-management/pas.png" alt="pat"></p><p>Dã€ä¸Šè¿°æ­¥éª¤åšå¥½ï¼Œä¾¿å¯ä»¥æŠŠæ‰€æœ‰æ”¹åŠ¨æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼Œåç­‰å®ƒå¸¦ç»™ä½ çš„æƒŠå–œ</p><div class="tip">å“ˆå“ˆï¼Œå…¶å®é™¤äº†è·Ÿæ¥¼ä¸Šä¸€æ ·çš„æ•ˆæœä¹‹å¤–ï¼Œè¿˜é¢å¤–ç”Ÿæˆäº†gitLabä¸­çš„Releaseã€‚å½“ç„¶å¦‚æœä¸éœ€è¦çš„è¯ä¹Ÿå¯ä»¥å¹²æ‰å®ƒï¼Œä¸è¿‡è¿™ä¹ˆä¸“ä¸šçš„æ“ä½œï¼Œä¸ºå•¥ä¸ä¿ç•™å‘¢ï¼Œå¯¹ä¸å¯¹~ğŸ˜„ï¸</div><h2 id="4ã€standard-version-VS-semantiv-release"><a href="#4ã€standard-version-VS-semantiv-release" class="headerlink" title="4ã€standard-version VS semantiv-release"></a>4ã€standard-version VS semantiv-release</h2><table><thead><tr><th align="center">åŠŸèƒ½ç‚¹</th><th align="center">standard-version</th><th align="center">semantic-release</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center">ç‰ˆæœ¬æ§åˆ¶</td><td align="center">âœ…</td><td align="center">âœ…</td><td align="center">ä¼šæ ¹æ®æäº¤çš„ä¿¡æ¯ç±»å‹æ¥è‡ªåŠ¨æ›´æ”¹å¯¹åº”çš„ç‰ˆæœ¬å·,å¦‚ä¸‹:<br> feat: æ¬¡ç‰ˆæœ¬(minor)+1 <br>  fix: ä¿®è®¢å·(patch) +1 <br> BREAK CHANGE: ä¸»æ¿å·(marjor) +1</td></tr><tr><td align="center">CHANGELOG</td><td align="center">âœ…</td><td align="center">âœ…</td><td align="center">å‡åŸºäºAngular Commit è§„åˆ™</td></tr><tr><td align="center">gitTagæ ‡è®°</td><td align="center">âœ…</td><td align="center">âœ…</td><td align="center"></td></tr><tr><td align="center">npmè‡ªåŠ¨å‘å¸ƒ</td><td align="center"></td><td align="center">âœ…</td><td align="center"></td></tr><tr><td align="center">CIé›†æˆ</td><td align="center">âš ï¸ï¸</td><td align="center">âœ…</td><td align="center">standard-version å¯ä»¥æ‰‹åŠ¨å®ç°</td></tr><tr><td align="center">pre-releaseå®ç°</td><td align="center">âœ…</td><td align="center">âœ…</td><td align="center">standard-versionï¼šé€šè¿‡å¯é€‰å‚æ•°<br>semantic-release:é€šè¿‡åˆ†æ”¯è®¾ç½®</td></tr><tr><td align="center">gitlab release</td><td align="center"></td><td align="center">âœ…</td><td align="center"></td></tr></tbody></table><h1 id="ä¸‰ã€ç»“è®º"><a href="#ä¸‰ã€ç»“è®º" class="headerlink" title="ä¸‰ã€ç»“è®º"></a>ä¸‰ã€ç»“è®º</h1><p>standard-versionä¸semantic-release éƒ½æ˜¯ä»¤äººæƒŠå¹çš„å·¥å…·ï¼Œä¸ç®¡ä½¿ç”¨å“ªä¸€ä¸ªéƒ½èƒ½å¤Ÿæœ€å¤§é™åº¦çš„æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚å½“ç„¶ä¸¤ä¸ªå·¥å…·çš„ä¾§é‡ç‚¹æ˜¯ä¸ä¸€æ ·çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½æ¥é€‰æ‹©ã€‚<br>åœ¨æˆ‘ä¸ªäººçœ‹æ¥ï¼š</p><div class="tip">standard-version åå‘äºå°å·¥å…·å¼€å‘ï¼Œè‡ªè¡Œå†³å®šç±»åº“çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”å¯ä»¥åœ¨å‘å¸ƒå‰è¿›è¡Œä¿®æ”¹semantic-release åå‘äºworkflowï¼Œå¤šäººåä½œä¸‹é€šè¿‡mrè¿›è¡Œéœ€æ±‚çš„è¿­ä»£</div>å½“ç„¶ï¼Œæ— è®ºé‡‡å–å“ªç§å§¿åŠ¿ï¼Œæˆ‘ä»¬çš„æ ¸å¿ƒç›®æ ‡åªæœ‰ä¸€ä¸ªï¼š<p><img src="/images/version-management/dkam.png" alt="killAllHumans"><br>å®Œ~</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;åœ¨æˆ‘ä»¬æ—¥å¸¸Codingè¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šæœ‰å¼€å‘ç±»åº“çš„éœ€æ±‚&lt;/p&gt;</summary>
    
    
    
    
    <category term="æ¶æ„" scheme="https://tauleos.github.io/tags/%E6%9E%B6%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>ç»†è¯´HTTP Cache</title>
    <link href="https://tauleos.github.io/fa64e05e0810.html"/>
    <id>https://tauleos.github.io/fa64e05e0810.html</id>
    <published>2019-05-07T02:27:48.000Z</published>
    <updated>2024-11-06T08:27:08.638Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/1557042361870.png" alt="headers"></p><span id="more"></span><p>åœ¨ä¹‹å‰çš„æ–‡ç« <a href="https://tauleos.github.io/652b679860cc.html">æµè§ˆå™¨ç¼“å­˜ç†è®º</a>ä¸­ï¼Œæˆ‘ä»¬è¯¦ç»†è§£é‡Šäº†æµè§ˆå™¨ç¼“å­˜çš„å‡ ç§æ–¹å¼ï¼Œå…¶ä¸­çš„Disk Cacheä¸»è¦ä½¿ç”¨çš„ä¾¿æ˜¯HTTPåè®®ä¸­çš„ç¼“å­˜æœºåˆ¶ã€‚æµè§ˆå™¨ä¼šæ ¹æ®è¯·æ±‚çš„ç»“æœå’Œç¼“å­˜æ ‡è¯†ï¼Œä¼šåˆ¤æ–­æ˜¯ç›´æ¥ä»ç¼“å­˜ä¸­è¯»å–æ•°æ®è¿˜æ˜¯å‘æœåŠ¡å™¨å‘è¯·æ±‚åˆ¤æ–­ç¼“å­˜çš„æœ‰æ•ˆæ€§ï¼Œå‰è€…è¢«ç§°ä¸º<strong>å¼ºç¼“å­˜</strong>ï¼Œåè€…è¢«ç§°ä¸º<strong>åå•†ç¼“å­˜</strong>ã€‚</p><h2 id="å¼ºç¼“å­˜"><a href="#å¼ºç¼“å­˜" class="headerlink" title="å¼ºç¼“å­˜"></a>å¼ºç¼“å­˜</h2><p>å³ä¸ä¼šå‘æœåŠ¡å™¨å‘è¯·æ±‚è·å–èµ„æºï¼Œç›´æ¥åœ¨ç¼“å­˜ä¸­è¯»å–æ•°æ®ã€‚åœ¨æ§åˆ¶å°ä¸­ HTTP status ä¸º200,Size æ˜¾ç¤ºfrom memory cache æˆ–è€… from disk cache;ç”±ä¸¤ä¸ªhttp header å­—æ®µæ¥æ§åˆ¶ï¼š<strong>Expireså’ŒCache-Control</strong>ã€‚</p><h3 id="Expires"><a href="#Expires" class="headerlink" title="Expires"></a>Expires</h3><ul><li>ç”¨æ¥æŒ‡å®šèµ„æºåˆ°æœŸçš„æ—¶é—´,æ˜¯ä¸€ä¸ªå…·ä½“çš„æ—¶é—´ç‚¹ã€‚</li><li>æ˜¯HTTP/1çš„äº§ç‰©ï¼Œå¦‚æœä¿®æ”¹äº†æœ¬åœ°æ—¶é—´ï¼Œä¼šé€ æˆç¼“å­˜å¤±æ•ˆã€‚æœ‰ä¸€å®šçš„å±€é™æ€§ã€‚</li></ul><h3 id="Cache-Control"><a href="#Cache-Control" class="headerlink" title="Cache-Control"></a>Cache-Control</h3><p>æ˜¯HTTP/1.1çš„äº§ç‰©ï¼Œå¯ä»¥ç»„åˆå¤šç§æŒ‡ä»¤</p><table><thead><tr><th>æŒ‡ä»¤</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>public</td><td>è¡¨ç¤ºå¯ä»¥è¢«å®¢æˆ·ç«¯å’Œä»£ç†æœåŠ¡å™¨ç¼“å­˜</td></tr><tr><td>private</td><td>è¡¨ç¤ºåªå¯ä»¥è¢«å®¢æˆ·ç«¯ç¼“å­˜</td></tr><tr><td>max-age=30</td><td>èµ„æº30ç§’ä¹‹åå°±è¿‡æœŸï¼Œéœ€è¦é‡æ–°è¯·æ±‚</td></tr><tr><td>s-max-age=30</td><td>è¦†ç›–max-age,ä½œç”¨ç›¸åŒï¼Œåªåœ¨<strong>ä»£ç†æœåŠ¡å™¨</strong>ä¸­ç”Ÿæ•ˆ</td></tr><tr><td>no-store</td><td>ä¸ç¼“å­˜ä»»ä½•å“åº”</td></tr><tr><td>no-cache</td><td>èµ„æºä¼šè¢«ç¼“å­˜ï¼Œä½†æ˜¯ç«‹å³å¤±æ•ˆï¼Œä¸‹æ¬¡ä¼šå‘èµ·è¯·æ±‚éªŒè¯èµ„æºæ˜¯å¦è¿‡æœŸ</td></tr><tr><td>max-scale=30</td><td>30ç§’å†…ï¼Œå³ä½¿ç¼“å­˜è¿‡æœŸï¼Œä¹Ÿä½¿ç”¨è¯¥èµ„æº(æ— æ•Œé‡‘èº«æœŸ)</td></tr><tr><td>min-fresh=30</td><td>å¸Œæœ›åœ¨30ç§’å†…è·å–æœ€æ–°çš„å“åº”</td></tr></tbody></table><div class="tip">å¼ºç¼“å­˜åˆ¤æ–­æ˜¯å¦ç¼“å­˜çš„ä¾æ®æ¥è‡ªäºæ˜¯å¦è¶…å‡ºæŸä¸ªæ—¶é—´æˆ–è€…æŸä¸ªæ—¶é—´æ®µï¼Œè€Œä¸å…³å¿ƒæœåŠ¡å™¨ç«¯æ–‡ä»¶æ˜¯å¦å·²ç»æ›´æ–°</div><h2 id="åå•†ç¼“å­˜"><a href="#åå•†ç¼“å­˜" class="headerlink" title="åå•†ç¼“å­˜"></a>åå•†ç¼“å­˜</h2><p>åœ¨å¼ºç¼“å­˜å¤±æ•ˆä¹‹åï¼Œæµè§ˆå™¨ä¼šæºå¸¦ç¼“å­˜æ ‡è¯†å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡å™¨ä¼šæ ¹æ®ç¼“å­˜æ ‡è¯†æ¥å’Œæµè§ˆå™¨åå•†èµ„æºçš„ç¼“å­˜æƒ…å†µï¼Œè¿™ä¸€è¿‡ç¨‹ç§°ä¹‹ä¸ºåå•†ç¼“å­˜ã€‚åå•†æˆåŠŸï¼Œè¿”å›304å’Œç©ºçš„å“åº”ä½“ï¼Œåå•†å¤±è´¥ï¼Œè¿”å›200å’Œæ–°çš„èµ„æºã€‚</p><h2 id="Last-Modifiedå’ŒIf-Modified-Since"><a href="#Last-Modifiedå’ŒIf-Modified-Since" class="headerlink" title="Last-Modifiedå’ŒIf-Modified-Since"></a>Last-Modifiedå’ŒIf-Modified-Since</h2><ul><li>æµè§ˆå™¨åœ¨ç¬¬ä¸€æ¬¡è®¿é—®èµ„æºçš„æ—¶å€™ï¼ŒæœåŠ¡å™¨ä¼šåœ¨response headerä¸­åŠ å…¥last-Modified=timevalue(è¯¥èµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´)ï¼Œæµè§ˆå™¨æ¥æ”¶åˆ°å“åº”ï¼Œä¼šå°†èµ„æºå’Œheaderä¸€åŒç¼“å­˜èµ·æ¥ã€‚</li><li>æµè§ˆå™¨å†æ¬¡è¯·æ±‚è¯¥èµ„æºæ—¶ï¼Œä¼šå°†Last-Modifiedçš„å€¼timevalueæ”¾åœ¨If-Modified-Sinceä¸­ï¼Œå³If-Modified-Since=timevalue</li><li>æœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚ï¼Œä¼šå°†timevalueä¸è¯¥èµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœæ²¡æœ‰å˜åŒ–ï¼Œè¿”å›304å’Œç©ºçš„å“åº”ä½“ï¼Œå¦‚æœtimevalueå°äºæœ€åä¿®æ”¹æ—¶é—´ï¼Œè¯´æ˜èµ„æºå‘ç”Ÿäº†å˜åŒ–ï¼Œè¿”å›200å’Œæ–°çš„èµ„æºã€‚</li></ul><p>ä½†æ˜¯Last-Modifiedå­˜åœ¨ä¸€äº›å¼Šç«¯ï¼š</p><ul><li>å¦‚æœæœ¬åœ°æ‰“å¼€ç¼“å­˜æ–‡ä»¶ï¼Œä¸ç®¡æœ‰æ²¡æœ‰ä¿®æ”¹ï¼Œéƒ½ä¼šé€ æˆLast-Modified çš„å€¼å‘ç”Ÿå˜åŒ–ï¼ŒæœåŠ¡ç«¯ä¸èƒ½å‘½ä¸­ç¼“å­˜å¯¼è‡´å‘é€åŒæ ·çš„èµ„æº</li><li>å› ä¸ºLast-Modifiedçš„å€¼æ˜¯ä»¥ç§’ä¸ºæœ€å°å•ä½ï¼Œå¦‚æœåœ¨ä¸å¯æ„ŸçŸ¥çš„æ—¶é—´å†…ä¿®æ”¹å®Œæˆæ–‡ä»¶ï¼ŒæœåŠ¡ç«¯è¿˜æ˜¯ä¼šè®¤ä¸ºèµ„æºä¼šå‘½ä¸­ï¼Œä¸è¿”å›æ­£ç¡®çš„èµ„æºã€‚</li></ul><h2 id="Etagå’ŒIf-None-Match"><a href="#Etagå’ŒIf-None-Match" class="headerlink" title="Etagå’ŒIf-None-Match"></a>Etagå’ŒIf-None-Match</h2><p><strong>Etagæ˜¯æœåŠ¡å™¨å“åº”è¯·æ±‚æ—¶ï¼Œè¿”å›å½“å‰èµ„æºæ–‡ä»¶çš„ä¸€ä¸ªå”¯ä¸€æ ‡è¯†(ç”±æœåŠ¡å™¨ç”Ÿæˆ)ï¼Œåªè¦èµ„æºæœ‰å˜åŒ–ï¼ŒEtagå°±ä¼šé‡æ–°ç”Ÿæˆ</strong>ã€‚</p><ul><li>åŒä¸Šé¢Last_Modifiedç±»ä¼¼,ç¬¬ä¸€æ¬¡è¯·æ±‚çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨ä¼šç”Ÿæˆä¸€ä¸ªå”¯ä¸€æ ‡ç¤ºä½œä¸ºEtagçš„å€¼(hashvalue)è¿”å›ç»™æµè§ˆå™¨</li><li>æµè§ˆå™¨å†æ¬¡è¯·æ±‚èµ„æºçš„æ—¶å€™ï¼Œä¼šæŠŠhashvalue(Etagçš„å€¼)ä½œä¸ºè¯·æ±‚å¤´é‡Œçš„If-None-Match çš„å€¼ã€‚æœåŠ¡å™¨åªéœ€è¦æ¯”å¯¹è¿™ä¸¤ä¸ªå€¼æ˜¯å¦ä¸€è‡´ï¼Œå°±å¯ä»¥å¾ˆå¥½åœ°åˆ¤æ–­èµ„æºæœ‰æ²¡æœ‰è¢«ä¿®æ”¹è¿‡ã€‚</li></ul><h2 id="äºŒè€…å¯¹æ¯”"><a href="#äºŒè€…å¯¹æ¯”" class="headerlink" title="äºŒè€…å¯¹æ¯”"></a>äºŒè€…å¯¹æ¯”</h2><ul><li>åœ¨ç²¾åº¦ä¸Šï¼ŒEtagä¼˜äºLast-Modified</li><li>åœ¨æ€§èƒ½ä¸Šï¼ŒEtagé€ŠäºLast-Modified</li><li>åœ¨ä¼˜å…ˆçº§ä¸Šï¼ŒEtagé«˜äºLast-Modified</li></ul><h1 id="ç¼“å­˜ä¼˜å…ˆçº§"><a href="#ç¼“å­˜ä¼˜å…ˆçº§" class="headerlink" title="ç¼“å­˜ä¼˜å…ˆçº§"></a>ç¼“å­˜ä¼˜å…ˆçº§</h1><ul><li>å¼ºç¼“å­˜ä¼˜å…ˆäºåå•†ç¼“å­˜</li><li>å¦‚æœæ²¡æœ‰è®¾ç½®ä»»ä½•ç¼“å­˜ç­–ç•¥ï¼Œæµè§ˆå™¨ä¼šé‡‡ç”¨å¯å‘å¼ç®—æ³•ï¼Œé€šå¸¸ä¼šå–å“åº”å¤´ä¸­çš„Dateå‡å»Last-Modified å€¼çš„ 10% ä½œä¸ºç¼“å­˜æ—¶é—´ã€‚</li></ul><p>å‚è€ƒæ–‡ç« </p><p><a href="https://juejin.im/post/5c22ee806fb9a049fb43b2c5">ä¸€æ–‡è¯»æ‡‚å‰ç«¯ç¼“å­˜</a></p><p><a href="https://www.jianshu.com/p/54cc04190252">æ·±å…¥ç†è§£æµè§ˆå™¨çš„ç¼“å­˜æœºåˆ¶</a></p><p><a href="http://www.alloyteam.com/2016/03/discussion-on-web-caching/">æµ…è°ˆWebç¼“å­˜</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/images/1557042361870.png&quot; alt=&quot;headers&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    
    <category term="ç†è®º" scheme="https://tauleos.github.io/tags/%E7%90%86%E8%AE%BA/"/>
    
    <category term="http" scheme="https://tauleos.github.io/tags/http/"/>
    
  </entry>
  
  <entry>
    <title>Reactç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ</title>
    <link href="https://tauleos.github.io/5720ed7e6faf.html"/>
    <id>https://tauleos.github.io/5720ed7e6faf.html</id>
    <published>2019-04-26T09:05:02.000Z</published>
    <updated>2024-11-06T08:27:08.634Z</updated>
    
    <content type="html"><![CDATA[<p>ç»„ä»¶ä»è¢«åˆ›å»ºåˆ°è¢«é”€æ¯çš„è¿‡ç¨‹ç§°ä¸ºç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸã€‚Reactä¸ºç»„ä»¶åœ¨ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸé˜¶æ®µæä¾›äº†ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œè®©å¼€å‘è€…å¯ä»¥æ›´å¥½åœ°æ§åˆ¶ç»„ä»¶çš„è¡Œä¸ºã€‚<br> <strong>æ³¨æ„ï¼šåªæœ‰class component æ‰å…·æœ‰ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œfunctional component æ˜¯æ²¡æœ‰ç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„ã€‚å› æ­¤ä¸è¦åœ¨functional componentä¸­ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</strong></p><span id="more"></span><h1 id="ç”Ÿå‘½å‘¨æœŸå¦‚å›¾æ‰€ç¤º"><a href="#ç”Ÿå‘½å‘¨æœŸå¦‚å›¾æ‰€ç¤º" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸå¦‚å›¾æ‰€ç¤º"></a>ç”Ÿå‘½å‘¨æœŸå¦‚å›¾æ‰€ç¤º</h1><p><img src="/images/1556269802577.webp" alt="ç”Ÿå‘½å‘¨æœŸå›¾"></p><h1 id="ç”Ÿå‘½å‘¨æœŸçš„ä¸‰ä¸ªé˜¶æ®µ"><a href="#ç”Ÿå‘½å‘¨æœŸçš„ä¸‰ä¸ªé˜¶æ®µ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸçš„ä¸‰ä¸ªé˜¶æ®µ"></a>ç”Ÿå‘½å‘¨æœŸçš„ä¸‰ä¸ªé˜¶æ®µ</h1><h2 id="æŒ‚è½½é˜¶æ®µ"><a href="#æŒ‚è½½é˜¶æ®µ" class="headerlink" title="æŒ‚è½½é˜¶æ®µ"></a>æŒ‚è½½é˜¶æ®µ</h2><blockquote><p>è¿™ä¸ªé˜¶æ®µç»„ä»¶è¢«åˆ›å»ºï¼Œæ‰§è¡Œåˆå§‹åŒ–,å¹¶è¢«æŒ‚è½½åˆ°DOMä¸­ï¼Œå®Œæˆç»„ä»¶çš„ç¬¬ä¸€æ¬¡æ¸²æŸ“ã€‚è¯¥é˜¶æ®µçš„æ–¹æ³•æœ‰:</p><p>1.<a href="#constructor">constructor</a><br>2.<a href="#componentWillMount">componentWillMount</a><br>3.<a href="#render">render</a><br>4.<a href="#componentDidMount">componentDidMount</a></p></blockquote><h3 id="constructor-NaN"><a href="#constructor-NaN" class="headerlink" title="constructor"></a>constructor</h3><p>è¿™æ˜¯ES6çš„<strong>class</strong>çš„æ„é€ æ–¹æ³•ï¼Œé€šå¸¸ç”¨äº<strong>åˆå§‹åŒ–ç»„ä»¶çš„stateä»¥åŠç»‘å®šäº‹ä»¶å¤„ç†æ–¹æ³•ç­‰å·¥ä½œ</strong></p><h3 id="componentWillMount"><a href="#componentWillMount" class="headerlink" title="componentWillMount"></a>componentWillMount</h3><p>è¿™ä¸ªæ–¹æ³•åœ¨ç»„ä»¶è¢«æŒ‚è½½åˆ°DOMå‰è°ƒç”¨ï¼Œ<strong>ä¸”åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡</strong>ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨å®é™…é¡¹ç›®ä¸­<strong>å¾ˆå°‘</strong>ä¼šç”¨åˆ°ï¼Œå› ä¸ºå¯ä»¥åœ¨è¯¥æ–¹æ³•ä¸­æ‰§è¡Œçš„å·¥ä½œéƒ½å¯ä»¥æå‰åˆ°<strong>constructor</strong>ä¸­ã€‚<strong>åœ¨è¿™ä¸ªæ–¹æ³•ä¸­è°ƒç”¨setStateä¸ä¼šå¼•èµ·ç»„ä»¶çš„é‡æ–°æ¸²æŸ“</strong></p><h3 id="render"><a href="#render" class="headerlink" title="render"></a>render</h3><p>æ ¹æ®ç»„ä»¶çš„popså’Œstateè¿”å›ä¸€ä¸ªReactå…ƒç´ ï¼Œè¯¥å…ƒç´ ç”¨äºæè¿°ç»„ä»¶çš„UIã€‚åœ¨è¯¥æ–¹æ³•ä¸­ä¸èƒ½æ‰§è¡Œä»»ä½•æœ‰å‰¯ä½œç”¨çš„æ“ä½œï¼Œæ‰€ä»¥ä¸èƒ½åœ¨renderä¸­è°ƒç”¨setStateï¼Œä¼šæ”¹å˜ç»„ä»¶çš„çŠ¶æ€ã€‚</p><h3 id="componentDidMount"><a href="#componentDidMount" class="headerlink" title="componentDidMount"></a>componentDidMount</h3><p>åœ¨ç»„ä»¶è¢«æŒ‚è½½åˆ°DOMåè°ƒç”¨ï¼Œ<strong>ä¸”åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡</strong>ã€‚è¿™ä¸ªæ—¶å€™å·²ç»å¯ä»¥è·å–åˆ°DOMç»“æ„ï¼Œ<strong>å› æ­¤ä¾èµ–DOMèŠ‚ç‚¹çš„æ“ä½œå¯ä»¥æ”¾åˆ°è¿™ä¸ªæ–¹æ³•ä¸­ã€‚è¿™ä¸ªæ–¹æ³•é€šå¸¸è¿˜ç”¨äºå‘æœåŠ¡ç«¯è¯·æ±‚æ•°æ®</strong>ã€‚è°ƒç”¨this.setState ä¼šå¼•èµ·ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ã€‚</p><h2 id="æ›´æ–°é˜¶æ®µ"><a href="#æ›´æ–°é˜¶æ®µ" class="headerlink" title="æ›´æ–°é˜¶æ®µ"></a>æ›´æ–°é˜¶æ®µ</h2><p>ç»„ä»¶è¢«æŒ‚è½½åˆ°DOMåï¼Œç»„ä»¶çš„propsæˆ–stateæ”¹å˜ä¼šå¼•èµ·ç»„ä»¶çš„æ›´æ–°ã€‚</p><ul><li>propså¼•èµ·çš„æ›´æ–°ï¼Œæœ¬è´¨ä¸Šæ˜¯ç”±æ¸²æŸ“è¯¥ç»„ä»¶çš„çˆ¶ç»„ä»¶å¼•èµ·çš„(ä¹Ÿå°±æ˜¯å½“çˆ¶ç»„ä»¶çš„renderæ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œç»„ä»¶ä¼šå‘ç”Ÿæ›´æ–°è¿‡ç¨‹)ï¼Œæ— è®ºpropsæ˜¯å¦æ”¹å˜ï¼Œçˆ¶ç»„ä»¶renderæ–¹æ³•æ¯ä¸€æ¬¡è°ƒç”¨ï¼Œéƒ½ä¼šå¯¼è‡´ç»„ä»¶æ›´æ–°ã€‚</li><li>stateå¼•èµ·çš„ç»„ä»¶æ›´æ–°ï¼Œæ˜¯é€šè¿‡this.setStateä¿®æ”¹ç»„ä»¶çš„stateè§¦å‘çš„ã€‚<br>ç»„ä»¶æ›´æ–°é˜¶æ®µä¾æ¬¡è°ƒç”¨çš„æ–¹æ³•æœ‰ï¼š</li></ul><p>1.<a href="#componentWillReceiveProps(nextProps)">componentWillReceiveProps</a><br>2.<a href="#shouldComponentUpdate(nextProps,nextState)">shouldComponentUpdate</a><br>3.<a href="#componentWillUpdate">componentWillUpdate</a><br>4.<a href="#render">render</a><br>5.<a href="#componentDidUpdate(prevProps,prevState)">componentDidUpdate</a></p><h3 id="componentWillReceiveProps-nextProps"><a href="#componentWillReceiveProps-nextProps" class="headerlink" title="componentWillReceiveProps(nextProps)"></a>componentWillReceiveProps(nextProps)</h3><ul><li>è¯¥æ–¹æ³•åªåœ¨propså¼•èµ·çš„ç»„ä»¶æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œæ‰ä¼šè¢«è°ƒç”¨ã€‚stateå¼•èµ·çš„ç»„ä»¶æ›´æ–°å¹¶ä¸ä¼šè§¦å‘ã€‚</li><li>nextPropsæ˜¯çˆ¶ç»„ä»¶ä¼ é€’ç»™å½“å‰ç»„ä»¶çš„æ–°çš„props</li><li>nextPropsçš„å€¼å¯èƒ½ä¸å­ç»„ä»¶å½“å‰propsçš„å€¼ç›¸åŒï¼Œå› æ­¤å¾€å¾€éœ€è¦æ¯”è¾ƒä»–ä¿©çš„å€¼æ¥å†³å®šæ˜¯å¦æ‰§è¡Œpropså‘ç”Ÿå˜åŒ–åçš„é€»è¾‘ã€‚</li><li> <strong>åœ¨è¯¥æ–¹æ³•ä¸­è°ƒç”¨setStateï¼Œåªæœ‰renderä»¥åŠä¹‹åçš„æ–¹æ³•ä¸­ã€‚this.stateæŒ‡å‘çš„æ‰æ˜¯æ›´æ–°åçš„stateã€‚åœ¨ä¹‹å‰çš„shouldComponentUpdateã€componentWillUpdateä¸­ã€‚this.stateæŒ‡å‘çš„è¿˜æ˜¯æ›´æ–°å‰çš„state</strong></li></ul><h3 id="shouldComponentUpdate-nextProps-nextState"><a href="#shouldComponentUpdate-nextProps-nextState" class="headerlink" title="shouldComponentUpdate(nextProps,nextState)"></a>shouldComponentUpdate(nextProps,nextState)</h3><ul><li>è¯¥æ–¹æ³•å†³å®šç»„ä»¶æ˜¯å¦ç»§ç»­æ‰§è¡Œæ›´æ–°è¿‡ç¨‹ã€‚å½“è¯¥æ–¹æ³•è¿”å›true(é»˜è®¤å€¼)æ—¶ç»§ç»­æ‰§è¡Œï¼Œè¿”å›falseæ—¶åœæ­¢æ‰§è¡Œ</li><li>ä¸€èˆ¬é€šè¿‡æ¯”è¾ƒnextPropsã€nextStateä¸ç»„ä»¶å½“å‰çš„propsã€stateæ¥å†³å®šè¿”å›å€¼ã€‚</li><li>è¯¥æ–¹æ³•å¯ç”¨æ¥å‡å°‘ä¸å¿…è¦çš„æ¸²æŸ“ï¼Œä»è€Œ<strong>ä¼˜åŒ–ç»„ä»¶çš„æ€§èƒ½</strong></li></ul><h3 id="componentWillUpdate"><a href="#componentWillUpdate" class="headerlink" title="componentWillUpdate"></a>componentWillUpdate</h3><p>è¯¥æ–¹æ³•åœ¨ç»„ä»¶renderä¹‹å‰è°ƒç”¨æ‰§è¡Œï¼Œå¯ä»¥ä½œä¸ºç»„ä»¶æ›´æ–°å‰æ‰§è¡ŒæŸäº›å·¥ä½œçš„åœ°æ–¹ã€‚ä¸€èˆ¬å¾ˆå°‘ç”¨åˆ°</p><blockquote><p>shouldComponentUpdate ä¸componentWillUpdateä¸­ä¸èƒ½è°ƒç”¨this.setState,å¦åˆ™ä¼šå¼•èµ·å¾ªç¯è°ƒç”¨é—®é¢˜ï¼Œrenderæ°¸è¿œæ— æ³•è¢«è°ƒç”¨ï¼Œç»„ä»¶ä¹Ÿæ°¸è¿œæ— æ³•æ¸²æŸ“</p></blockquote><h3 id="componentDidUpdate-prevProps-prevState"><a href="#componentDidUpdate-prevProps-prevState" class="headerlink" title="componentDidUpdate(prevProps,prevState)"></a>componentDidUpdate(prevProps,prevState)</h3><p>ç»„ä»¶æ›´æ–°åè¢«è°ƒç”¨ï¼Œå¯ä»¥ä½œä¸ºæ“ä½œæ›´æ–°åçš„DOMçš„åœ°æ–¹ã€‚ä¸¤ä¸ªå‚æ•°ä»£è¡¨ç»„ä»¶æ›´æ–°å‰çš„propså’Œstate</p><h2 id="å¸è½½é˜¶æ®µ"><a href="#å¸è½½é˜¶æ®µ" class="headerlink" title="å¸è½½é˜¶æ®µ"></a>å¸è½½é˜¶æ®µ</h2><p>ç»„ä»¶çš„å¸è½½é˜¶æ®µåªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼š</p><h3 id="componentWillUnmount"><a href="#componentWillUnmount" class="headerlink" title="componentWillUnmount"></a>componentWillUnmount</h3><p>è¯¥æ–¹æ³•åœ¨ç»„ä»¶è¢«å¸è½½å‰è°ƒç”¨ï¼Œå¯ä»¥åœ¨è¿™é‡Œæ‰§è¡Œä¸€äº›æ¸…ç†å·¥ä½œï¼Œæ¯”å¦‚æ¸…æ¥šå®šæ—¶å™¨ï¼Œæ¸…é™¤<a href="#didMount">componentDidMount</a>ä¸­æ‰‹åŠ¨åˆ›å»ºçš„DOMå…ƒç´ ç­‰ç­‰ã€‚é˜²æ­¢å†…å­˜æ³„éœ²</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ç»„ä»¶ä»è¢«åˆ›å»ºåˆ°è¢«é”€æ¯çš„è¿‡ç¨‹ç§°ä¸ºç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸã€‚Reactä¸ºç»„ä»¶åœ¨ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸé˜¶æ®µæä¾›äº†ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œè®©å¼€å‘è€…å¯ä»¥æ›´å¥½åœ°æ§åˆ¶ç»„ä»¶çš„è¡Œä¸ºã€‚&lt;br&gt; &lt;strong&gt;æ³¨æ„ï¼šåªæœ‰class component æ‰å…·æœ‰ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œfunctional component æ˜¯æ²¡æœ‰ç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„ã€‚å› æ­¤ä¸è¦åœ¨functional componentä¸­ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³•&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    
    <category term="js" scheme="https://tauleos.github.io/tags/js/"/>
    
    <category term="react" scheme="https://tauleos.github.io/tags/react/"/>
    
  </entry>
  
  <entry>
    <title>æµè§ˆå™¨ç¼“å­˜ç†è®º</title>
    <link href="https://tauleos.github.io/652b679860cc.html"/>
    <id>https://tauleos.github.io/652b679860cc.html</id>
    <published>2019-04-12T07:25:49.000Z</published>
    <updated>2024-11-06T08:27:08.637Z</updated>
    
    <content type="html"><![CDATA[<p>ç¼“å­˜å¯ä»¥è¯´æ˜¯æ€§èƒ½ä¼˜åŒ–ä¸­ç®€å•é«˜æ•ˆçš„ä¸€ç§ä¼˜åŒ–æ–¹å¼ï¼Œå¯ä»¥ç¼©çŸ­ç½‘é¡µè¯·æ±‚èµ„æºçš„è·ç¦»ï¼Œå‡å°‘å»¶è¿Ÿï¼Œå¹¶ä¸”ç”±äºç¼“å­˜æ–‡ä»¶å¯ä»¥é‡å¤åˆ©ç”¨ï¼Œè¿˜å¯ä»¥å‡å°‘å¸¦å®½ï¼Œé™ä½ç½‘ç»œè´Ÿè·ã€‚</p><span id="more"></span><h1 id="ç¼“å­˜ä½ç½®"><a href="#ç¼“å­˜ä½ç½®" class="headerlink" title="ç¼“å­˜ä½ç½®"></a>ç¼“å­˜ä½ç½®</h1><ul><li><a href="#Service-Worker">Service Worker</a></li><li><a href="#Memory-Cache">Memory Cache</a></li><li><a href="#DisK-Cache">DisK Cache</a></li><li><a href="#Push-Cache">Push Cache</a></li></ul><h2 id="Service-Worker"><a href="#Service-Worker" class="headerlink" title="Service Worker"></a>Service Worker</h2><p>Service Worker æ˜¯è¿è¡Œåœ¨æµè§ˆå™¨èƒŒåçš„ç‹¬ç«‹çº¿ç¨‹ï¼Œä¸€èˆ¬å¯ä»¥ç”¨æ¥å®ç°ç¼“å­˜åŠŸèƒ½ï¼Œå¿…é¡»åŸºäºHTTPSåè®®ã€‚<strong>Service Worker çš„ç¼“å­˜ä¸æµè§ˆå™¨å…¶ä»–å†…å»ºçš„ç¼“å­˜æœºåˆ¶ä¸åŒï¼Œå®ƒå¯ä»¥è®©æˆ‘ä»¬è‡ªç”±æ§åˆ¶ç¼“å­˜å“ªäº›æ–‡ä»¶ã€å¦‚ä½•åŒ¹é…ç¼“å­˜ã€å¦‚ä½•è¯»å–ç¼“å­˜ï¼Œå¹¶ä¸”ç¼“å­˜æ˜¯æŒç»­æ€§çš„ã€‚</strong><br>Service Worker å®ç°ç¼“å­˜åŠŸèƒ½ä¸€èˆ¬åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼š</p><ul><li>æ³¨å†Œservice Worker</li><li>ç›‘å¬installæ—¶é—´</li><li>ç¼“å­˜éœ€è¦çš„æ–‡ä»¶</li></ul><p>ç¼“å­˜ä¹‹åï¼ŒService Worker å¯ä»¥æ‹¦æˆªä¸‹æ¬¡çš„è¯·æ±‚æ¥æŸ¥è¯¢æ˜¯å¦å­˜åœ¨ç¼“å­˜ã€‚å¦‚æœæ²¡æœ‰å‘½ä¸­ç¼“å­˜ï¼Œéœ€è¦ä½¿ç”¨fetchå‡½æ•°å»è¯·æ±‚æ•°æ®(æ ¹æ®ç¼“å­˜ä¼˜å…ˆçº§æ¥è·å–æ•°æ®ï¼›ä½†æ˜¯è¿˜æ˜¯ç°å®åœ¨Service Workerä¸­è·å–çš„å†…å®¹)ã€‚</p><h2 id="Memory-Cache"><a href="#Memory-Cache" class="headerlink" title="Memory Cache"></a>Memory Cache</h2><p>Memory Cache æ˜¯å†…å­˜ä¸­çš„ç¼“å­˜ï¼Œä¸»è¦åŒ…æ‹¬å½“å‰é¡µé¢ä¸­å·²ç»æŠ“å–çš„èµ„æº(å·²ç»ä¸‹è½½çš„æ ·å¼ã€è„šæœ¬ã€å›¾ç‰‡ç­‰)ã€‚åœ¨å†…å­˜ä¸­è¯»å–ç¼“å­˜é€Ÿåº¦å¿«ï¼Œè¯»å–é«˜æ•ˆï¼Œä½†æ˜¯æŒç»­æ€§å¾ˆçŸ­ï¼Œä¼šè·Ÿéšè¿›ç¨‹çš„é‡Šæ”¾è€Œé‡Šæ”¾ã€‚<br>ä»¥ä¸‹å‡ ç§æƒ…å†µä¸‹èµ„æºä¼šè¢«ç¼“å­˜åœ¨Memory Cacheä¸­ï¼š</p><ul><li>è¢«é¢„åŠ è½½å™¨(Preloader)è·å–çš„ã€‚</li><li>é¢„åŠ è½½æŒ‡ä»¤(<link rel=preload>)</li><li>ä¹‹å‰çš„DOMé˜¶æ®µæˆ–è€…CSSè§„åˆ™å¼•èµ·çš„è¯·æ±‚ã€‚</li></ul><p>ä½†æ˜¯Memory Cacheä¸ä¼šè½»æ˜“çš„å‘½ä¸­ä¸€ä¸ªè¯·æ±‚ï¼Œé™¤äº†è¦æœ‰åŒ¹é…çš„URLï¼Œè¿˜è¦æœ‰ç›¸åŒçš„èµ„æºç±»å‹ã€CORSæ¨¡å¼ä»¥åŠä¸€äº›å…¶ä»–ç‰¹æ€§ã€‚</p><blockquote><p>Memory CacheåŒ¹é…è§„åˆ™åœ¨æ ‡å‡†ä¸­æ²¡æœ‰è¯¦å°½çš„æè¿°ï¼Œæ‰€ä»¥ä¸åŒçš„æµè§ˆå™¨å†…æ ¸åœ¨å®ç°ä¸Šä¼šæœ‰æ‰€ä¸åŒã€‚</p></blockquote><blockquote><p>Memory Cacheæ˜¯ä¸å…³å¿ƒHTTPè¯­ä¹‰çš„ï¼Œæ¯”å¦‚Cache-Control: max-age=0çš„èµ„æºï¼Œä»ç„¶å¯ä»¥åœ¨åŒä¸€ä¸ªå¯¼èˆªä¸­è¢«é‡ç”¨ã€‚ä½†æ˜¯åœ¨ç‰¹å®šçš„æƒ…å†µä¸‹ï¼ŒMemory Cacheä¼šéµå®ˆCache-Control: no-storeæŒ‡ä»¤ï¼Œä¸ç¼“å­˜ç›¸åº”çš„èµ„æºã€‚</p></blockquote><h2 id="Disk-Cache"><a href="#Disk-Cache" class="headerlink" title="Disk Cache"></a>Disk Cache</h2><p>Disk Cache ä¹Ÿå°±æ˜¯æˆ‘ä»¬ç»å¸¸è¯´çš„HTTP Cache,é¡¾åæ€ä¹‰ï¼Œå®ƒæ˜¯å­˜å‚¨åœ¨ç¡¬ç›˜ä¸­çš„ç¼“å­˜ï¼Œå…·æœ‰è¾ƒå¼ºçš„æ—¶æ•ˆæ€§å’Œå¤§çš„å®¹é‡æ€§ã€‚<br>æµè§ˆå™¨ä¼šæŠŠå“ªäº›æ–‡ä»¶ä¸¢è¿›å†…å­˜ä¸­ï¼Ÿå“ªäº›ä¸¢è¿›ç¡¬ç›˜ä¸­ï¼Ÿå…³äºè¿™ç‚¹ï¼Œç½‘ä¸Šè¯´æ³•ä¸ä¸€ï¼Œä¸è¿‡ä»¥ä¸‹è§‚ç‚¹æ¯”è¾ƒé å¾—ä½ï¼š</p><ul><li>å¯¹äºå¤§æ–‡ä»¶æ¥è¯´ï¼Œå¤§æ¦‚ç‡æ˜¯ä¸å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ï¼Œåä¹‹ä¼˜å…ˆ</li><li>å½“å‰ç³»ç»Ÿå†…å­˜ä½¿ç”¨ç‡é«˜çš„è¯ï¼Œæ–‡ä»¶ä¼˜å…ˆå­˜å‚¨è¿›ç¡¬ç›˜</li></ul><h2 id="Push-Cache"><a href="#Push-Cache" class="headerlink" title="Push Cache"></a>Push Cache</h2><p>Push Cacheï¼ˆæ¨é€ç¼“å­˜ï¼‰æ˜¯ HTTP/2 ä¸­çš„å†…å®¹ï¼Œå½“ä»¥ä¸Šä¸‰ç§ç¼“å­˜éƒ½æ²¡æœ‰å‘½ä¸­æ—¶ï¼Œå®ƒæ‰ä¼šè¢«ä½¿ç”¨ã€‚å®ƒåªåœ¨ä¼šè¯ï¼ˆSessionï¼‰ä¸­å­˜åœ¨ï¼Œä¸€æ—¦ä¼šè¯ç»“æŸå°±è¢«é‡Šæ”¾ï¼Œå¹¶ä¸”ç¼“å­˜æ—¶é—´ä¹Ÿå¾ˆçŸ­æš‚ï¼Œåœ¨Chromeæµè§ˆå™¨ä¸­åªæœ‰5åˆ†é’Ÿå·¦å³ï¼ŒåŒæ—¶å®ƒä¹Ÿå¹¶éä¸¥æ ¼æ‰§è¡ŒHTTPå¤´ä¸­çš„ç¼“å­˜æŒ‡ä»¤ã€‚</p><ul><li>æ‰€æœ‰çš„èµ„æºéƒ½èƒ½è¢«æ¨é€ï¼Œå¹¶ä¸”èƒ½å¤Ÿè¢«ç¼“å­˜,ä½†æ˜¯ Edge å’Œ Safari æµè§ˆå™¨æ”¯æŒç›¸å¯¹æ¯”è¾ƒå·®</li><li>å¯ä»¥æ¨é€ no-cache å’Œ no-store çš„èµ„æº</li><li>ä¸€æ—¦è¿æ¥è¢«å…³é—­ï¼ŒPush Cache å°±è¢«é‡Šæ”¾</li><li>å¤šä¸ªé¡µé¢å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªHTTP/2çš„è¿æ¥ï¼Œä¹Ÿå°±å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªPush Cacheã€‚è¿™ä¸»è¦è¿˜æ˜¯ä¾èµ–æµè§ˆå™¨çš„å®ç°è€Œå®šï¼Œå‡ºäºå¯¹æ€§èƒ½çš„è€ƒè™‘ï¼Œæœ‰çš„æµè§ˆå™¨ä¼šå¯¹ç›¸åŒåŸŸåä½†ä¸åŒçš„tabæ ‡ç­¾ä½¿ç”¨åŒä¸€ä¸ªHTTPè¿æ¥ã€‚</li><li>Push Cache ä¸­çš„ç¼“å­˜åªèƒ½è¢«ä½¿ç”¨ä¸€æ¬¡</li><li>æµè§ˆå™¨å¯ä»¥æ‹’ç»æ¥å—å·²ç»å­˜åœ¨çš„èµ„æºæ¨é€</li><li>ä½ å¯ä»¥ç»™å…¶ä»–åŸŸåæ¨é€èµ„æº</li></ul><blockquote><p>å¦‚æœä»¥ä¸Šå››ç§ç¼“å­˜éƒ½æ²¡æœ‰å‘½ä¸­çš„è¯ï¼Œé‚£ä¹ˆåªèƒ½å‘èµ·è¯·æ±‚æ¥è·å–èµ„æºäº†ã€‚</p></blockquote><h1 id="ç¼“å­˜è¿‡ç¨‹åˆ†æ"><a href="#ç¼“å­˜è¿‡ç¨‹åˆ†æ" class="headerlink" title="ç¼“å­˜è¿‡ç¨‹åˆ†æ"></a>ç¼“å­˜è¿‡ç¨‹åˆ†æ</h1><p><img src="/images/1557055357514.png" alt="img"><br>ç”±ä¸Šå›¾å¯çŸ¥ï¼š</p><ul><li>æµè§ˆå™¨æ¯æ¬¡å‘èµ·è¯·æ±‚ï¼Œéƒ½ä¼šå…ˆåœ¨æµè§ˆå™¨ç¼“å­˜ä¸­æŸ¥æ‰¾è¯¥è¯·æ±‚çš„ç»“æœä»¥åŠç¼“å­˜æ ‡è¯†</li><li>æµè§ˆå™¨æ¯æ¬¡æ‹¿åˆ°è¿”å›çš„è¯·æ±‚ç»“æœéƒ½ä¼šå°†è¯¥ç»“æœå’Œç¼“å­˜æ ‡è¯†å­˜å…¥æµè§ˆå™¨ç¼“å­˜ä¸­<br>ä»¥ä¸Šä¸¤ç‚¹ç»“è®ºå°±æ˜¯æµè§ˆå™¨ç¼“å­˜æœºåˆ¶çš„å…³é”®ï¼Œå®ƒç¡®ä¿äº†æ¯ä¸ªè¯·æ±‚çš„ç¼“å­˜å­˜å…¥ä¸è¯»å–</li></ul><p>å‚è€ƒï¼š<br><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Cache-Control">mdn</a><br><a href="https://www.jianshu.com/p/54cc04190252">æ·±å…¥ç†è§£æµè§ˆå™¨çš„ç¼“å­˜æœºåˆ¶</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ç¼“å­˜å¯ä»¥è¯´æ˜¯æ€§èƒ½ä¼˜åŒ–ä¸­ç®€å•é«˜æ•ˆçš„ä¸€ç§ä¼˜åŒ–æ–¹å¼ï¼Œå¯ä»¥ç¼©çŸ­ç½‘é¡µè¯·æ±‚èµ„æºçš„è·ç¦»ï¼Œå‡å°‘å»¶è¿Ÿï¼Œå¹¶ä¸”ç”±äºç¼“å­˜æ–‡ä»¶å¯ä»¥é‡å¤åˆ©ç”¨ï¼Œè¿˜å¯ä»¥å‡å°‘å¸¦å®½ï¼Œé™ä½ç½‘ç»œè´Ÿè·ã€‚&lt;/p&gt;</summary>
    
    
    
    
    <category term="ç†è®º" scheme="https://tauleos.github.io/tags/%E7%90%86%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title>å¤ªæå›¾æ¡ˆ</title>
    <link href="https://tauleos.github.io/3710a8c65723.html"/>
    <id>https://tauleos.github.io/3710a8c65723.html</id>
    <published>2019-04-12T07:25:18.000Z</published>
    <updated>2024-11-06T08:27:08.637Z</updated>
    
    <content type="html"><![CDATA[<div class="yinyang"></div><style>  .yinyang{    display:flex;    align-items:center;    --color1: white;    --color2: black;    border-radius: 50%;    box-shadow:0 0 1em rgba(0,0,0,0.3);    width:20em;    height:20em;    /* background:lightgray; */    background-image: linear-gradient(var(--color1) 50% ,var(--color2) 50%);    animation:rotating linear 3s infinite;  }  .yinyang::before{    content:'';    box-sizing:border-box;    width:50%;    height:50%;    border-radius:50%;    border: 3em solid var(--color1);    background-color: var(--color2);    /* mix-blend-mode:screen; */  }  .yinyang::after{    content:'';    box-sizing:border-box;    width:50%;    height:50%;    border-radius:50%;    border: 3em solid var(--color2);    background-color: var(--color1);    /* mix-blend-mode:screen; */  }  @keyframes rotating {    to{      transform: rotate(360deg);    }  }</style>]]></content>
    
    
      
      
    <summary type="html">&lt;div class=&quot;yinyang&quot;&gt;&lt;/div&gt;
&lt;style&gt;
  .yinyang{
    display:flex;
    align-items:center;
    --color1: white;
    --color2: black;
    bord</summary>
      
    
    
    
    
    <category term="css" scheme="https://tauleos.github.io/tags/css/"/>
    
  </entry>
  
  <entry>
    <title>jsæºç å®ç°-call,apply,bind</title>
    <link href="https://tauleos.github.io/633b725634cd.html"/>
    <id>https://tauleos.github.io/633b725634cd.html</id>
    <published>2019-04-12T07:13:59.000Z</published>
    <updated>2024-11-06T08:27:08.635Z</updated>
    
    <content type="html"><![CDATA[<h2 id="åŒºåˆ«"><a href="#åŒºåˆ«" class="headerlink" title="åŒºåˆ«"></a>åŒºåˆ«</h2><blockquote><p><code>callã€applyã€bind</code> æœ¬è´¨éƒ½æ˜¯æ”¹å˜ <code>this</code> çš„æŒ‡å‘ï¼Œä¸åŒç‚¹ <code>callã€apply</code> æ˜¯ç›´æ¥è°ƒç”¨å‡½æ•°ï¼Œ<code>bind</code> æ˜¯è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚<code>call</code> è·Ÿ <code>apply</code> å°±åªæœ‰å‚æ•°ä¸Šä¸åŒã€‚</p><blockquote><p>åŒºåˆ«å°±æ˜¯<code>call()</code>æ–¹æ³•æ¥å—çš„æ˜¯å‚æ•°åˆ—è¡¨ï¼Œè€Œ<code>apply()</code>æ–¹æ³•æ¥å—çš„æ˜¯ä¸€ä¸ªå‚æ•°æ•°ç»„ã€‚</p></blockquote></blockquote><h2 id="bind"><a href="#bind" class="headerlink" title="bind"></a>bind</h2><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><ul><li>ç®­å¤´å‡½æ•°çš„ <code>this</code> æ°¸è¿œæŒ‡å‘å®ƒæ‰€åœ¨çš„ä½œç”¨åŸŸ</li><li>å‡½æ•°ä½œä¸ºæ„é€ å‡½æ•°ç”¨ <code>new</code> å…³é”®å­—è°ƒç”¨æ—¶ï¼Œä¸åº”è¯¥æ”¹å˜å…¶ <code>this</code> æŒ‡å‘ï¼Œå› ä¸º <code>newç»‘å®š</code> çš„ä¼˜å…ˆçº§é«˜äº <code>æ˜¾ç¤ºç»‘å®š</code> å’Œ <code>ç¡¬ç»‘å®š</code></li></ul><p>ä»£ç å®ç°</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">myBind</span> = <span class="keyword">function</span> (<span class="params">thisArg, ...args</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">this</span> !== <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="title class_">Error</span>(<span class="string">&#x27;must be a function&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// æ‹¿åˆ°å‚æ•°ä¼ ç»™è°ƒç”¨è€…</span></span><br><span class="line">  <span class="keyword">const</span> self = <span class="variable language_">this</span>,</span><br><span class="line">  <span class="comment">// æ„å»ºä¸€ä¸ªå¹²å‡€çš„å‡½æ•°ï¼Œç”¨äºä¿å­˜åŸå‡½æ•°çš„åŸå‹</span></span><br><span class="line">  nop = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">  <span class="comment">// ç»‘å®šçš„å‡½æ•°</span></span><br><span class="line">  bound = <span class="keyword">function</span> (<span class="params">...selfArgs</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> self.<span class="title function_">apply</span>(</span><br><span class="line">      <span class="comment">// this instanceof nop, åˆ¤æ–­æ˜¯å¦ä½¿ç”¨ new æ¥è°ƒç”¨ bound</span></span><br><span class="line">      <span class="comment">// å¦‚æœæ˜¯ new æ¥è°ƒç”¨çš„è¯ï¼Œthisçš„æŒ‡å‘å°±æ˜¯å…¶å®ä¾‹ï¼Œ</span></span><br><span class="line">      <span class="comment">// å¦‚æœä¸æ˜¯ new è°ƒç”¨çš„è¯ï¼Œå°±æ”¹å˜ this æŒ‡å‘åˆ°æŒ‡å®šçš„å¯¹è±¡ o</span></span><br><span class="line">      <span class="variable language_">this</span> <span class="keyword">instanceof</span> nop ? <span class="variable language_">this</span> : thisArg,</span><br><span class="line">      args.<span class="title function_">concat</span>(selfArgs)</span><br><span class="line">    );</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç®­å¤´å‡½æ•°æ²¡æœ‰ prototypeï¼Œç®­å¤´å‡½æ•°thisæ°¸è¿œæŒ‡å‘å®ƒæ‰€åœ¨çš„ä½œç”¨åŸŸ</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property"><span class="keyword">prototype</span></span>) &#123;</span><br><span class="line">    nop.<span class="property"><span class="keyword">prototype</span></span> = <span class="variable language_">this</span>.<span class="property"><span class="keyword">prototype</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ä¿®æ”¹ç»‘å®šå‡½æ•°çš„åŸå‹æŒ‡å‘</span></span><br><span class="line">  bound.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title function_">nop</span>();</span><br><span class="line">  <span class="keyword">return</span> bound;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> bar = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">bar.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">name</span> = <span class="string">&#x27;bar&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> foo = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;foo&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> bound = bar.<span class="title function_">mybind</span>(foo, <span class="number">22</span>, <span class="number">33</span>, <span class="number">44</span>);</span><br><span class="line"><span class="keyword">new</span> <span class="title function_">bound</span>(); <span class="comment">// bar, [22, 33, 44]</span></span><br><span class="line"><span class="title function_">bound</span>(); <span class="comment">// foo, [22, 33, 44]</span></span><br></pre></td></tr></table></figure><h2 id="Call-amp-Apply"><a href="#Call-amp-Apply" class="headerlink" title="Call &amp; Apply"></a>Call &amp; Apply</h2><h3 id="Call"><a href="#Call" class="headerlink" title="Call"></a>Call</h3><blockquote><p><code>bind</code> æ˜¯å°è£…äº† <code>call</code> çš„æ–¹æ³•æ”¹å˜äº† <code>this</code> çš„æŒ‡å‘å¹¶è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œé‚£ä¹ˆ <code>call</code> æ˜¯å¦‚ä½•åšåˆ°æ”¹å˜ <code>this</code> çš„æŒ‡å‘å‘¢ï¼ŸåŸç†å¾ˆç®€å•ï¼Œåœ¨æ–¹æ³•è°ƒç”¨æ¨¡å¼ä¸‹ï¼Œ<code>this</code> æ€»æ˜¯æŒ‡å‘è°ƒç”¨å®ƒæ‰€åœ¨æ–¹æ³•çš„å¯¹è±¡ï¼Œ<code>this</code> çš„æŒ‡å‘ä¸æ‰€åœ¨æ–¹æ³•çš„è°ƒç”¨ä½ç½®æœ‰å…³ï¼Œè€Œä¸æ–¹æ³•çš„å£°æ˜ä½ç½®æ— å…³ï¼ˆç®­å¤´å‡½æ•°ç‰¹æ®Šï¼‰ã€‚å…ˆå†™ä¸€ä¸ªå° demo æ¥ç†è§£ä¸€ä¸‹ä¸‹ã€‚</p></blockquote><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> foo = &#123; <span class="attr">name</span>: <span class="string">&#x27;foo&#x27;</span> &#125;;</span><br><span class="line"></span><br><span class="line">foo.<span class="property">fn</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// è¿™é‡Œçš„ this æŒ‡å‘äº† foo</span></span><br><span class="line">  <span class="comment">// å› ä¸º foo è°ƒç”¨äº† fnï¼Œ</span></span><br><span class="line">  <span class="comment">// fn çš„ this å°±æŒ‡å‘äº†è°ƒç”¨å®ƒæ‰€åœ¨æ–¹æ³•çš„å¯¹è±¡ foo ä¸Š</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>); <span class="comment">// foo</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>this</code>çš„è¿™ä¸ªç‰¹æ€§æ¥å®ç°call</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">myCall</span> = <span class="keyword">function</span> (<span class="params">thisArg, ...args</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">this</span> !== <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&#x27;Error&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">thisArg = thisArg || <span class="variable language_">window</span>;</span><br><span class="line"><span class="comment">// å°†è°ƒç”¨callå‡½æ•°çš„å¯¹è±¡æ·»åŠ åˆ°thisArgçš„å±æ€§ä¸­</span></span><br><span class="line">thisArg.<span class="property">fn</span> = <span class="variable language_">this</span>;</span><br><span class="line"><span class="keyword">const</span> result = thisArg.<span class="title function_">fn</span>(...args);</span><br><span class="line"><span class="keyword">delete</span> thisArg.<span class="property">fn</span>;</span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="Apply"><a href="#Apply" class="headerlink" title="Apply"></a>Apply</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">myApply</span> = <span class="keyword">function</span> (<span class="params">thisArg</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">this</span> !== <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&#x27;Error&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">thisArg = thisArg || <span class="variable language_">window</span>;</span><br><span class="line">thisArg.<span class="property">fn</span> = <span class="variable language_">this</span>;</span><br><span class="line"><span class="keyword">const</span> args = <span class="variable language_">arguments</span>[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">const</span> result = thisArg.<span class="title function_">fn</span>(...args);</span><br><span class="line"><span class="keyword">delete</span> thisArg.<span class="property">fn</span>;</span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="æµ‹è¯•-1"><a href="#æµ‹è¯•-1" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> bar = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">bar.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">name</span> = <span class="string">&#x27;bar&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> foo = &#123;</span><br><span class="line"><span class="attr">name</span>: <span class="string">&#x27;foo&#x27;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">bar.<span class="title function_">myCall</span>(foo, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>); <span class="comment">// foo [1, 2, 3]</span></span><br><span class="line">bar.<span class="title function_">myApply</span>(foo, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]); <span class="comment">// foo [1, 2, 3]</span></span><br></pre></td></tr></table></figure><p>å®Œ~<br><br><br>å‚è€ƒ</p><ul><li><a href="https://mp.weixin.qq.com/s/Qqh1H-2MUyVGoWjgOstQrg">å¹²è´§ï¼é˜¿é‡ŒP6æ‰‹å†™æºç é¢è¯•é¢˜é›†é”¦</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;åŒºåˆ«&quot;&gt;&lt;a href=&quot;#åŒºåˆ«&quot; class=&quot;headerlink&quot; title=&quot;åŒºåˆ«&quot;&gt;&lt;/a&gt;åŒºåˆ«&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;callã€applyã€bind&lt;/code&gt; æœ¬è´¨éƒ½æ˜¯æ”¹å˜ &lt;code&gt;this&lt;/code&gt; çš„æŒ‡å‘</summary>
      
    
    
    
    
    <category term="js" scheme="https://tauleos.github.io/tags/js/"/>
    
    <category term="æºç " scheme="https://tauleos.github.io/tags/%E6%BA%90%E7%A0%81/"/>
    
  </entry>
  
  <entry>
    <title>jsåŸºç¡€å¤¯å®-å½»åº•ææ‡‚thisçš„æŒ‡å‘é—®é¢˜</title>
    <link href="https://tauleos.github.io/a74d1e8039ab.html"/>
    <id>https://tauleos.github.io/a74d1e8039ab.html</id>
    <published>2019-04-12T01:28:57.000Z</published>
    <updated>2024-11-06T08:27:08.635Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>this å…³é”®å­—æ˜¯ JavaScript ä¸­æœ€å¤æ‚çš„æœºåˆ¶ä¹‹ä¸€ï¼Œæ˜¯ä¸€ä¸ªç‰¹åˆ«çš„å…³é”®å­—ï¼Œè¢«è‡ªåŠ¨å®šä¹‰åœ¨æ‰€æœ‰å‡½æ•°çš„ä½œç”¨åŸŸä¸­.</p></blockquote><span id="more"></span><h1 id="ä¸ºä»€ä¹ˆè¦ææ‡‚this"><a href="#ä¸ºä»€ä¹ˆè¦ææ‡‚this" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ææ‡‚this"></a>ä¸ºä»€ä¹ˆè¦ææ‡‚this</h1><ul><li>é¢å‘oopç¼–ç¨‹éœ€è¦çŸ¥é“ä»€ä¹ˆæ˜¯this</li><li>åœ¨å„ç§functionè°ƒç”¨è¿‡ç¨‹ä¸­å¯ä»¥æ¸…æ™°çš„å¼„æ‡‚ä¸ºä»€ä¹ˆã€‚</li><li>å¯ä»¥æ›´å¥½çš„ç†è§£å¤§å¸ˆä»¬çš„ä»£ç </li><li>é˜²æ­¢é¢è¯•è¢«å’”åš“ã€‚ã€‚ã€‚ï¼ˆè¡€çš„æ•™è®­ï¼‰</li></ul><h1 id="thisæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#thisæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="thisæ˜¯ä»€ä¹ˆï¼Ÿ"></a>thisæ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>é¡¾åæ€ä¹‰ï¼Œthiså°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œä½†æ˜¯ä»–å¹¶ä¸æ˜¯æŒ‡å‘è‡ªèº«ï¼<strong>è€Œæ˜¯æŒ‡å‘è°ƒç”¨å‡½æ•°çš„å¯¹è±¡</strong>ã€‚(è¿™å¥è¯å¾ˆé‡è¦ã€‚ä¹Ÿæ˜¯æœ¬ç¯‡æ–‡ç« è´¯ç©¿å§‹ç»ˆçš„ä¸»æ—¨ã€‚)</p><h1 id="thisçš„æŒ‡å‘åˆ¤å®šæ ‡å‡†"><a href="#thisçš„æŒ‡å‘åˆ¤å®šæ ‡å‡†" class="headerlink" title="thisçš„æŒ‡å‘åˆ¤å®šæ ‡å‡†"></a>thisçš„æŒ‡å‘åˆ¤å®šæ ‡å‡†</h1><h4 id="å‰äººçš„åˆ¤å®š"><a href="#å‰äººçš„åˆ¤å®š" class="headerlink" title="å‰äººçš„åˆ¤å®š"></a>å‰äººçš„åˆ¤å®š</h4><ol><li>å‡½æ•°æ˜¯å¦æ˜¯<code>new</code>è°ƒç”¨ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™æŒ‡å‘<code>new</code>åˆ›å»ºçš„å®ä¾‹ã€‚</li><li>å‡½æ•°æ˜¯å¦æ˜¯bindæ–¹æ³•è¿”å›çš„ï¼Ÿå¦‚æœæ˜¯ï¼Œåˆ™thisæŒ‡å‘æŒ‡å®šå¯¹è±¡ã€‚</li><li>å‡½æ•°æ˜¯å¦æ˜¯é€šè¿‡<code>apply/call</code>è°ƒç”¨çš„ï¼Ÿå¦‚æœæ˜¯ï¼Œåˆ™thisæŒ‡å‘æŒ‡å®šå¯¹è±¡ã€‚</li><li>æ˜¯å¦ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è°ƒç”¨ï¼Ÿ å¦‚æœæ˜¯ï¼Œåˆ™thisæŒ‡å‘è¯¥å¯¹è±¡ã€‚</li><li>thisæŒ‡å‘å…¨å±€ã€‚</li></ol><h4 id="ä¸ºä»€ä¹ˆè¿™æ ·åˆ¤å®šï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¿™æ ·åˆ¤å®šï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¿™æ ·åˆ¤å®šï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¿™æ ·åˆ¤å®šï¼Ÿ</h4><p>ä¸ºä»€ä¹ˆé€šè¿‡è¿™äº”ç§æ–¹å¼æ¥åˆ¤å®šå‘¢ï¼Ÿæˆ‘ä»¬é¦–å…ˆè¦çŸ¥é“thisçš„ç»‘å®šè§„åˆ™æœ‰å“ªäº›ï¼Ÿ</p><ul><li>é»˜è®¤ç»‘å®š</li><li>éšå¼ç»‘å®š</li><li>æ˜¾ç¤ºç»‘å®š</li><li>new ç»‘å®š</li></ul><p>ä¸‹é¢æˆ‘ä»¬æ¥åˆ†åˆ«æŒ¨ä¸ªè¯´æ˜æ¯ä¸ªè§„åˆ™ï¼Œæ¥éªŒè¯æˆ‘ä»¬ä¸Šè¿°çš„åˆ¤å®šæ ‡å‡†ã€‚</p><h2 id="é»˜è®¤ç»‘å®š"><a href="#é»˜è®¤ç»‘å®š" class="headerlink" title="é»˜è®¤ç»‘å®š"></a>é»˜è®¤ç»‘å®š</h2><p>åœ¨ä¸èƒ½åº”ç”¨å…¶ä»–ç»‘å®šè§„åˆ™æ—¶ä½¿ç”¨çš„é»˜è®¤è§„åˆ™ï¼Œé€šå¸¸æ˜¯ç‹¬ç«‹å‡½æ•°è°ƒç”¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getName</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Hello&#x27;</span>,<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> name = <span class="string">&#x27;mySelf&#x27;</span>;</span><br><span class="line"><span class="title function_">getName</span>()</span><br></pre></td></tr></table></figure><p>åœ¨è°ƒç”¨<code>getName</code>çš„æ—¶å€™,åº”ç”¨äº†é»˜è®¤ç»‘å®šï¼Œåœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹<code>this</code>æŒ‡å‘å…¨å±€å¯¹è±¡,ä¸¥æ ¼æ¨¡å¼ä¸‹<code>this</code>æ˜¯<code>undefined</code>,</p><ul><li>åœ¨æµè§ˆå™¨æ¨¡å¼ä¸‹<code>this</code>æŒ‡å‘äº†å…¨å±€å¯¹è±¡<code>window</code>,æ‰€ä»¥è¿è¡Œç»“æœæ˜¯<code>HellomySelf</code></li><li>åœ¨nodeç¯å¢ƒä¸‹<code>this</code>æŒ‡å‘çš„å…¨å±€å¯¹è±¡æ˜¯<code>node-runtime</code></li></ul><blockquote><p>åœ¨è¯¥æ–‡ç« ä¸­æˆ‘ä»¬ä¸»è¦è®¨è®ºæµè§ˆå™¨ä¸­çš„è¡¨ç°ã€‚</p></blockquote><h2 id="éšå¼ç»‘å®š"><a href="#éšå¼ç»‘å®š" class="headerlink" title="éšå¼ç»‘å®š"></a>éšå¼ç»‘å®š</h2><p>å‡½æ•°çš„è°ƒç”¨å­˜åœ¨ä¸Šä¸‹æ–‡å…³ç³»,å…¸å‹æ¡ˆä¾‹å¦‚abc.foo():</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    <span class="attr">tag</span>: <span class="string">&#x27;a&#x27;</span>,</span><br><span class="line">    <span class="attr">func</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">tag</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> tag = <span class="string">&#x27;b&#x27;</span>;</span><br><span class="line">obj.<span class="title function_">func</span>();</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœæ˜¯<code>a</code>ï¼›é‚£å¦‚æœæˆ‘æŠŠsayHiçš„å®šä¹‰æå‡åˆ°å¤–è¾¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">h</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">tag</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    <span class="attr">tag</span>: <span class="string">&#x27;obj&#x27;</span>,</span><br><span class="line">    <span class="attr">func</span>: h</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> tag = <span class="string">&#x27;window&#x27;</span>;</span><br><span class="line">obj.<span class="title function_">func</span>();</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœè·Ÿä¸Šé¢æ˜¯ä¸€æ ·çš„ã€‚è¿™æ˜¯å› ä¸ºåœ¨å‡½æ•°<code>sayHi</code>è°ƒç”¨çš„æ—¶å€™,æ­¤æ—¶çš„ä¸Šä¸‹æ–‡å¯¹è±¡å±äº<code>person</code>,<strong>éšå¼ç»‘å®šä¼šå°†å‡½æ•°ä¸­çš„<code>this</code>ç»‘å®šåˆ°<code>person</code>è¿™ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ä¸Š</strong></p><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šåœ¨åµŒå¥—å¯¹è±¡çš„è°ƒç”¨æ—¶ï¼Œåªæœ‰ç¦»<code>this</code>æœ€è¿‘çš„é‚£ä¸€å±‚ä¼šå½±å“åˆ°è°ƒç”¨ä½ç½®ã€‚</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">h</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">tag</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">    <span class="attr">tag</span>: <span class="string">&#x27;obj1&#x27;</span>,</span><br><span class="line">    <span class="attr">func</span>: h</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj2 = &#123;</span><br><span class="line">  <span class="attr">tag</span>:<span class="string">&#x27;obj2&#x27;</span>,</span><br><span class="line">  <span class="attr">obj</span>:obj1</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> tag = <span class="string">&#x27;window&#x27;</span>;</span><br><span class="line">obj2.<span class="property">obj</span>.<span class="title function_">func</span>();</span><br></pre></td></tr></table></figure><p>ç»“æœæ˜¯<code>obj1</code>,è¿™æ˜¯å› ä¸ºåªæœ‰æ‰§è¡Œåˆ°<code>obj1.func</code>çš„æ—¶å€™ï¼Œæ‰èƒ½ç¡®å®šå‡½æ•°<code>h</code>ä¸­<code>this</code>æŒ‡å‘çš„ä¸Šä¸‹æ–‡å¯¹è±¡ä¸º<code>obj1</code>.</p><div class="tip">    éšå¼ç»‘å®šæœ‰ä¸€ä¸ªå¾ˆå¤§çš„å‘ï¼Œå°±æ˜¯ä¼šä¸¢å¤±ç»‘å®šã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä»¥ä¸ºçš„thisæŒ‡å‘ï¼Œå…¶å®å¹¶ä¸æ˜¯thisçœŸæ­£çš„æŒ‡å‘ï¼ˆæˆ‘ä»¬ä»¥ä¸ºä»–æ˜¯é›·é”‹ï¼Œä½†æ˜¯ä»–å´æ˜¯é›·å³°å¡”ï¼‰</div><p>éšå¼ç»‘å®šçš„ä¸¢å¤±ä¸»è¦ä½“ç°åœ¨ä¸¤ä¸ªæ–¹é¢:</p><ol><li>å‡½æ•°é‡æ–°èµ‹å€¼,å¦‚ä¸‹é¢ä»£ç æ‰€ç¤º:<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">h</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">tag</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">  <span class="attr">tag</span>:<span class="string">&#x27;obj1&#x27;</span>,</span><br><span class="line">  <span class="attr">func</span>:h</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> tag = <span class="string">&#x27;window&#x27;</span></span><br><span class="line"><span class="keyword">var</span> callh = obj1.<span class="property">func</span>;</span><br><span class="line"><span class="title function_">callh</span>(); <span class="comment">//window</span></span><br></pre></td></tr></table></figure></li></ol><p> <strong>è¿™æ˜¯å› ä¸º<code>callh</code>ç›´æ¥æŒ‡å‘äº†å‡½æ•°<code>h</code>çš„å¼•ç”¨ï¼Œåœ¨æ‰§è¡Œ<code>callh</code>çš„æ—¶å€™ä¸Šä¸‹æ–‡å¯¹è±¡ä¸º<code>document.window</code></strong></p><ol start="2"><li>åœ¨å›æ‰å‡½æ•°å’Œäº‹ä»¶å›è°ƒä¸­ä¹Ÿä¼šä¸¢å¤±ç»‘å®š,å¦‚ä¸‹ä»£ç æ‰€ç¤º<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">h</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">tag</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">  <span class="attr">tag</span>:<span class="string">&#x27;obj1&#x27;</span>,</span><br><span class="line">  <span class="attr">func</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">tag</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj2 = &#123;</span><br><span class="line">  <span class="attr">tag</span>:<span class="string">&#x27;obj2&#x27;</span>,</span><br><span class="line">  <span class="attr">func</span>:h</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> tag = <span class="string">&#x27;window&#x27;</span></span><br><span class="line">obj1.<span class="title function_">func</span>(); <span class="comment">// window</span></span><br><span class="line"><span class="built_in">setTimeout</span>(obj2.<span class="property">func</span>,<span class="number">200</span>); <span class="comment">// window</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123; </span><br><span class="line">  obj2.<span class="title function_">func</span>()</span><br><span class="line">&#125;,<span class="number">200</span>)           <span class="comment">//obj2</span></span><br></pre></td></tr></table></figure></li></ol><ul><li>ç¬¬ä¸€ä¸ªè¾“å‡ºæ˜¯å› ä¸ºå‘½ä¸­äº†é»˜è®¤ç»‘å®š,<code>this</code>æŒ‡å‘äº†<code>document.window</code></li><li>ç¬¬äºŒä¸ªè¾“å‡ºæ˜¯å› ä¸º<code>obj2.func</code>èµ‹å€¼ç»™äº†<code>setTimeout</code>çš„å›è°ƒå…¥å‚ä¹‹ååˆæ‰§è¡Œè¿™ä¸ªå…¥å‚ï¼Œæ‰€ä»¥éšå¼ç»‘å®šä¸¢å¤±ï¼Œ<code>this</code>æŒ‡å‘äº†<code>document.window</code></li><li>ç¬¬ä¸‰æ¡è¾“å‡ºæ˜¯å› ä¸ºå‘½ä¸­äº†éšå¼ç»‘å®šï¼Œ<code>this</code>æŒ‡å‘äº†<code>obj2</code></li></ul><h2 id="æ˜¾å¼ç»‘å®š"><a href="#æ˜¾å¼ç»‘å®š" class="headerlink" title="æ˜¾å¼ç»‘å®š"></a>æ˜¾å¼ç»‘å®š</h2><p>é€šè¿‡ <code>call,apply,bind</code> çš„æ–¹å¼ï¼Œæ˜¾å¼çš„æŒ‡å®š<code>this</code>æ‰€æŒ‡å‘çš„å¯¹è±¡ã€‚<code>call,apply,bind</code>çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå°±æ˜¯å¯¹åº”å‡½æ•°çš„<code>this</code>æ‰€æŒ‡å‘çš„å¯¹è±¡ã€‚<code>call</code>å’Œ<code>apply</code>çš„ä½œç”¨ä¸€æ ·ï¼Œåªæ˜¯ä¼ å‚æ–¹å¼ä¸åŒã€‚<code>call</code>å’Œ<code>apply</code>éƒ½ä¼šæ‰§è¡Œå¯¹åº”çš„å‡½æ•°ï¼Œè€Œ<code>bind</code>æ–¹æ³•ä¸ä¼šã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">h</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">tag</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">    <span class="attr">tag</span>: <span class="string">&#x27;obj1&#x27;</span>,</span><br><span class="line">    <span class="attr">func</span>: h</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> tag = <span class="string">&#x27;window&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> h2 = <span class="keyword">function</span>(<span class="params">func</span>)&#123;</span><br><span class="line">  <span class="title function_">func</span>()</span><br><span class="line">&#125;</span><br><span class="line">h2.<span class="title function_">call</span>(obj1,obj1.<span class="property">func</span>)   <span class="comment">//window</span></span><br></pre></td></tr></table></figure><p><strong>å› ä¸º<code>obj1.func</code>ä½œä¸ºå…¥å‚ä¼ å…¥çš„æ—¶å€™,å·²ç»ä¸¢å¤±äº†éšå¼ç»‘å®šçš„<code>this</code></strong></p><h2 id="newå…³é”®å­—ç»‘å®š"><a href="#newå…³é”®å­—ç»‘å®š" class="headerlink" title="newå…³é”®å­—ç»‘å®š"></a><code>new</code>å…³é”®å­—ç»‘å®š</h2><p>ä½¿ç”¨<code>new</code>æ¥è°ƒç”¨å‡½æ•°ï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œä¸‹é¢çš„æ“ä½œï¼š</p><ol><li>åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡</li><li>å°†æ„é€ å‡½æ•°çš„ä½œç”¨åŸŸèµ‹å€¼ç»™æ–°å¯¹è±¡ï¼Œå³<code>this</code>æŒ‡å‘è¿™ä¸ªæ–°å¯¹è±¡</li><li>æ‰§è¡Œæ„é€ å‡½æ•°ä¸­çš„ä»£ç </li><li>è¿”å›æ–°å¯¹è±¡</li></ol><h1 id="ç»‘å®šä¼˜å…ˆçº§"><a href="#ç»‘å®šä¼˜å…ˆçº§" class="headerlink" title="ç»‘å®šä¼˜å…ˆçº§"></a>ç»‘å®šä¼˜å…ˆçº§</h1><blockquote><p>new ç»‘å®š &gt; æ˜¾å¼ç»‘å®š &gt; éšå¼ç»‘å®š &gt; é»˜è®¤ç»‘å®š</p></blockquote><h1 id="ç»‘å®šä¾‹å¤–"><a href="#ç»‘å®šä¾‹å¤–" class="headerlink" title="ç»‘å®šä¾‹å¤–"></a>ç»‘å®šä¾‹å¤–</h1><p>å¦‚æœæˆ‘ä»¬å°†<code>null</code>æˆ–è€…æ˜¯<code>undefined</code>ä½œä¸º<code>this</code>çš„ç»‘å®šå¯¹è±¡ä¼ å…¥<code>callã€applyã€bind</code>, è¿™äº›å€¼åœ¨è°ƒç”¨æ—¶ä¼šè¢«å¿½ç•¥ï¼Œå®é™…åº”ç”¨çš„æ˜¯é»˜è®¤ç»‘å®šè§„åˆ™ã€‚</p><h1 id="ç®­å¤´å‡½æ•°"><a href="#ç®­å¤´å‡½æ•°" class="headerlink" title="ç®­å¤´å‡½æ•°"></a>ç®­å¤´å‡½æ•°</h1><p>ç®­å¤´å‡½æ•°æ˜¯ ES6 ä¸­æ–°å¢çš„ï¼Œå®ƒå’Œæ™®é€šå‡½æ•°æœ‰ä¸€äº›åŒºåˆ«ï¼Œç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ thisï¼Œå®ƒçš„ this ç»§æ‰¿äºå¤–å±‚ä»£ç åº“ä¸­çš„ thisã€‚ç®­å¤´å‡½æ•°åœ¨ä½¿ç”¨æ—¶ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹:</p><ul><li>å‡½æ•°ä½“å†…çš„ this å¯¹è±¡ï¼Œç»§æ‰¿çš„æ˜¯å¤–å±‚ä»£ç å—çš„ thisã€‚</li><li>ä¸å¯ä»¥å½“ä½œæ„é€ å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å¯ä»¥ä½¿ç”¨ new å‘½ä»¤ï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</li><li>ä¸å¯ä»¥ä½¿ç”¨ arguments å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨å‡½æ•°ä½“å†…ä¸å­˜åœ¨ã€‚å¦‚æœè¦ç”¨ï¼Œå¯ä»¥ç”¨ rest å‚æ•°ä»£æ›¿ã€‚</li><li>ä¸å¯ä»¥ä½¿ç”¨ yield å‘½ä»¤ï¼Œå› æ­¤ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œ Generator å‡½æ•°ã€‚</li><li>ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ thisï¼Œæ‰€ä»¥ä¸èƒ½ç”¨ call()ã€apply()ã€bind() è¿™äº›æ–¹æ³•å»æ”¹å˜ this çš„æŒ‡å‘.</li></ul><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>1 . å‡½æ•°æ˜¯å¦åœ¨ new ä¸­è°ƒç”¨ (new ç»‘å®š)ï¼Œå¦‚æœæ˜¯ï¼Œé‚£ä¹ˆ this ç»‘å®šçš„æ˜¯æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚<br>2 . å‡½æ•°æ˜¯å¦é€šè¿‡ call,apply è°ƒç”¨ï¼Œæˆ–è€…ä½¿ç”¨äº† bind(å³ç¡¬ç»‘å®š)ï¼Œå¦‚æœæ˜¯ï¼Œé‚£ä¹ˆ this ç»‘å®šçš„å°±æ˜¯æŒ‡å®šçš„å¯¹è±¡ã€‚<br>3 . å‡½æ•°æ˜¯å¦åœ¨æŸä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ä¸­è°ƒç”¨ (éšå¼ç»‘å®š)ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œthis ç»‘å®šçš„æ˜¯é‚£ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ã€‚ä¸€èˆ¬æ˜¯ obj.foo()ã€‚<br>4 . å¦‚æœä»¥ä¸Šéƒ½ä¸æ˜¯ï¼Œé‚£ä¹ˆä½¿ç”¨é»˜è®¤ç»‘å®šã€‚å¦‚æœåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œåˆ™ç»‘å®šåˆ° undefinedï¼Œå¦åˆ™ç»‘å®šåˆ°å…¨å±€å¯¹è±¡ã€‚<br>5 . å¦‚æœæŠŠ Null æˆ–è€… undefined ä½œä¸º this çš„ç»‘å®šå¯¹è±¡ä¼ å…¥ callã€apply æˆ–è€… bindï¼Œè¿™äº›å€¼åœ¨è°ƒç”¨æ—¶ä¼šè¢«å¿½ç•¥ï¼Œå®é™…åº”ç”¨çš„æ˜¯é»˜è®¤ç»‘å®šè§„åˆ™ã€‚<br>6 . å¦‚æœæ˜¯ç®­å¤´å‡½æ•°ï¼Œç®­å¤´å‡½æ•°çš„ this ç»§æ‰¿çš„æ˜¯å¤–å±‚ä»£ç å—çš„ thisã€‚</p><p>å‚è€ƒ</p><ul><li><a href="https://juejin.im/post/5c96d0c751882511c832ff7b">å—¨ï¼Œä½ çœŸçš„æ‡‚thiså—ï¼Ÿ</a></li><li><a href="http://www.ruanyifeng.com/blog/2010/04/using_this_keyword_in_javascript.html">Javascript çš„ this ç”¨æ³•</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;this å…³é”®å­—æ˜¯ JavaScript ä¸­æœ€å¤æ‚çš„æœºåˆ¶ä¹‹ä¸€ï¼Œæ˜¯ä¸€ä¸ªç‰¹åˆ«çš„å…³é”®å­—ï¼Œè¢«è‡ªåŠ¨å®šä¹‰åœ¨æ‰€æœ‰å‡½æ•°çš„ä½œç”¨åŸŸä¸­.&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    
    <category term="js" scheme="https://tauleos.github.io/tags/js/"/>
    
    <category term="ç†è®º" scheme="https://tauleos.github.io/tags/%E7%90%86%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title>mac-v10.9.5å®‰è£…nginx</title>
    <link href="https://tauleos.github.io/abff08f12a22.html"/>
    <id>https://tauleos.github.io/abff08f12a22.html</id>
    <published>2019-03-25T11:04:45.000Z</published>
    <updated>2024-11-06T08:27:08.636Z</updated>
    
    
    
    
    
    <category term="mac" scheme="https://tauleos.github.io/tags/mac/"/>
    
    <category term="nginx" scheme="https://tauleos.github.io/tags/nginx/"/>
    
  </entry>
  
  <entry>
    <title>å®‰è£…redis</title>
    <link href="https://tauleos.github.io/5d3c72d7cf56.html"/>
    <id>https://tauleos.github.io/5d3c72d7cf56.html</id>
    <published>2019-03-24T16:00:00.000Z</published>
    <updated>2024-11-06T08:27:08.636Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å®‰è£…redis"><a href="#å®‰è£…redis" class="headerlink" title="å®‰è£…redis"></a>å®‰è£…redis</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">wget http://redis.googlecode.com/files/redis-2.6.14.tar.gz</span><br><span class="line">tar -zxvf redis-2.6.14.tar.gz</span><br><span class="line"><span class="built_in">cd</span> redis-2.6.14</span><br><span class="line">make</span><br><span class="line">make PREFIX=/usr/local/redis install</span><br></pre></td></tr></table></figure><span id="more"></span><h3 id="è®¾ç½®redisè‡ªå¯åŠ¨"><a href="#è®¾ç½®redisè‡ªå¯åŠ¨" class="headerlink" title="è®¾ç½®redisè‡ªå¯åŠ¨"></a>è®¾ç½®redisè‡ªå¯åŠ¨</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /usr/local/redis/&#123;etc,var&#125;</span><br><span class="line"><span class="built_in">cp</span> redis.conf /usr/local/redis/etc/</span><br></pre></td></tr></table></figure><h3 id="æ”¹é…ç½®"><a href="#æ”¹é…ç½®" class="headerlink" title="æ”¹é…ç½®"></a>æ”¹é…ç½®</h3><figure class="highlight zsh"><table><tr><td class="code"><pre><span class="line">nano /etc/rc.local</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨æœ€åä¸€è¡ŒåŠ å…¥</p></blockquote><figure class="highlight console"><table><tr><td class="code"><pre><span class="line">./usr/local/redis/bin/redis-server /usr/local/redis/etc/redis.conf</span><br><span class="line">nano /usr/local/redis/etc/redis.conf #ä¿®æ”¹redis-confé…ç½®æ–‡ä»¶</span><br><span class="line">port 10087 #è®¾ç½®ç«¯å£ä¸º10087</span><br><span class="line">requirepass ehncf2000  #è®¾ç½®è®¿é—®å¯†ç </span><br><span class="line">daemonize yes #ä¿®æ”¹åå°è¿è¡Œ</span><br><span class="line">timeout 300   #è¯·æ±‚è¶…æ—¶æ—¶é—´</span><br><span class="line">loglevel debug #logä¿¡æ¯çº§åˆ«</span><br><span class="line">dbfilename dump.rdb #æ•°æ®æ–‡ä»¶</span><br><span class="line">dir /usr/local/redis/etc/ #æ•°æ®æ–‡ä»¶ç›®å½•</span><br></pre></td></tr></table></figure><h3 id="åŠ ç¯å¢ƒå˜é‡"><a href="#åŠ ç¯å¢ƒå˜é‡" class="headerlink" title="åŠ ç¯å¢ƒå˜é‡"></a>åŠ ç¯å¢ƒå˜é‡</h3><figure class="highlight console"><table><tr><td class="code"><pre><span class="line">nano /etc/environment</span><br><span class="line">/usr/local/redis/bin/redis-server</span><br><span class="line">/usr/local/redis/bin/redis-benchmark</span><br><span class="line">/usr/local/redis/bin/redis-cli</span><br></pre></td></tr></table></figure><h3 id="å¯åŠ¨redis"><a href="#å¯åŠ¨redis" class="headerlink" title="å¯åŠ¨redis"></a>å¯åŠ¨redis</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">/usr/local/redis/bin/redis-server /usr/local/redis/etc/redis.conf</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;å®‰è£…redis&quot;&gt;&lt;a href=&quot;#å®‰è£…redis&quot; class=&quot;headerlink&quot; title=&quot;å®‰è£…redis&quot;&gt;&lt;/a&gt;å®‰è£…redis&lt;/h3&gt;&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;wget http://redis.googlecode.com/files/redis-2.6.14.tar.gz&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tar -zxvf redis-2.6.14.tar.gz&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; redis-2.6.14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;make&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;make PREFIX=/usr/local/redis install&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    
    <category term="linux" scheme="https://tauleos.github.io/tags/linux/"/>
    
    <category term="redis" scheme="https://tauleos.github.io/tags/redis/"/>
    
  </entry>
  
  <entry>
    <title>kafkaå®‰è£…æ•™ç¨‹</title>
    <link href="https://tauleos.github.io/9151c631d8a6.html"/>
    <id>https://tauleos.github.io/9151c631d8a6.html</id>
    <published>2019-01-25T11:09:48.000Z</published>
    <updated>2024-11-06T08:27:08.636Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>Kafkaæ˜¯æœ€åˆç”±Linkedinå…¬å¸å¼€å‘ï¼Œæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ã€åˆ†åŒºçš„ã€å¤šå‰¯æœ¬çš„ã€å¤šè®¢é˜…è€…ï¼ŒåŸºäºzookeeperåè°ƒçš„åˆ†å¸ƒå¼æ—¥å¿—ç³»ç»Ÿï¼ˆä¹Ÿå¯ä»¥å½“åšMQç³»ç»Ÿï¼‰ï¼Œå¸¸è§å¯ä»¥ç”¨äºweb/nginxæ—¥å¿—ã€è®¿é—®æ—¥å¿—ï¼Œæ¶ˆæ¯æœåŠ¡ç­‰ç­‰ï¼ŒLinkedinäº2010å¹´è´¡çŒ®ç»™äº†ApacheåŸºé‡‘ä¼šå¹¶æˆä¸ºé¡¶çº§å¼€æºé¡¹ç›®ã€‚<br><br><br>å…¶ä¸»è¦åº”ç”¨åœºæ™¯æ˜¯ï¼šæ—¥å¿—æ”¶é›†ç³»ç»Ÿå’Œæ¶ˆæ¯ç³»ç»Ÿã€‚</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><h3 id="1ã€å®‰è£…JDK-1-8-0"><a href="#1ã€å®‰è£…JDK-1-8-0" class="headerlink" title="1ã€å®‰è£…JDK 1.8.0"></a>1ã€å®‰è£…JDK 1.8.0</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">rpm -jvh jdk-8u101-linux-x64.rpm</span><br><span class="line"><span class="comment">#éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ</span></span><br><span class="line">java -version</span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment"># java version &quot;1.8.0_101&quot;</span></span><br></pre></td></tr></table></figure><h3 id="2ã€å®‰è£…zookeeper"><a href="#2ã€å®‰è£…zookeeper" class="headerlink" title="2ã€å®‰è£…zookeeper"></a>2ã€å®‰è£…zookeeper</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">tar -zxvf zookeeper-3.4.8.tar.gz</span><br><span class="line"><span class="built_in">cd</span> zookeeper-3.4.8/conf</span><br><span class="line"><span class="built_in">mv</span> zoo_sample.cfg zoo.cfg</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">./bin/zkServer.sh start</span><br><span class="line"><span class="comment"># å¼€å¯åå¯ä»¥ç”¨ä¸‹é¢å‘½ä»¤æ£€æµ‹æ˜¯å¦è¿è¡ŒæˆåŠŸ</span></span><br><span class="line">ps aux |grep zookeeper</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3ã€å®‰è£…kafka"><a href="#3ã€å®‰è£…kafka" class="headerlink" title="3ã€å®‰è£…kafka"></a>3ã€å®‰è£…kafka</h3><h4 id="1ã€è¿è¡Œkafka"><a href="#1ã€è¿è¡Œkafka" class="headerlink" title="1ã€è¿è¡Œkafka"></a>1ã€è¿è¡Œkafka</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">tar -zxvf kafka.tgz</span><br><span class="line"><span class="built_in">cd</span> /opt/kafka/bin</span><br><span class="line"><span class="built_in">nohup</span> ./kafka-server-start.sh /opt/kafka/config/server.properties &amp;</span><br></pre></td></tr></table></figure><h4 id="2ã€åˆ›å»ºtopic"><a href="#2ã€åˆ›å»ºtopic" class="headerlink" title="2ã€åˆ›å»ºtopic"></a>2ã€åˆ›å»ºtopic</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic data-test</span><br><span class="line"><span class="comment"># åˆ›å»ºæˆåŠŸæ§åˆ¶å°ä¼šæ˜¾ç¤ºï¼š</span></span><br><span class="line"><span class="comment"># Created topic &quot;data-test&quot;.</span></span><br><span class="line"><span class="built_in">cd</span> bin/</span><br><span class="line"><span class="comment"># æŸ¥çœ‹topicåˆ—è¡¨</span></span><br><span class="line">./kafka-topics.sh --list --zookeeper localhost:2181</span><br></pre></td></tr></table></figure><h3 id="4ã€æµ‹è¯•"><a href="#4ã€æµ‹è¯•" class="headerlink" title="4ã€æµ‹è¯•"></a>4ã€æµ‹è¯•</h3><h4 id="ç”Ÿäº§æ¶ˆæ¯"><a href="#ç”Ÿäº§æ¶ˆæ¯" class="headerlink" title="ç”Ÿäº§æ¶ˆæ¯"></a>ç”Ÿäº§æ¶ˆæ¯</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">./kafka-console-producer.sh --broker-list localhost:9092 --topic <span class="built_in">test</span> Kafka <span class="built_in">test</span>!    </span><br><span class="line"><span class="comment"># è¿™é‡Œçš„â€œKafka test!â€ä¸ºæ‰‹åŠ¨è¾“å…¥çš„ï¼Œè¾“å…¥åâ€œctrl +câ€é€€å‡ºï¼›</span></span><br></pre></td></tr></table></figure><h4 id="æ¶ˆè´¹æ¶ˆæ¯"><a href="#æ¶ˆè´¹æ¶ˆæ¯" class="headerlink" title="æ¶ˆè´¹æ¶ˆæ¯"></a>æ¶ˆè´¹æ¶ˆæ¯</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">./kafka-console-consumer.sh --zookeeper localhost:2181 --topic <span class="built_in">test</span> --from-beginning I<span class="string">&#x27;m laoyang  </span></span><br><span class="line"><span class="string"># ä¹‹å‰æµ‹è¯•è¾“å…¥çš„å†…å®¹ kafka test!</span></span><br></pre></td></tr></table></figure><br><p>å®Œ~</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ä»‹ç»&quot;&gt;&lt;a href=&quot;#ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;ä»‹ç»&quot;&gt;&lt;/a&gt;ä»‹ç»&lt;/h2&gt;&lt;p&gt;Kafkaæ˜¯æœ€åˆç”±Linkedinå…¬å¸å¼€å‘ï¼Œæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ã€åˆ†åŒºçš„ã€å¤šå‰¯æœ¬çš„ã€å¤šè®¢é˜…è€…ï¼ŒåŸºäºzookeeperåè°ƒçš„åˆ†å¸ƒå¼æ—¥å¿—ç³»ç»Ÿï¼ˆä¹Ÿå¯ä»¥å½“åš</summary>
      
    
    
    
    
    <category term="linux" scheme="https://tauleos.github.io/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>æ¯æ—¥ä¸€æ¡linuxå‘½ä»¤ä¹‹ln</title>
    <link href="https://tauleos.github.io/c60b11b049f3.html"/>
    <id>https://tauleos.github.io/c60b11b049f3.html</id>
    <published>2018-08-04T08:43:17.000Z</published>
    <updated>2024-11-06T08:27:08.637Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>lnæ˜¯linuxä¸­åˆä¸€ä¸ªéå¸¸é‡è¦å‘½ä»¤ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯ä¸ºæŸä¸€ä¸ªæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥.å½“æˆ‘ä»¬éœ€è¦åœ¨ä¸åŒçš„ç›®å½•ï¼Œç”¨åˆ°ç›¸åŒçš„æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦åœ¨æ¯ä¸€ä¸ªéœ€è¦çš„ç›®å½•ä¸‹éƒ½æ”¾ä¸€ä¸ªå¿…é¡»ç›¸åŒçš„æ–‡ä»¶ï¼Œæˆ‘ä»¬åªè¦åœ¨æŸä¸ªå›ºå®šçš„ç›®å½•ï¼Œæ”¾ä¸Šè¯¥æ–‡ä»¶ï¼Œç„¶ååœ¨ å…¶å®ƒçš„ç›®å½•ä¸‹ç”¨lnå‘½ä»¤é“¾æ¥ï¼ˆlinkï¼‰å®ƒå°±å¯ä»¥ï¼Œä¸å¿…é‡å¤çš„å ç”¨ç£ç›˜ç©ºé—´ã€‚</p><span id="more"></span><h3 id="å‘½ä»¤æ ¼å¼"><a href="#å‘½ä»¤æ ¼å¼" class="headerlink" title="å‘½ä»¤æ ¼å¼"></a>å‘½ä»¤æ ¼å¼</h3><blockquote><p>ln [å‚æ•°][æºæ–‡ä»¶æˆ–ç›®å½•][ç›®æ ‡æ–‡ä»¶æˆ–ç›®å½•]</p></blockquote><h3 id="å‘½ä»¤åŠŸèƒ½"><a href="#å‘½ä»¤åŠŸèƒ½" class="headerlink" title="å‘½ä»¤åŠŸèƒ½"></a>å‘½ä»¤åŠŸèƒ½</h3><p>Linuxæ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæœ‰æ‰€è°“çš„é“¾æ¥(link)ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶è§†ä¸ºæ¡£æ¡ˆçš„åˆ«åï¼Œè€Œé“¾æ¥åˆå¯åˆ†ä¸ºä¸¤ç§ : ç¡¬é“¾æ¥(hard link)ä¸è½¯é“¾æ¥(symbolic link)ï¼Œç¡¬é“¾æ¥çš„æ„æ€æ˜¯ä¸€ä¸ªæ¡£æ¡ˆå¯ä»¥æœ‰å¤šä¸ªåç§°ï¼Œè€Œè½¯é“¾æ¥çš„æ–¹å¼åˆ™æ˜¯äº§ç”Ÿä¸€ä¸ªç‰¹æ®Šçš„æ¡£æ¡ˆï¼Œè¯¥æ¡£æ¡ˆçš„å†…å®¹æ˜¯æŒ‡å‘å¦ä¸€ä¸ªæ¡£æ¡ˆçš„ä½ç½®ã€‚ç¡¬é“¾æ¥æ˜¯å­˜åœ¨åŒä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œè€Œè½¯é“¾æ¥å´å¯ä»¥è·¨è¶Šä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿã€‚</p><h4 id="è½¯é“¾æ¥"><a href="#è½¯é“¾æ¥" class="headerlink" title="è½¯é“¾æ¥"></a>è½¯é“¾æ¥</h4><ul><li>è½¯é“¾æ¥ï¼Œä»¥è·¯å¾„çš„å½¢å¼å­˜åœ¨ã€‚ç±»ä¼¼äºWindowsæ“ä½œç³»ç»Ÿä¸­çš„å¿«æ·æ–¹å¼</li><li>è½¯é“¾æ¥å¯ä»¥ è·¨æ–‡ä»¶ç³»ç»Ÿ ï¼Œç¡¬é“¾æ¥ä¸å¯ä»¥</li><li>è½¯é“¾æ¥å¯ä»¥å¯¹ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶åè¿›è¡Œé“¾æ¥</li><li>è½¯é“¾æ¥å¯ä»¥å¯¹ç›®å½•è¿›è¡Œé“¾æ¥</li></ul><h4 id="ç¡¬é“¾æ¥"><a href="#ç¡¬é“¾æ¥" class="headerlink" title="ç¡¬é“¾æ¥"></a>ç¡¬é“¾æ¥</h4><ul><li>ç¡¬é“¾æ¥ï¼Œä»¥æ–‡ä»¶å‰¯æœ¬çš„å½¢å¼å­˜åœ¨ã€‚ä½†ä¸å ç”¨å®é™…ç©ºé—´</li><li>ä¸å…è®¸ç»™ç›®å½•åˆ›å»ºç¡¬é“¾æ¥</li><li>ç¡¬é“¾æ¥åªæœ‰åœ¨åŒä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­æ‰èƒ½åˆ›å»º</li></ul><p><strong>è¿™é‡Œæœ‰ä¸¤ç‚¹è¦æ³¨æ„ï¼š</strong></p><ul><li>lnå‘½ä»¤ä¼šä¿æŒæ¯ä¸€å¤„é“¾æ¥æ–‡ä»¶çš„åŒæ­¥æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸è®ºä½ æ”¹åŠ¨äº†å“ªä¸€å¤„ï¼Œå…¶å®ƒçš„æ–‡ä»¶éƒ½ä¼šå‘ç”Ÿç›¸åŒçš„å˜åŒ–</li><li>lnçš„é“¾æ¥åˆåˆ†è½¯é“¾æ¥å’Œç¡¬é“¾æ¥ä¸¤ç§ï¼Œè½¯é“¾æ¥å°±æ˜¯ln â€“s æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶ï¼Œå®ƒåªä¼šåœ¨ä½ é€‰å®šçš„ä½ç½®ä¸Šç”Ÿæˆä¸€ä¸ªæ–‡ä»¶çš„é•œåƒï¼Œä¸ä¼šå ç”¨ç£ç›˜ç©ºé—´ï¼Œç¡¬é“¾æ¥ ln æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶ï¼Œæ²¡æœ‰å‚æ•°-sï¼Œ å®ƒä¼šåœ¨ä½ é€‰å®šçš„ä½ç½®ä¸Šç”Ÿæˆä¸€ä¸ªå’Œæºæ–‡ä»¶å¤§å°ç›¸åŒçš„æ–‡ä»¶ï¼Œæ— è®ºæ˜¯è½¯é“¾æ¥è¿˜æ˜¯ç¡¬é“¾æ¥ï¼Œæ–‡ä»¶éƒ½ä¿æŒåŒæ­¥å˜åŒ–ã€‚</li></ul><p>lnæŒ‡ä»¤ç”¨åœ¨é“¾æ¥æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¦‚åŒæ—¶æŒ‡å®šä¸¤ä¸ªä»¥ä¸Šçš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œä¸”æœ€åçš„ç›®çš„åœ°æ˜¯ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ç›®å½•ï¼Œåˆ™ä¼šæŠŠå‰é¢æŒ‡å®šçš„æ‰€æœ‰æ–‡ä»¶æˆ–ç›®å½•å¤åˆ¶åˆ°è¯¥ç›®å½•ä¸­ã€‚è‹¥åŒæ—¶æŒ‡å®šå¤šä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œä¸”æœ€åçš„ç›®çš„åœ°å¹¶éæ˜¯ä¸€ä¸ªå·²å­˜åœ¨çš„ç›®å½•ï¼Œåˆ™ä¼šå‡ºç°é”™è¯¯ä¿¡æ¯ã€‚</p><h3 id="å‘½ä»¤å‚æ•°"><a href="#å‘½ä»¤å‚æ•°" class="headerlink" title="å‘½ä»¤å‚æ•°"></a>å‘½ä»¤å‚æ•°</h3><p>å¿…è¦å‚æ•°:</p><p>-b åˆ é™¤ï¼Œè¦†ç›–ä»¥å‰å»ºç«‹çš„é“¾æ¥</p><p>-d å…è®¸è¶…çº§ç”¨æˆ·åˆ¶ä½œç›®å½•çš„ç¡¬é“¾æ¥</p><p>-f å¼ºåˆ¶æ‰§è¡Œ</p><p>-i äº¤äº’æ¨¡å¼ï¼Œæ–‡ä»¶å­˜åœ¨åˆ™æç¤ºç”¨æˆ·æ˜¯å¦è¦†ç›–</p><p>-n æŠŠç¬¦å·é“¾æ¥è§†ä¸ºä¸€èˆ¬ç›®å½•</p><p>-s è½¯é“¾æ¥(ç¬¦å·é“¾æ¥)</p><p>-v æ˜¾ç¤ºè¯¦ç»†çš„å¤„ç†è¿‡ç¨‹</p><p>é€‰æ‹©å‚æ•°:</p><p>-S â€œ-S&lt;å­—å°¾å¤‡ä»½å­—ç¬¦ä¸²&gt; â€æˆ– â€œâ€“suffix=&lt;å­—å°¾å¤‡ä»½å­—ç¬¦ä¸²&gt;â€</p><p>-V â€œ-V&lt;å¤‡ä»½æ–¹å¼&gt;â€æˆ–â€œâ€“version-control=&lt;å¤‡ä»½æ–¹å¼&gt;â€</p><p>â€“help æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯</p><p>â€“version æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;ç®€ä»‹&quot;&gt;&lt;/a&gt;ç®€ä»‹&lt;/h2&gt;&lt;p&gt;lnæ˜¯linuxä¸­åˆä¸€ä¸ªéå¸¸é‡è¦å‘½ä»¤ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯ä¸ºæŸä¸€ä¸ªæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥.å½“æˆ‘ä»¬éœ€è¦åœ¨ä¸åŒçš„ç›®å½•ï¼Œç”¨åˆ°ç›¸åŒçš„æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦åœ¨æ¯ä¸€ä¸ªéœ€è¦çš„ç›®å½•ä¸‹éƒ½æ”¾ä¸€ä¸ªå¿…é¡»ç›¸åŒçš„æ–‡ä»¶ï¼Œæˆ‘ä»¬åªè¦åœ¨æŸä¸ªå›ºå®šçš„ç›®å½•ï¼Œæ”¾ä¸Šè¯¥æ–‡ä»¶ï¼Œç„¶ååœ¨ å…¶å®ƒçš„ç›®å½•ä¸‹ç”¨lnå‘½ä»¤é“¾æ¥ï¼ˆlinkï¼‰å®ƒå°±å¯ä»¥ï¼Œä¸å¿…é‡å¤çš„å ç”¨ç£ç›˜ç©ºé—´ã€‚&lt;/p&gt;</summary>
    
    
    
    
    <category term="linux" scheme="https://tauleos.github.io/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>php mysqlæ‰¹é‡æ’å…¥</title>
    <link href="https://tauleos.github.io/6e9c090d6e03.html"/>
    <id>https://tauleos.github.io/6e9c090d6e03.html</id>
    <published>2017-10-01T14:37:41.000Z</published>
    <updated>2024-11-06T08:27:08.636Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€Insert-Intoï¼š"><a href="#ä¸€ã€Insert-Intoï¼š" class="headerlink" title="ä¸€ã€Insert Intoï¼š"></a>ä¸€ã€Insert Intoï¼š</h2><blockquote><p>ä½¿ç”¨<code>insert into</code> æ’å…¥ï¼Œä»£ç å¦‚ä¸‹ï¼š</p></blockquote><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$params</span> = <span class="keyword">array</span>(â€˜valueâ€™=&gt;â€™<span class="number">50</span>â€²);</span><br><span class="line"><span class="title function_ invoke__">set_time_limit</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">date</span>(â€œ<span class="attr">H</span>:<span class="attr">i</span>:sâ€);</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="number">2000000</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">  <span class="variable">$connect_mysql</span>-&gt;<span class="title function_ invoke__">insert</span>(<span class="variable">$params</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">date</span>(â€œ<span class="attr">H</span>:<span class="attr">i</span>:sâ€); </span><br></pre></td></tr></table></figure><div class="tip">æœ€åæ˜¾ç¤ºä¸ºï¼š**23:25:05 01:32:05**, ã€‚ã€‚ã€‚ã€‚ã€‚ ä¹Ÿå°±æ˜¯èŠ±äº†2ä¸ªå°æ—¶å¤š! ğŸ˜¢</div><h2 id="äºŒã€äº‹åŠ¡"><a href="#äºŒã€äº‹åŠ¡" class="headerlink" title="äºŒã€äº‹åŠ¡"></a>äºŒã€äº‹åŠ¡</h2><blockquote><p>ä½¿ç”¨äº‹åŠ¡æäº¤ï¼Œæ‰¹é‡æ’å…¥æ•°æ®åº“(æ¯éš”10Wæ¡æäº¤ä¸‹),ä»£ç å¦‚ä¸‹ï¼š</p></blockquote><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">date</span>(â€œ<span class="attr">H</span>:<span class="attr">i</span>:sâ€); </span><br><span class="line"><span class="variable">$connect_mysql</span>-&gt;<span class="title function_ invoke__">query</span>(â€˜BEGINâ€™);</span><br><span class="line"><span class="variable">$params</span> = <span class="keyword">array</span>(â€˜valueâ€™=&gt;â€™<span class="number">50</span>â€²);</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="number">2000000</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">  <span class="variable">$connect_mysql</span>-&gt;<span class="title function_ invoke__">insert</span>(<span class="variable">$params</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$i</span>%<span class="number">100000</span>==<span class="number">0</span>)&#123;</span><br><span class="line">    <span class="variable">$connect_mysql</span>-&gt;<span class="title function_ invoke__">query</span>(â€˜COMMITâ€™);<span class="variable">$connect_mysql</span>-&gt;<span class="title function_ invoke__">query</span>(â€˜BEGINâ€™);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$connect_mysql</span>-&gt;<span class="title function_ invoke__">query</span>(â€˜COMMITâ€™);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">date</span>(â€œ<span class="attr">H</span>:<span class="attr">i</span>:sâ€); </span><br></pre></td></tr></table></figure><div class="tip">æœ€åæ˜¾ç¤ºæ¶ˆè€—çš„æ—¶é—´ä¸ºï¼š**22:56:13 23:04:00**ï¼Œä¸€å…±8åˆ†13ç§’.å¥½åƒå¿«äº†ä¸å°‘ã€‚ã€‚</div><h2 id="ä¸‰ã€ä¼˜åŒ–SQLè¯­å¥"><a href="#ä¸‰ã€ä¼˜åŒ–SQLè¯­å¥" class="headerlink" title="ä¸‰ã€ä¼˜åŒ–SQLè¯­å¥"></a>ä¸‰ã€ä¼˜åŒ–SQLè¯­å¥</h2><blockquote><p>ä½¿ç”¨ä¼˜åŒ–SQLè¯­å¥ï¼šå°†SQLè¯­å¥è¿›è¡Œæ‹¼æ¥ï¼Œä½¿ç”¨ <code>insert into table () values  (),(),(),()</code>ç„¶åå†ä¸€æ¬¡æ€§æ’å…¥ï¼Œ</p><blockquote><p>å¦‚æœå­—ç¬¦ä¸²å¤ªé•¿ï¼Œåˆ™éœ€è¦é…ç½®ä¸‹MYSQLï¼Œåœ¨mysql å‘½ä»¤è¡Œä¸­è¿è¡Œ ï¼š</p></blockquote></blockquote><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">set</span> global max_allowed_packet =  2*1024*1024*10;</span><br></pre></td></tr></table></figure><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>= â€œinsert into <span class="title function_ invoke__">twenty_million</span> (value) valuesâ€; <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="number">2000000</span>;<span class="variable">$i</span>++)&#123; </span><br><span class="line">  <span class="variable">$sql</span>.=â€(â€™<span class="number">50</span>â€²),â€; </span><br><span class="line">&#125;; </span><br><span class="line"><span class="variable">$sql</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$sql</span>,<span class="number">0</span>,<span class="title function_ invoke__">strlen</span>(<span class="variable">$sql</span>)-<span class="number">1</span>); <span class="variable">$connect_mysql</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>); </span><br></pre></td></tr></table></figure><div class="tip">æ¶ˆè€—æ—¶é—´ä¸ºï¼š11:24:06 11:25:06;æ’å…¥200Wæ¡æµ‹è¯•æ•°æ®ä»…ä»…ç”¨äº†1åˆ†é’Ÿ!</div><h2 id="å››ã€ç»“è®º"><a href="#å››ã€ç»“è®º" class="headerlink" title="å››ã€ç»“è®º"></a>å››ã€ç»“è®º</h2><p>åœ¨æ’å…¥å¤§æ‰¹é‡æ•°æ®æ—¶ï¼Œç¬¬ä¸€ç§æ–¹æ³•æ— ç–‘æ˜¯æœ€å·®åŠ²çš„ï¼Œè€Œç¬¬äºŒç§æ–¹æ³•åœ¨å®é™…åº”ç”¨ä¸­å°±æ¯”è¾ƒå¹¿æ³›ï¼Œç¬¬ä¸‰ç§æ–¹æ³•åœ¨æ’å…¥æµ‹è¯•æ•°æ®æˆ–è€…å…¶ä»–ä½è¦æ±‚æ—¶æ¯”è¾ƒåˆé€‚ï¼Œé€Ÿåº¦ç¡®å®å¿«ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ä¸€ã€Insert-Intoï¼š&quot;&gt;&lt;a href=&quot;#ä¸€ã€Insert-Intoï¼š&quot; class=&quot;headerlink&quot; title=&quot;ä¸€ã€Insert Intoï¼š&quot;&gt;&lt;/a&gt;ä¸€ã€Insert Intoï¼š&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;i</summary>
      
    
    
    
    
    <category term="php" scheme="https://tauleos.github.io/tags/php/"/>
    
    <category term="mysql" scheme="https://tauleos.github.io/tags/mysql/"/>
    
  </entry>
  
</feed>
